---
# Source: stash-opscenter/charts/stash-ui-server/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-stash-opscenter-stash-ui-server
  namespace: default
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
---
# Source: stash-opscenter/charts/stash-ui-server/templates/apiregistration.yaml
apiVersion: v1
kind: Secret
metadata:
  name: my-stash-opscenter-stash-ui-server-apiserver-cert
  namespace: default
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
type: kubernetes.io/tls
data:
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCakNDQWU2Z0F3SUJBZ0lSQUo0N1FUWFBCK3A2TG9GOTZxcDhmTFF3RFFZSktvWklodmNOQVFFTEJRQXcKRFRFTE1Ba0dBMVVFQXhNQ1kyRXdIaGNOTWpRd09URTJNRGt3TVRFeFdoY05NelF3T1RFME1Ea3dNVEV4V2pBTgpNUXN3Q1FZRFZRUURFd0pqWVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTGxnCnhFVW1vTkNma01VeWJ2VDExQ1ZRQUxscFo2djhOaGZQVmpBUDIvWnlNMzRUVThqOHdoajhpTlh4ZnNML1BuSWYKVXdLejUrZ1BLVVREcXV4VmlZYXVpc0d1M0N0WU9Nb3VnR1gzQmVJMStCcnRUY3IyVTJiS2lOZmcxdFlUaE5qQwpQWXpPZlppa0tmM3dDTVdrTHVzRWhpQnlPdFlxMDR5RU5maVlCaTNxa0g1SDZDVnJoeGM3ZVFUczU5eHZ1M0tTClY0QytzbjVQcnFTay9GWWczMitrWGpUcjBHRjRmNHM2TFdNb2ZSSTFOcm9PZ3Mxbmg5a0lXSUdWMnp4ZXplYm4KZFgrY1ZydndSRjluYjJoVk1VSnJzbUZDT2tzNjEyZjhta2phTVh3dmpLUENNK2dCWW9XQzNudlJIRzVIMU9RTgp3MThRWXFkWXdWT1Y5blI1S0U4Q0F3RUFBYU5oTUY4d0RnWURWUjBQQVFIL0JBUURBZ0trTUIwR0ExVWRKUVFXCk1CUUdDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0RBakFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQjBHQTFVZERnUVcKQkJSS2tBdlkrYzZXVVhoMkVoZFc3NGl4ZkhTOWp6QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFqYTVXcnNZZgpNZzVhbVliUjFIelN6dW9vSzRBcjFGd0h0MXk3NThyQnJtMkpGQzcyZGRZNTRtL01oZnVHUG1MeWFGS2U2WXNPClFIdW4zaGJaMm5ZdjFKaWJ4Zy9TaUwrOWtvaHdVYzZPeXpQNEdKV1BKYks0TUhoUHJNVGdHdWZrSUFQblozL3MKc3FLSzQ3bFRsTmFHaHhjd0s1UnN1TEtwbk16VHoxa08xSzZtTFBvRm5ERENQUk1mM212TkxDOGw3eUg0YXhqNApoSmFjZHpUREZPWVpIaGR4RklRQ1hWTHRuQm1WWWRMN3VLMUtQUzZmclU3cHNXUUlvQnlLQUxIcFdONVpDUmZ0CmMrK3gzTGpYL3FJd3JyNGdUZ1VWNnpDQzloS0dLT1MyTEJDbVMvbUUwemdYdTRveFc4TDkySnFkUnVLN1VYTmoKK3p6MjEycVBTdlh2Q2c9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURqVENDQW5XZ0F3SUJBZ0lRUnNFSGw2a0lBREh1U1lRSHNvcW9aekFOQmdrcWhraUc5dzBCQVFzRkFEQU4KTVFzd0NRWURWUVFERXdKallUQWVGdzB5TkRBNU1UWXdPVEF4TVRGYUZ3MHpOREE1TVRRd09UQXhNVEZhTUMweApLekFwQmdOVkJBTVRJbTE1TFhOMFlYTm9MVzl3YzJObGJuUmxjaTF6ZEdGemFDMTFhUzF6WlhKMlpYSXdnZ0VpCk1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRREdrZWZBbnpKNnZObVBBbXEvTnRqRWhteVYKeHJSdkJzUU0xRkNLNDNjVTlOYkJPYmJpR3d2cnJJeHVWMkpCYlEvVjlmRDJHUEtyc2ZsdXJabjVOSU9uUldpYgp2YXlBbUdoV3F6R0pianZtOGV5dldPTHNOMXYxRVlPVkxOV1JlV1lQc2hxUUlXYUZLU2hUdWdFc2p1UEhzZFFGCkk2SHVHMC9rQjc0dExnV0E3YWRiaS9HWElGT2FKTy9mb3Bja1U4TWhvelQ4cTdkUzlDMlYxY1FmaURhYmxZa1gKRmZSN3ZzT0hWN3R3QXhGSkU3TXltMGhldVhIYmVOaW5sRGp2dnJuaTNEWG1ZVEdZSGRNN0oreThTWC9ZZTdxUQpiNzk0MmJYZmhFOEk0dUYxR1c1bFY5MitqQ1pZOG5peXhKWWFsRGlrZDQ2UWVlUEF2WTZ0TFJwVEtNM1BBZ01CCkFBR2pnY2d3Z2NVd0RnWURWUjBQQVFIL0JBUURBZ1dnTUIwR0ExVWRKUVFXTUJRR0NDc0dBUVVGQndNQkJnZ3IKQmdFRkJRY0RBakFNQmdOVkhSTUJBZjhFQWpBQU1COEdBMVVkSXdRWU1CYUFGRXFRQzlqNXpwWlJlSFlTRjFidgppTEY4ZEwyUE1HVUdBMVVkRVFSZU1GeUNLbTE1TFhOMFlYTm9MVzl3YzJObGJuUmxjaTF6ZEdGemFDMTFhUzF6ClpYSjJaWEl1WkdWbVlYVnNkSUl1YlhrdGMzUmhjMmd0YjNCelkyVnVkR1Z5TFhOMFlYTm9MWFZwTFhObGNuWmwKY2k1a1pXWmhkV3gwTG5OMll6QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFDV3JDWkFBaEhWUnBtZkl3OHByZwp6NFgwU1g5Vm1YMkhNcDV3ZzNpYjNCdXhCYjZCNUFOUkpuUk1RMWdIaFVsWWptRDNLQUJmV3pQbWdHZHBBTU0yCkN3aWtwSHE5d2pSODNmWnFqVEhTZ2ZBUzh0Wk0zWWhQWGV0L043eHdnNExVMUtneGRCcTZva3kzWmdSaTJQY2oKN2tJSG9NTEQ0T1ZJV2lSM2NOTVhjUzlZRFVHM1pFN2lNb0ZIMkkrZFpGRXZWNmY0WDdmMDVYQm1saEhGc3dZVApWMlhFMmF6OUlldHA5Q2wyaE1ZcldHYlBNTi9mcFF1K1M1SkpVKzh4cmdqRUNRdUNIL1RiUUxsYlF3YnlGakZpCkFTTXBDVERhVEFodGNBMFMrYVFUMU00a2FQRjV3ZHZhY0tTSTNtbFFvZjNJUHZRcXYzbTVwaHdYdFNIam9pdDYKVVE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeHBIbndKOHllcnpaandKcXZ6Yll4SVpzbGNhMGJ3YkVETlJRaXVOM0ZQVFd3VG0yCjRoc0w2NnlNYmxkaVFXMFAxZlh3OWhqeXE3SDVicTJaK1RTRHAwVm9tNzJzZ0pob1Zxc3hpVzQ3NXZIc3IxamkKN0RkYjlSR0RsU3pWa1hsbUQ3SWFrQ0ZtaFNrb1U3b0JMSTdqeDdIVUJTT2g3aHRQNUFlK0xTNEZnTzJuVzR2eApseUJUbWlUdjM2S1hKRlBESWFNMC9LdTNVdlF0bGRYRUg0ZzJtNVdKRnhYMGU3N0RoMWU3Y0FNUlNST3pNcHRJClhybHgyM2pZcDVRNDc3NjU0dHcxNW1FeG1CM1RPeWZzdkVsLzJIdTZrRysvZU5tMTM0UlBDT0xoZFJsdVpWZmQKdm93bVdQSjRzc1NXR3BRNHBIZU9rSG5qd0wyT3JTMGFVeWpOendJREFRQUJBb0lCQVFDWWg5K0Q0VVgvYmkyWQpZdnpvb1JMbDgzUlpvT2RkR2M5akkzd3pGQU9YUDNQdnZZdTBKNTZDakdyYkg1akVOU2lpN0djS1E2TzFLK00wCmwzbmRLZSt2Zit1WkpwdnB0Q2tCMmtNVkZHNURPcmJiQXVaZEdURTBFUjRJYXdZcTF4d0ZGb1M5RGtzWUlzTnQKZlVZRm1rVnlVakZST1V2Y0FYTGU4T3V1L05rUmJTSmFaZjJMZFArMDIrRHRBYVc5M3RsRmVZMSt5d0UxTlJoKwo5eFo2alhub1pzcmJidnBCV2RodjhsNnhuSHZUYkpPeDBuMDM5dC9jMTEzbzdvZHFRdlJ3Q2RKZjNlQVpTWVVKClVZbEtORk82NExvQ3hDenZTYXdQYXJZeVdYY0dyOHRHOFpKZXVYTE5kekIvd3hUemJjenQvVmN5clJyRU41RUoKY0x0eEQvaXhBb0dCQU9ZcVpWQUJrWk1sM2U2ZHRKOVFzN1VTY0t6alBrZldNWDl0OGV6T0pISnliOHBqekJONwpmeFJFaC9jVDNud2pCOExSeWJrSExncnIrWUxlWjRvekxoOHFzSlRodGlaQlZ6ZUJPYzAxaFpBL3dnMTZIQlNHCmZwVUFoY2hTMkJSZlo0amFvWVg3U0NYY3JweXQxNjNLMnBFb1d1T1Q0clJuVjFKaVNnaTJSVmRsQW9HQkFOemIKb3Rwb3c2Y0hZbmRYaWZBajZGbkphZklGeThiRTJOS2xvNjI3bkNZWHE4dUdMR0xnTU9oMTUxdnpTamRSRU1aQQpEd1pWY0ZSTGFWcGNhM3UxSGtQSnBGUmdHL2VBTG56TE1sZmtiVVlrRHRRaVU3WEFIR2FGMkxHMDBEUEdYSUdBCmI1SDhxeUhyMEg4VHRJZDBya1dPQlUrQTZBaFd3TnVlRDkxMXZEOGpBb0dBRnpmQm5vOTU4dUVJQVRFUmJsekMKdEFwWEtXbUc5OUlvamhVMktWQW1KeEZhSzQxam9iZDhlenZxaDBjTzAzRHBNSUxmR1hZYTgra1g4MWFpRlRQUwpmRHhmTWJXUEhVN01FSUpOcFdDM3gzUlhDK3I4ZUNtVkRVelBNZ1VCWFJTK3FmUjhCTHJ6YlRaVXV1TmlkVnFZCkw3cGxhTDJiU2QxKzFvV3B1RFZDeTIwQ2dZQjIxcmdLVGRUNVN6L3dkMm9CalZDNC8yZkNrdHZUV0poU3dFNFMKYmFEWDNtVFNYcUFEbEI2ODlyUkhCZUlwWWJWazk1TWVGVnNjQUhmdjUwcnVoY2FETXp6NUtiM2lyMVpVVUFJRwp5U01EV3VPZndkakpNMVlVMUhDRkxvWFpWaUx3aSt0ODRqZ3pTSEFuOExKek1KV1ZWNVlEOFpqbzQ4VmladXFpCmYzZUxnUUtCZ1FDbDNpZmh5RjJ1ckV0UnREMlRJOW94VXZDOUN5cnJ4OEZ3YXg2WlF3RnRFNEFweUcyV3MwdU8KTjhhZXlYQ3VoeHpyZEFLbjNDaG1ybEhKK3lydEVTeTBXbit0VlovU0JDOHNneXZEaERyMnFBMERWcW1BLzRUYgozN2tVRUxsN3FjdUpJTG4zbXJ4VVpMRU0rdHprS2FSc0NaQ21TeTFKekh4cC85aEs0M2dlcXc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
---
# Source: stash-opscenter/charts/stash-ui-server/templates/cluster-role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: my-stash-opscenter-stash-ui-server
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
rules:
- apiGroups:
  - ui.stash.appscode.com
  resources:
  - "*"
  verbs: ["*"]
- apiGroups:
  - stash.appscode.com
  - repositories.stash.appscode.com
  - kubedb.com
  - appcatalog.appscode.com
  resources:
  - "*"
  verbs: ["get", "list", "watch"]
- apiGroups:
  - ""
  resources:
  - nodes
  verbs: ["list"]
- apiGroups:
  - ""
  resources:
  - pods
  verbs: ["get", "list"]
- apiGroups:
  - ""
  resources:
  - events
  verbs: ["create"]
- apiGroups:
  - ""
  resources:
  - configmaps
  - secrets
  verbs: ["get", "list", "watch"]
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterroles
  - clusterrolebindings
  - roles
  - rolebindings
  verbs: ["get", "list", "watch"]
- nonResourceURLs:
  - ""
  - "/apis/ui.stash.appscode.com/v1alpha1"
  verbs: ["get"]
---
# Source: stash-opscenter/charts/stash-ui-server/templates/apiregistration.yaml
# to delegate authentication and authorization
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: my-stash-opscenter-stash-ui-server-apiserver-auth-delegator
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
roleRef:
  kind: ClusterRole
  apiGroup: rbac.authorization.k8s.io
  name: system:auth-delegator
subjects:
- kind: ServiceAccount
  name: my-stash-opscenter-stash-ui-server
  namespace: default
---
# Source: stash-opscenter/charts/stash-ui-server/templates/cluster-role-binding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: my-stash-opscenter-stash-ui-server
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: my-stash-opscenter-stash-ui-server
subjects:
- kind: ServiceAccount
  name: my-stash-opscenter-stash-ui-server
  namespace: default
---
# Source: stash-opscenter/charts/stash-ui-server/templates/apiregistration.yaml
# to read the config for terminating authentication
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: my-stash-opscenter-stash-ui-server-apiserver-extension-server-authentication-reader
  namespace: kube-system
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
roleRef:
  kind: Role
  apiGroup: rbac.authorization.k8s.io
  name: extension-apiserver-authentication-reader
subjects:
- kind: ServiceAccount
  name: my-stash-opscenter-stash-ui-server
  namespace: default
---
# Source: stash-opscenter/charts/stash-ui-server/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-stash-opscenter-stash-ui-server
  namespace: default
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  ports:
  # Port used to expose admission webhook apiserver
  - name: api
    port: 443
    targetPort: 8443
  selector:
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
---
# Source: stash-opscenter/charts/stash-ui-server/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-stash-opscenter-stash-ui-server
  namespace: default
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: stash-ui-server
      app.kubernetes.io/instance: my-stash-opscenter
  template:
    metadata:
      labels:
        app.kubernetes.io/name: stash-ui-server
        app.kubernetes.io/instance: my-stash-opscenter
      annotations:
        checksum/apiregistration.yaml: 565d32f7aea3ef720b5df2e0243c193cbdefb52db87b782afd5a2de1177c068f
    spec:
      
      serviceAccountName: my-stash-opscenter-stash-ui-server
      containers:
      - name: server
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          runAsNonRoot: true
          runAsUser: 65534
        image: ghcr.io/stashed/stash-ui-server:v0.16.0
        imagePullPolicy: Always
        args:
        - run
        - --v=3
        - --secure-port=8443
        - --audit-log-path=-
        - --tls-cert-file=/var/serving-cert/tls.crt
        - --tls-private-key-file=/var/serving-cert/tls.key
        - --use-kubeapiserver-fqdn-for-aks=true
        ports:
        - containerPort: 8443
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        resources:
          {}
        volumeMounts:
        - mountPath: /var/serving-cert
          name: serving-cert
      volumes:
      - name: serving-cert
        secret:
          defaultMode: 420
          secretName: my-stash-opscenter-stash-ui-server-apiserver-cert
      securityContext:
        fsGroup: 65535
---
# Source: stash-opscenter/charts/stash-ui-server/templates/apiregistration.yaml
# register as aggregated apiserver
apiVersion: apiregistration.k8s.io/v1
kind: APIService
metadata:
  name: v1alpha1.ui.stash.appscode.com
  labels:
    helm.sh/chart: stash-ui-server-v0.16.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v0.16.0"
    app.kubernetes.io/managed-by: Helm
spec:
  group: ui.stash.appscode.com
  version: v1alpha1
  service:
    namespace: default
    name: my-stash-opscenter-stash-ui-server
  caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCakNDQWU2Z0F3SUJBZ0lSQUo0N1FUWFBCK3A2TG9GOTZxcDhmTFF3RFFZSktvWklodmNOQVFFTEJRQXcKRFRFTE1Ba0dBMVVFQXhNQ1kyRXdIaGNOTWpRd09URTJNRGt3TVRFeFdoY05NelF3T1RFME1Ea3dNVEV4V2pBTgpNUXN3Q1FZRFZRUURFd0pqWVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTGxnCnhFVW1vTkNma01VeWJ2VDExQ1ZRQUxscFo2djhOaGZQVmpBUDIvWnlNMzRUVThqOHdoajhpTlh4ZnNML1BuSWYKVXdLejUrZ1BLVVREcXV4VmlZYXVpc0d1M0N0WU9Nb3VnR1gzQmVJMStCcnRUY3IyVTJiS2lOZmcxdFlUaE5qQwpQWXpPZlppa0tmM3dDTVdrTHVzRWhpQnlPdFlxMDR5RU5maVlCaTNxa0g1SDZDVnJoeGM3ZVFUczU5eHZ1M0tTClY0QytzbjVQcnFTay9GWWczMitrWGpUcjBHRjRmNHM2TFdNb2ZSSTFOcm9PZ3Mxbmg5a0lXSUdWMnp4ZXplYm4KZFgrY1ZydndSRjluYjJoVk1VSnJzbUZDT2tzNjEyZjhta2phTVh3dmpLUENNK2dCWW9XQzNudlJIRzVIMU9RTgp3MThRWXFkWXdWT1Y5blI1S0U4Q0F3RUFBYU5oTUY4d0RnWURWUjBQQVFIL0JBUURBZ0trTUIwR0ExVWRKUVFXCk1CUUdDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0RBakFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQjBHQTFVZERnUVcKQkJSS2tBdlkrYzZXVVhoMkVoZFc3NGl4ZkhTOWp6QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFqYTVXcnNZZgpNZzVhbVliUjFIelN6dW9vSzRBcjFGd0h0MXk3NThyQnJtMkpGQzcyZGRZNTRtL01oZnVHUG1MeWFGS2U2WXNPClFIdW4zaGJaMm5ZdjFKaWJ4Zy9TaUwrOWtvaHdVYzZPeXpQNEdKV1BKYks0TUhoUHJNVGdHdWZrSUFQblozL3MKc3FLSzQ3bFRsTmFHaHhjd0s1UnN1TEtwbk16VHoxa08xSzZtTFBvRm5ERENQUk1mM212TkxDOGw3eUg0YXhqNApoSmFjZHpUREZPWVpIaGR4RklRQ1hWTHRuQm1WWWRMN3VLMUtQUzZmclU3cHNXUUlvQnlLQUxIcFdONVpDUmZ0CmMrK3gzTGpYL3FJd3JyNGdUZ1VWNnpDQzloS0dLT1MyTEJDbVMvbUUwemdYdTRveFc4TDkySnFkUnVLN1VYTmoKK3p6MjEycVBTdlh2Q2c9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  groupPriorityMinimum: 10000
  versionPriority: 15
---
# Source: stash-opscenter/charts/stash-grafana-dashboards/templates/dashboard.yaml
apiVersion: openviz.dev/v1alpha1
kind: GrafanaDashboard
metadata:
  name: stash-dashboard
  namespace: default
  labels:
    k8s.io/group: stash.appscode.com
    helm.sh/chart: stash-grafana-dashboards-v2024.8.27
    app.kubernetes.io/name: stash-grafana-dashboards
    app.kubernetes.io/instance: my-stash-opscenter
    app.kubernetes.io/version: "v2024.8.27"
    app.kubernetes.io/managed-by: Helm
spec:
  model:
    annotations:
      list:
      - builtIn: 1
        datasource: -- Grafana --
        enable: true
        hide: true
        iconColor: rgba(0, 211, 255, 1)
        name: Annotations & Alerts
        target:
          limit: 100
          matchAny: false
          tags: []
          type: dashboard
        type: dashboard
    description: Grafana dashboard for Stash Enterprise edition
    editable: true
    fiscalYearStartMonth: 0
    gnetId: null
    graphTooltip: 0
    iteration: 1637585064532
    links: []
    liveNow: false
    panels:
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 0
      id: 23
      panels: []
      title: Overview
      type: row
    - datasource: ${datasource}
      description: Number of applications that has been configured for backup
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
            - color: red
              value: 80
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 0
        "y": 1
      id: 8
      options:
        colorMode: none
        graphMode: area
        justifyMode: center
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"})
        format: time_series
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Total Applications
      type: stat
    - datasource: ${datasource}
      description: Total number of successful backup
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: green
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 4
        "y": 1
      id: 10
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}", phase="Succeeded"})
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Successful Backups
      type: stat
    - datasource: ${datasource}
      description: Number of backup sessions that are currently running
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: light-blue
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 8
        "y": 1
      id: 14
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}",phase="Running"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Running Backups
      type: stat
    - datasource: ${datasource}
      description: Number of backup sessions that have been skipped
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: dark-purple
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 12
        "y": 1
      id: 13
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}", phase="Skipped"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Skipped Backup
      type: stat
    - datasource: ${datasource}
      description: Number of backups that have failed
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: red
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 16
        "y": 1
      id: 12
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}", phase="Failed"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Failed Backups
      type: stat
    - datasource: ${datasource}
      description: Total size of the backed up data
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
          unit: decbytes
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 20
        "y": 1
      id: 21
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 48
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: sum(stash_appscode_com_repository_size_bytes{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}",})
        format: time_series
        instant: false
        interval: ""
        intervalFactor: 3
        legendFormat: ""
        refId: A
      title: Total Backup Size
      type: stat
    - datasource: ${datasource}
      description: A list of backup targets
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          custom:
            align: auto
            displayMode: auto
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides:
        - matcher:
            id: byName
            options: Repository
          properties:
          - id: custom.width
            value: 247
        - matcher:
            id: byName
            options: BackupConfiguration
          properties:
          - id: custom.width
            value: 350
        - matcher:
            id: byName
            options: Name
          properties:
          - id: custom.width
            value: 283
        - matcher:
            id: byName
            options: Kind
          properties:
          - id: custom.width
            value: 162
        - matcher:
            id: byName
            options: Schedule
          properties:
          - id: custom.width
            value: 126
        - matcher:
            id: byName
            options: Driver
          properties:
          - id: custom.width
            value: 109
        - matcher:
            id: byName
            options: Namespace
          properties:
          - id: custom.width
            value: 151
        - matcher:
            id: byName
            options: Ready
          properties:
          - id: mappings
            value:
            - options:
                "False":
                  color: dark-red
                  index: 1
                  text: "No"
                "True":
                  color: dark-green
                  index: 0
                  text: "Yes"
              type: value
          - id: custom.width
            value: 96
          - id: noValue
            value: "False"
        - matcher:
            id: byName
            options: Last Successful Backup
          properties:
          - id: unit
            value: dateTimeFromNow
          - id: noValue
            value: No backup yet
        - matcher:
            id: byName
            options: Invoker Name
          properties:
          - id: custom.width
            value: 311
      gridPos:
        h: 9
        w: 24
        x: 0
        "y": 4
      id: 25
      options:
        showHeader: true
        sortBy: []
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}", target_kind=~"${target_kind}",
          target_name=~"${target_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      - exemplar: false
        expr: stash_appscode_com_backupconfiguration_conditions{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}",
          condition="CronJobCreated", status="True"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: B
      - exemplar: false
        expr: stash_appscode_com_backupsession_last_success_time_seconds{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}"}
          * 1000
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: C
      title: Backup Targets
      transformations:
      - id: merge
        options: {}
      - id: groupBy
        options:
          fields:
            __name__:
              aggregations: []
              operation: null
            'Value #A':
              aggregations:
              - lastNotNull
              operation: null
            'Value #B':
              aggregations:
              - lastNotNull
              operation: null
            'Value #C':
              aggregations:
              - lastNotNull
              operation: aggregate
            backupconfiguration:
              aggregations:
              - lastNotNull
              operation: null
            condition:
              aggregations:
              - lastNotNull
              operation: null
            driver:
              aggregations:
              - lastNotNull
              operation: aggregate
            invoker_kind:
              aggregations: []
              operation: groupby
            invoker_name:
              aggregations: []
              operation: groupby
            namespace:
              aggregations: []
              operation: groupby
            repository:
              aggregations:
              - lastNotNull
              operation: aggregate
            schedule:
              aggregations:
              - lastNotNull
              operation: aggregate
            status:
              aggregations:
              - lastNotNull
              operation: aggregate
            target_kind:
              aggregations:
              - lastNotNull
              operation: aggregate
            target_name:
              aggregations:
              - lastNotNull
              operation: aggregate
      - id: organize
        options:
          excludeByName:
            __name__: true
            __name__ 1: true
            __name__ 2: true
            Time: true
            Time 1: true
            Time 2: true
            Value: true
            'Value #A': true
            'Value #B': true
            condition: true
            container: true
            container 1: true
            container 2: true
            instance: true
            instance 1: true
            instance 2: true
            invoker_kind: false
            invoker_name: false
            job: true
            job 1: true
            job 2: true
            namespace 2: true
            status: false
            target_api_version: true
          indexByName:
            'Value #C (lastNotNull)': 9
            driver (lastNotNull): 6
            invoker_kind: 3
            invoker_name: 4
            namespace: 2
            repository (lastNotNull): 5
            schedule (lastNotNull): 7
            status (lastNotNull): 8
            target_kind (lastNotNull): 0
            target_name (lastNotNull): 1
          renameByName:
            __name__: ""
            Time: ""
            Time 1: ""
            Value: ""
            'Value #A': ""
            'Value #C (lastNotNull)': Last Successful Backup
            backupconfiguration: BackupConfiguration
            backupconfiguration (lastNotNull): BackupConfiguration
            driver: Driver
            driver (lastNotNull): Driver
            instance: ""
            invoker_kind: Invoker Kind
            invoker_name: Invoker Name
            namespace: Namespace
            namespace 1: Namespace
            repository: Repository
            repository (lastNotNull): Repository
            schedule: Schedule
            schedule (lastNotNull): Schedule
            status: Ready
            status (lastNotNull): Ready
            target_api_version: API Version
            target_kind: Kind
            target_kind (lastNotNull): Kind
            target_name: Name
            target_name (lastNotNull): Name
      type: table
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 13
      id: 37
      panels: []
      title: Backups
      type: row
    - datasource: ${datasource}
      description: CPU Usage by the backup pods
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: none
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides: []
      gridPos:
        h: 8
        w: 24
        x: 0
        "y": 14
      id: 35
      interval: null
      options:
        legend:
          calcs: []
          displayMode: list
          placement: bottom
        tooltip:
          mode: single
      pluginVersion: 8.1.2
      targets:
      - exemplar: false
        expr: sum(rate(container_cpu_usage_seconds_total{namespace=~"${namespace}", container!="",
          pod=~"stash-backup-.*",image!=""}[$__rate_interval])) by(pod)
        format: time_series
        hide: false
        instant: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{pod}}'
        refId: A
      - exemplar: false
        expr: rate(container_cpu_usage_seconds_total{namespace=~"${namespace}", container="stash",image!=""}[$__rate_interval])
        hide: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{pod}}'
        refId: B
      timeFrom: null
      timeShift: null
      title: CPU Usage (Backup Job/Sidecar)
      transformations: []
      type: graph
    - datasource: ${datasource}
      description: Memory usage by backup containers
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            axisSoftMin: 0
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineStyle:
              fill: solid
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: normal
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
          unit: decbytes
        overrides: []
      gridPos:
        h: 10
        w: 24
        x: 0
        "y": 22
      id: 33
      options:
        legend:
          calcs:
          - lastNotNull
          - max
          displayMode: table
          placement: right
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(container_memory_usage_bytes{namespace!="", container!="",pod=~"stash-backup-.*",image!=""})by(pod)
          > 0
        hide: false
        instant: false
        interval: ""
        intervalFactor: 2
        legendFormat: '{{pod}}'
        refId: A
      - exemplar: false
        expr: sum(container_memory_usage_bytes{namespace!="", container="stash",image!=""})by(pod)
          > 0
        hide: false
        interval: ""
        intervalFactor: 2
        legendFormat: '{{pod}}'
        refId: C
      title: Memory Usage (Backup Job/Sidecar)
      transformations: []
      type: graph
    - datasource: ${datasource}
      description: List of BackupSessions
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          custom:
            align: auto
            displayMode: auto
            filterable: false
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides:
        - matcher:
            id: byName
            options: Phase
          properties:
          - id: custom.width
            value: 138
        - matcher:
            id: byName
            options: Name
          properties:
          - id: custom.width
            value: 373
        - matcher:
            id: byName
            options: Invoker Kind
          properties:
          - id: custom.width
            value: 192
        - matcher:
            id: byName
            options: Invoker Name
          properties:
          - id: custom.width
            value: 279
        - matcher:
            id: byName
            options: Repository
          properties:
          - id: custom.width
            value: 251
        - matcher:
            id: byName
            options: Session Duration
          properties:
          - id: unit
            value: dtdurations
        - matcher:
            id: byName
            options: Creation Time
          properties:
          - id: unit
            value: dateTimeFromNow
        - matcher:
            id: byName
            options: BackupSession Name
          properties:
          - id: custom.width
            value: 464
      gridPos:
        h: 8
        w: 24
        x: 0
        "y": 32
      id: 27
      options:
        showHeader: true
        sortBy: []
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"}
        format: table
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      - exemplar: false
        expr: stash_appscode_com_backupsession_duration_seconds{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: B
      - exemplar: false
        expr: stash_appscode_com_backupsession_created{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"} * 1000
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: C
      title: Recent Backups
      transformations:
      - id: merge
        options: {}
      - id: groupBy
        options:
          fields:
            __name__:
              aggregations:
              - lastNotNull
              operation: null
            'Value #B':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #C':
              aggregations:
              - lastNotNull
              operation: aggregate
            backupsession:
              aggregations:
              - lastNotNull
              operation: aggregate
            invoker_kind:
              aggregations: []
              operation: groupby
            invoker_name:
              aggregations: []
              operation: groupby
            namespace:
              aggregations: []
              operation: groupby
            phase:
              aggregations:
              - lastNotNull
              operation: aggregate
            repository:
              aggregations:
              - lastNotNull
              operation: aggregate
      - id: organize
        options:
          excludeByName:
            Time: true
            container: true
            driver: true
            endpoint: true
            job: true
            pod: true
            repository: true
            service: true
          indexByName:
            'Value #B (lastNotNull)': 6
            backupsession (lastNotNull): 0
            invoker_kind: 2
            invoker_name: 3
            namespace: 1
            phase (lastNotNull): 5
            repository (lastNotNull): 4
          renameByName:
            __name__: Name
            Time: ""
            'Value #B': Duration
            'Value #B (lastNotNull)': Session Duration
            'Value #C (lastNotNull)': Creation Time
            backupsession (lastNotNull): BackupSession Name
            invoker_kind: Invoker Kind
            invoker_name: Invoker Name
            namespace: Namespace
            phase (lastNotNull): Phase
            repository (lastNotNull): Repository
      type: table
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 40
      id: 41
      panels: []
      title: Repository
      type: row
    - datasource: ${datasource}
      description: List of Repositories currently exist in the cluster
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          custom:
            align: auto
            displayMode: auto
            filterable: false
          mappings: []
          noValue: '-'
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides:
        - matcher:
            id: byName
            options: Integrity
          properties:
          - id: mappings
            value:
            - options:
                "0":
                  color: dark-red
                  index: 1
                  text: "No"
                "1":
                  color: dark-green
                  index: 0
                  text: "Yes"
              type: value
          - id: custom.width
            value: 112
        - matcher:
            id: byName
            options: Size
          properties:
          - id: unit
            value: decbytes
          - id: custom.width
            value: 118
        - matcher:
            id: byName
            options: Last Backup Time
          properties:
          - id: unit
            value: dateTimeFromNow
        - matcher:
            id: byName
            options: Name
          properties:
          - id: custom.width
            value: 268
        - matcher:
            id: byName
            options: Backend
          properties:
          - id: custom.width
            value: 116
        - matcher:
            id: byName
            options: Bucket/Container
          properties:
          - id: custom.width
            value: 215
        - matcher:
            id: byName
            options: Prefix
          properties:
          - id: custom.width
            value: 392
        - matcher:
            id: byName
            options: Snapshot Count
          properties:
          - id: custom.width
            value: 134
      gridPos:
        h: 10
        w: 24
        x: 0
        "y": 41
      id: 31
      options:
        showHeader: true
        sortBy: []
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: stash_appscode_com_repository_integrity{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      - exemplar: false
        expr: stash_appscode_com_repository_snapshot_count{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: B
      - exemplar: false
        expr: stash_appscode_com_repository_size_bytes{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: C
      - exemplar: false
        expr: stash_appscode_com_backupsession_last_success_time_seconds{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}"}
          * 1000
        format: table
        instant: true
        interval: ""
        legendFormat: ""
        refId: D
      title: Repositories
      transformations:
      - id: merge
        options: {}
      - id: groupBy
        options:
          fields:
            'Value #A':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #B':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #C':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #D':
              aggregations:
              - lastNotNull
              operation: aggregate
            backend:
              aggregations:
              - lastNotNull
              operation: aggregate
            bucket:
              aggregations:
              - lastNotNull
              operation: aggregate
            namespace:
              aggregations: []
              operation: groupby
            prefix:
              aggregations:
              - lastNotNull
              operation: aggregate
            repository:
              aggregations: []
              operation: groupby
      - id: organize
        options:
          excludeByName: {}
          indexByName:
            'Value #A (lastNotNull)': 5
            'Value #B (lastNotNull)': 6
            'Value #C (lastNotNull)': 7
            'Value #D (lastNotNull)': 8
            backend (lastNotNull): 2
            bucket (lastNotNull): 3
            namespace: 1
            prefix (lastNotNull): 4
            repository: 0
          renameByName:
            'Value #A (lastNotNull)': Integrity
            'Value #B (lastNotNull)': Snapshot Count
            'Value #C (lastNotNull)': Size
            'Value #D (lastNotNull)': Last Backup Time
            backend (lastNotNull): Backend
            bucket (lastNotNull): Bucket/Container
            namespace: Namespace
            prefix (lastNotNull): Prefix
            repository: Name
      type: table
    - datasource: ${datasource}
      description: Graph showing how repository size grows over time
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: linear
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: normal
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
          unit: decbytes
        overrides: []
      gridPos:
        h: 9
        w: 24
        x: 0
        "y": 51
      id: 43
      options:
        legend:
          calcs:
          - lastNotNull
          displayMode: table
          placement: right
        tooltip:
          mode: single
      pluginVersion: 8.1.2
      targets:
      - exemplar: false
        expr: stash_appscode_com_repository_size_bytes{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"}
        format: time_series
        instant: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{namespace}}/{{name}}'
        refId: A
      title: Repository Sizes
      transformations: []
      type: graph
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 60
      id: 39
      panels: []
      title: Restores
      type: row
    - datasource: ${datasource}
      description: Number of total restore done within the time-frame
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: light-blue
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 5
        x: 0
        "y": 61
      id: 44
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Total Restore Count
      type: stat
    - datasource: ${datasource}
      description: Total number of successful restores
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: semi-dark-green
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 5
        x: 5
        "y": 61
      id: 15
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}",
          phase="Succeeded"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Successful Restores
      type: stat
    - datasource: ${datasource}
      description: Number of restore sessions that are currently running
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: light-blue
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 5
        x: 10
        "y": 61
      id: 17
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}",
          phase="Running"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Running Restores
      type: stat
    - datasource: ${datasource}
      description: Number of restore sessions that are currently pending to run
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: semi-dark-purple
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 5
        x: 15
        "y": 61
      id: 18
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 53
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}"})
          - count(stash_appscode_com_restoresession_info{namespace=~"${namespace}", invoker_kind=~"${restore_invoker_kind}",
          invoker_name=~"${restore_invoker_name}", phase=~"Succeeded|Failed|Running"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Pending Restores
      type: stat
    - datasource: ${datasource}
      description: Number of restore sessions that have failed
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: red
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 20
        "y": 61
      id: 16
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}",
          phase="Failed"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Failed Restores
      type: stat
    - datasource: ${datasource}
      description: List of current RestoreSession in the cluster
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          custom:
            align: auto
            displayMode: auto
            filterable: false
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides:
        - matcher:
            id: byName
            options: Phase
          properties:
          - id: noValue
            value: Pending
          - id: custom.width
            value: 117
        - matcher:
            id: byName
            options: Name
          properties:
          - id: custom.width
            value: 277
        - matcher:
            id: byName
            options: Namespace
          properties:
          - id: custom.width
            value: 120
        - matcher:
            id: byName
            options: Invoker Name
          properties:
          - id: custom.width
            value: 285
        - matcher:
            id: byName
            options: Driver
          properties:
          - id: custom.width
            value: 108
        - matcher:
            id: byName
            options: Repository
          properties:
          - id: custom.width
            value: 265
        - matcher:
            id: byName
            options: Session Duration
          properties:
          - id: unit
            value: dtdurations
        - matcher:
            id: byName
            options: Restored At
          properties:
          - id: unit
            value: dateTimeFromNow
      gridPos:
        h: 9
        w: 24
        x: 0
        "y": 64
      id: 29
      options:
        showHeader: true
        sortBy: []
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: stash_appscode_com_restoresession_info{namespace=~"${namespace}", invoker_kind=~"${restore_invoker_kind}",
          invoker_name=~"${restore_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        intervalFactor: 1
        legendFormat: ""
        refId: A
      - exemplar: false
        expr: stash_appscode_com_restoresession_duration_seconds{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        intervalFactor: 1
        legendFormat: ""
        refId: B
      - exemplar: false
        expr: stash_appscode_com_restoresession_created{namespace=~"${namespace}", invoker_kind=~"${restore_invoker_kind}",
          invoker_name=~"${restore_invoker_name}"} * 1000
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: C
      title: Recent Restores
      transformations:
      - id: merge
        options: {}
      - id: groupBy
        options:
          fields:
            __name__:
              aggregations:
              - lastNotNull
              operation: null
            Time:
              aggregations: []
              operation: null
            'Value #B':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #C':
              aggregations:
              - lastNotNull
              operation: aggregate
            driver:
              aggregations:
              - lastNotNull
              operation: aggregate
            invoker_kind:
              aggregations: []
              operation: groupby
            invoker_name:
              aggregations: []
              operation: groupby
            namespace:
              aggregations: []
              operation: groupby
            phase:
              aggregations:
              - lastNotNull
              operation: aggregate
            repository:
              aggregations:
              - lastNotNull
              operation: aggregate
            restoresession:
              aggregations: []
              operation: null
            target_kind:
              aggregations:
              - lastNotNull
              operation: aggregate
            target_name:
              aggregations:
              - lastNotNull
              operation: aggregate
      - id: organize
        options:
          excludeByName: {}
          indexByName:
            'Value #B (lastNotNull)': 8
            driver (lastNotNull): 6
            invoker_kind: 3
            invoker_name: 4
            namespace: 2
            phase (lastNotNull): 7
            repository (lastNotNull): 5
            target_kind (lastNotNull): 0
            target_name (lastNotNull): 1
          renameByName:
            'Value #B (lastNotNull)': Session Duration
            'Value #C (lastNotNull)': Restored At
            driver (lastNotNull): Driver
            invoker_kind: Invoker Kind
            invoker_name: Invoker Name
            namespace: Namespace
            phase (lastNotNull): Phase
            repository (lastNotNull): Repository
            target_kind (lastNotNull): Kind
            target_name (lastNotNull): Name
      type: table
    - datasource: ${datasource}
      description: CPU Usage by the  restore pods
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: normal
            thresholdsStyle:
              mode: "off"
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides: []
      gridPos:
        h: 8
        w: 24
        x: 0
        "y": 73
      id: 45
      interval: null
      options:
        legend:
          calcs: []
          displayMode: list
          placement: bottom
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(rate(container_cpu_usage_seconds_total{namespace=~"${namespace}", container!="",
          pod=~"stash-restore-.*",image!=""}[$__rate_interval])) by(pod)
        hide: false
        instant: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{pod}}'
        refId: A
      - exemplar: false
        expr: rate(container_cpu_usage_seconds_total{namespace=~"${namespace}",container="stash-init"}[$__rate_interval])
        format: time_series
        hide: false
        instant: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{container}}'
        refId: B
      timeFrom: null
      timeShift: null
      title: CPU Usage (Restore Job/Sidecar)
      transformations: []
      type: graph
    - datasource: ${datasource}
      description: Memory usage by  restore containers
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            axisSoftMin: 0
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineStyle:
              fill: solid
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: normal
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
          unit: decbytes
        overrides: []
      gridPos:
        h: 10
        w: 24
        x: 0
        "y": 81
      id: 46
      options:
        legend:
          calcs:
          - lastNotNull
          - max
          displayMode: table
          placement: right
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(container_memory_usage_bytes{namespace=~"${namespace}", container!="",pod=~"stash-restore-.*",image!=""})by(pod)
          > 0
        hide: false
        instant: false
        interval: ""
        intervalFactor: 2
        legendFormat: '{{pod}}'
        refId: A
      - exemplar: false
        expr: sum(container_memory_usage_bytes{namespace=~"${namespace}", container="stash-init",image!=""})by(pod)
          > 0
        hide: false
        interval: ""
        intervalFactor: 2
        legendFormat: '{{pod}}'
        refId: C
      title: Memory Usage (Restore Job/Sidecar)
      transformations: []
      type: graph
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 91
      id: 2
      panels: []
      title: Operator & Pushgateway
      type: row
    - datasource: ${datasource}
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: none
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
            - color: red
              value: 80
        overrides: []
      gridPos:
        h: 7
        w: 24
        x: 0
        "y": 92
      id: 6
      options:
        legend:
          calcs: []
          displayMode: list
          placement: bottom
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(irate(container_cpu_usage_seconds_total{container=~"operator|pushgateway",
          pod=~".*stash-enterprise.*"}[$__rate_interval])) by(container)
        instant: false
        interval: ""
        intervalFactor: 3
        legendFormat: '{{container}}'
        refId: A
      title: CPU Usage
      type: graph
    - datasource: ${datasource}
      description: Memory Usage of Stash Operator
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineStyle:
              fill: solid
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: none
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
            - color: red
              value: 80
          unit: decbytes
        overrides: []
      gridPos:
        h: 8
        w: 24
        x: 0
        "y": 99
      id: 4
      options:
        legend:
          calcs:
          - lastNotNull
          - max
          displayMode: table
          placement: bottom
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(container_memory_usage_bytes{container=~"operator|pushgateway", pod=~".*stash-enterprise.*"})by(container)
        interval: ""
        intervalFactor: 2
        legendFormat: '{{container}}'
        refId: A
      title: Memory Usage
      type: graph
    refresh: 10s
    schemaVersion: 31
    style: dark
    tags: []
    templating:
      list:
      - current:
          selected: false
          text: Prometheus
          value: Prometheus
        description: null
        error: null
        hide: 0
        includeAll: false
        label: Data Source
        multi: false
        name: datasource
        options: []
        query: prometheus
        queryValue: ""
        refresh: 1
        regex: ""
        skipUrlSync: false
        type: datasource
      - allValue: .+
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info,namespace)
        description: List of namespaces where the backups are running
        error: null
        hide: 0
        includeAll: true
        label: Namespace
        multi: false
        name: namespace
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info,namespace)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: .+
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}"},target_kind)
        description: Kind of the targeted application
        error: null
        hide: 0
        includeAll: true
        label: Target Kind
        multi: false
        name: target_kind
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}"},target_kind)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: .+
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}"},target_name)
        description: Name of the targeted application
        error: null
        hide: 0
        includeAll: true
        label: Target Name
        multi: false
        name: target_name
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}"},target_name)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: ""
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_kind)
        description: Kind of the backup invoker object
        error: null
        hide: 2
        includeAll: true
        label: ""
        multi: false
        name: backup_invoker_kind
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_kind)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: ""
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_name)
        description: Name of the respective backup invoker object
        error: null
        hide: 2
        includeAll: true
        label: null
        multi: false
        name: backup_invoker_name
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_name)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 0
        type: query
      - allValue: ""
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_kind)
        description: Kind of the restore invoker object
        error: null
        hide: 2
        includeAll: true
        label: null
        multi: false
        name: restore_invoker_kind
        options: []
        query: label_values(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_kind)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: ""
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_name)
        description: Name of the respective restore invoker object
        error: null
        hide: 2
        includeAll: true
        label: null
        multi: false
        name: restore_invoker_name
        options: []
        query: label_values(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_name)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
    time:
      from: now-1h
      to: now
    timepicker: {}
    timezone: ""
    title: Stash / Dashboard
    version: 6
  overwrite: true
  templatize:
    title: false
    datasource: false
---
# Source: stash-opscenter/charts/stash-metrics/templates/metricsconfig-backupconfiguration.yaml
apiVersion: metrics.appscode.com/v1alpha1
kind: MetricsConfiguration
metadata:
  name: stash-appscode-com-backupconfiguration
spec:
  targetRef:
    apiVersion: stash.appscode.com/v1beta1
    kind: BackupConfiguration
  commonLabels:
    - key: invoker_kind
      value: "BackupConfiguration"
    - key: invoker_name
      valuePath: .metadata.name
  metrics:
    - name: created
      help: "Unix creation timestamp of this BackupConfiguration object"
      type: gauge
      field:
        path: .metadata.creationTimestamp
        type: DateTime
      metricValue:
        valueFromPath: .metadata.creationTimestamp
    - name: info
      help: "General information about this BackupConfiguration"
      type: gauge
      labels:
        - key: driver
          valuePath: .spec.driver
        - key: repository
          valuePath: .spec.repository.name
        - key: schedule
          valuePath: .spec.schedule
        - key: target_api_version
          valuePath: .spec.target.ref.apiVersion
        - key: target_kind
          valuePath: .spec.target.ref.kind
        - key: target_name
          valuePath: .spec.target.ref.name
      metricValue:
        value: 1
    - name: conditions
      help: "Current conditions of this BackupConfiguration"
      type: gauge
      field:
        path: .status.conditions
        type: Array
      labels:
        - key: condition
          valuePath: .status.conditions[*].type
        - key: status
          valuePath: .status.conditions[*].status
      metricValue:
        value: 1
---
# Source: stash-opscenter/charts/stash-metrics/templates/metricsconfig-backupsession.yaml
apiVersion: metrics.appscode.com/v1alpha1
kind: MetricsConfiguration
metadata:
  name: stash-appscode-com-backupsession
spec:
  targetRef:
    apiVersion: stash.appscode.com/v1beta1
    kind: BackupSession
  commonLabels:
    - key: invoker_api_group
      valuePath: .spec.invoker.apiGroup
    - key: invoker_kind
      valuePath: .spec.invoker.kind
    - key: invoker_name
      valuePath: .spec.invoker.name
  metrics:
    - name: created
      help: "Unix creation timestamp of this BackupSession"
      type: gauge
      field:
        path: .metadata.creationTimestamp
        type: DateTime
      metricValue:
        valueFromPath: .metadata.creationTimestamp
    - name: info
      help: "General information about BackupSession"
      type: gauge
      labels:
        - key: phase
          valuePath: .status.phase
      metricValue:
        value: 1
---
# Source: stash-opscenter/charts/stash-metrics/templates/metricsconfig-repository.yaml
apiVersion: metrics.appscode.com/v1alpha1
kind: MetricsConfiguration
metadata:
  name: stash-appscode-com-repository
spec:
  targetRef:
    apiVersion: stash.appscode.com/v1alpha1
    kind: Repository
  metrics:
    - name: created
      help: "Unix creation timestamp of this Repository"
      type: gauge
      field:
        path: .metadata.creationTimestamp
        type: DateTime
      metricValue:
        valueFromPath: .metadata.creationTimestamp
---
# Source: stash-opscenter/charts/stash-metrics/templates/metricsconfig-restoresession.yaml
apiVersion: metrics.appscode.com/v1alpha1
kind: MetricsConfiguration
metadata:
  name: stash-appscode-com-restoresession
spec:
  targetRef:
    apiVersion: stash.appscode.com/v1beta1
    kind: RestoreSession
  commonLabels:
    - key: invoker_kind
      value: "RestoreSession"
    - key: invoker_name
      valuePath: .metadata.name
  metrics:
    - name: created
      help: "Unix creation timestamp of this RestoreSession object"
      type: gauge
      field:
        path: .metadata.creationTimestamp
        type: DateTime
      metricValue:
        valueFromPath: .metadata.creationTimestamp
    - name: info
      help: "General information about this RestoreSession"
      type: gauge
      labels:
        - key: driver
          valuePath: .spec.driver
        - key: repository
          valuePath: .spec.repository.name
        - key: target_api_version
          valuePath: .spec.target.ref.apiVersion
        - key: target_kind
          valuePath: .spec.target.ref.kind
        - key: target_name
          valuePath: .spec.target.ref.name
        - key: phase
          valuePath: .status.phase
      metricValue:
        value: 1
---
# Source: stash-opscenter/charts/stash-metrics/templates/metrics-user-roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: appscode:metrics:edit
  labels:
    rbac.authorization.k8s.io/aggregate-to-admin: "true"
    rbac.authorization.k8s.io/aggregate-to-edit: "true"
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade
    "helm.sh/hook-delete-policy": before-hook-creation
rules:
- apiGroups:
  - metrics.appscode.com
  resources:
  - "*"
  verbs: ["*"]
---
# Source: stash-opscenter/charts/stash-metrics/templates/metrics-user-roles.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: appscode:metrics:view
  labels:
    rbac.authorization.k8s.io/aggregate-to-view: "true"
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade
    "helm.sh/hook-delete-policy": before-hook-creation
rules:
- apiGroups:
  - metrics.appscode.com
  resources:
  - "*"
  verbs: ["get", "list", "watch"]
---
# Source: stash-opscenter/charts/stash-ui-server/templates/user-roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: stash:ui:viewer
  labels:
    rbac.authorization.k8s.io/aggregate-to-admin: "true"
    rbac.authorization.k8s.io/aggregate-to-edit: "true"
    rbac.authorization.k8s.io/aggregate-to-view: "true"
  annotations:
    "helm.sh/hook": post-install,post-upgrade
    "helm.sh/hook-delete-policy": before-hook-creation
rules:
- apiGroups:
  - ui.stash.appscode.com
  resources:
  - "*"
  verbs: ["get", "list"]
