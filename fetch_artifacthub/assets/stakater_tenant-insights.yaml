---
# Source: tenant-insights/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: tenant-insights
  namespace: default
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
---
# Source: tenant-insights/templates/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
  name: tenant-insights
rules:
- apiGroups:
  - ""
  resources:
  - namespaces
  - nodes
  verbs:
  - "get"
  - "list"
  - "watch"
---
# Source: tenant-insights/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
  name: tenant-insights
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tenant-insights
subjects:
- kind: ServiceAccount
  name: tenant-insights
  namespace: default
---
# Source: tenant-insights/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: tenant-insights
  namespace: default
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 9115
      targetPort: metrics
      protocol: TCP
      name: metrics
  selector:
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
---
# Source: tenant-insights/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: tenant-insights
  namespace: default
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: tenant-insights
      app.kubernetes.io/instance: my-tenant-insights
  template:
    metadata:
      labels:
        app.kubernetes.io/name: tenant-insights
        app.kubernetes.io/instance: my-tenant-insights
    spec:
      serviceAccountName: tenant-insights
      securityContext:
        {}
      containers:
        - name: tenant-insights
          env:
            - name: TZ
              value: Europe/Stockholm
            - name: OCP_INSIGHT_OPENCOST_SERVER_URL
              value: http://opencost-gateway.multi-tenant-operator-addons.svc:9090
            - name: OCP_INSIGHT_OPENCOST_WINDOW
              value: "2h"
            - name: OCP_INSIGHT_OPENCOST_CRONTAB_DESCR
              value: Every 5 min
            - name: OCP_INSIGHT_OPENCOST_CRONTAB
              value: "0/5 * * * *"
          securityContext:
            {}
          image: "nexus-docker-stakater-nexus.apps.saap-prod.clusters.stakater.io/stakater-ab/tenant-insights:0.0.41"
          imagePullPolicy: IfNotPresent
          ports:
            - name: metrics
              containerPort: 9115
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /
              port: 9115
              scheme: HTTP
            initialDelaySeconds: 15
            timeoutSeconds: 5
            periodSeconds: 30
            successThreshold: 1
            failureThreshold: 5
          readinessProbe:
            httpGet:
              path: /
              port: 9115
              scheme: HTTP
            initialDelaySeconds: 15
            timeoutSeconds: 5
            periodSeconds: 30
            successThreshold: 1
            failureThreshold: 5
          resources:
            limits:
              cpu: 75m
              memory: 142Mi
          volumeMounts:
            - name: work
              mountPath: /stakater/tenant-insights/work
            - name: shell-operator
              mountPath: /var/run/shell-operator
      volumes:
        - name: work
          emptyDir: {}
        - name: shell-operator
          emptyDir: {}
---
# Source: tenant-insights/templates/grafana-dashboards.yaml
apiVersion: integreatly.org/v1alpha1
kind: GrafanaDashboard
metadata:
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
    grafanaDashboard: grafana-operator
  name: tenant-insights-capacity-planning.json
  namespace: default
spec:
  json: |-  
    {
          "annotations": {
            "list": [
              {
                "builtIn": 1,
                "datasource": "-- Grafana --",
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
              }
            ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "id": 17,
          "iteration": 1635410367317,
          "links": [],
          "panels": [
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "id": 28,
              "panels": [],
              "title": "Cluster Overview",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": true,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 80
                      }
                    ]
                  }
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 5,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 1
              },
              "hiddenSeries": false,
              "id": 24,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": true,
              "targets": [
                {
                  "expr": "sum(kube_node_role{role=\"worker\"} * on(node) group_left(label_nodetype) kube_node_labels) by (label_nodetype)",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "{{label_nodetype}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Cluster Worker Nodes",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "dark-blue",
                        "value": null
                      },
                      {
                        "color": "semi-dark-blue",
                        "value": 0.2
                      },
                      {
                        "color": "light-blue",
                        "value": 0.3
                      },
                      {
                        "color": "super-light-blue",
                        "value": 0.4
                      },
                      {
                        "color": "super-light-green",
                        "value": 0.5
                      },
                      {
                        "color": "light-green",
                        "value": 0.6
                      },
                      {
                        "color": "semi-dark-green",
                        "value": 0.7
                      },
                      {
                        "color": "dark-green",
                        "value": 0.8
                      },
                      {
                        "color": "semi-dark-green",
                        "value": 0.9
                      },
                      {
                        "color": "light-green",
                        "value": 1
                      },
                      {
                        "color": "super-light-yellow",
                        "value": 1.1
                      },
                      {
                        "color": "super-light-orange",
                        "value": 1.2
                      },
                      {
                        "color": "light-orange",
                        "value": 1.3
                      },
                      {
                        "color": "semi-dark-orange",
                        "value": 1.4
                      },
                      {
                        "color": "dark-orange",
                        "value": 1.5
                      },
                      {
                        "color": "super-light-red",
                        "value": 1.6
                      },
                      {
                        "color": "light-red",
                        "value": 1.8
                      },
                      {
                        "color": "semi-dark-red",
                        "value": 1.9
                      },
                      {
                        "color": "dark-red",
                        "value": 2
                      }
                    ]
                  },
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 4,
                "w": 6,
                "x": 12,
                "y": 1
              },
              "id": 26,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "auto",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "textMode": "auto"
              },
              "pluginVersion": "7.3.6",
              "targets": [
                {
                  "expr": "ocp_cluster_total_efficiency",
                  "interval": "",
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Cluster Resource Usage Efficiency",
              "type": "stat"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 7,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 6,
                "x": 18,
                "y": 1
              },
              "hiddenSeries": false,
              "id": 30,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum by (team) (ocp_namespace_cost{type=\"total\"}) / ignoring (team) group_left sum(ocp_namespace_cost{type=\"total\"})",
                  "interval": "",
                  "legendFormat": "{{team}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Monthly Cost Allocation",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": "1",
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 4,
                "w": 6,
                "x": 12,
                "y": 5
              },
              "hiddenSeries": false,
              "id": 32,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(ocp_namespace_cost{type=\"total\"})",
                  "interval": "",
                  "legendFormat": "Cluster Monthly Cost",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Cluster Monthly Cost",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 9
              },
              "id": 22,
              "panels": [],
              "title": "Cluster Resource Overview from Openshift",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "Sum of all team quotas requested and used memory.",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "bytes"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 12,
                "x": 0,
                "y": 10
              },
              "hiddenSeries": false,
              "id": 2,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(openshift_clusterresourcequota_usage{resource=\"requests.memory\",type=\"hard\"})",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "Tenant Requested",
                  "refId": "A"
                },
                {
                  "expr": "sum(openshift_clusterresourcequota_usage{resource=\"requests.memory\",type=\"used\"})",
                  "interval": "",
                  "legendFormat": "Tenant Used",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Total Tenant Quotas Memory",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": "Bytes",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "short"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 12,
                "x": 12,
                "y": 10
              },
              "hiddenSeries": false,
              "id": 3,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(openshift_clusterresourcequota_usage{resource=\"requests.cpu\",type=\"hard\"})",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "Tenant Requested",
                  "refId": "A"
                },
                {
                  "expr": "sum(openshift_clusterresourcequota_usage{resource=\"requests.cpu\",type=\"used\"})",
                  "interval": "",
                  "legendFormat": "Tenant Used",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Total Tenant Quotas CPU",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "vCPU",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 19
              },
              "id": 7,
              "panels": [],
              "title": "Resource Quotas by Tenant from Openshift",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "bytes"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 8,
                "x": 0,
                "y": 20
              },
              "hiddenSeries": false,
              "id": 4,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "openshift_clusterresourcequota_usage{resource=\"requests.memory\",type=\"hard\"}",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "{{name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Quotas Requested Memory by Tenant",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "bytes",
                  "label": "Bytes",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": true,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "bytes"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 8,
                "x": 8,
                "y": 20
              },
              "hiddenSeries": false,
              "id": 5,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "requests_memory",
                  "dashLength": 1,
                  "dashes": true,
                  "fill": 0,
                  "hideTooltip": true,
                  "legend": false,
                  "linewidth": 0,
                  "stack": false
                }
              ],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "openshift_clusterresourcequota_usage{resource=\"requests.memory\",type=\"used\"}",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "{{name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Quotas Used Memory by Tenant",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": "Bytes",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": true,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 8,
                "x": 16,
                "y": 20
              },
              "hiddenSeries": false,
              "id": 6,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "openshift_clusterresourcequota_usage{resource=\"requests.memory\",type=\"used\"} / on(name) openshift_clusterresourcequota_usage{resource=\"requests.memory\",type=\"hard\"}",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "{{name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Quotas Memory Efficiency by Tenant",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": true,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "short"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 8,
                "x": 0,
                "y": 29
              },
              "hiddenSeries": false,
              "id": 8,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "openshift_clusterresourcequota_usage{resource=\"requests.cpu\",type=\"hard\"}",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "{{name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Quotas Requested CPU by Tenant",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "short",
                  "label": "vCPU",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": true,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "short"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 8,
                "x": 8,
                "y": 29
              },
              "hiddenSeries": false,
              "id": 9,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "requests_cpu",
                  "dashLength": 1,
                  "dashes": true,
                  "fill": 0,
                  "hideTooltip": true,
                  "legend": false,
                  "linewidth": 0,
                  "stack": false
                }
              ],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "openshift_clusterresourcequota_usage{resource=\"requests.cpu\",type=\"used\"}",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "{{name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Quotas Used CPU by Tenant",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "vCPU",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": true,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 8,
                "x": 16,
                "y": 29
              },
              "hiddenSeries": false,
              "id": 10,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "openshift_clusterresourcequota_usage{resource=\"requests.cpu\",type=\"used\"} / on(name) openshift_clusterresourcequota_usage{resource=\"requests.cpu\",type=\"hard\"}",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "{{name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Quotas CPU Efficienty by Tenant",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": true,
                "alignLevel": null
              }
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 38
              },
              "id": 11,
              "panels": [],
              "title": "Resource Requests and Usage by Tenant from kubecost",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "bytes"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 8,
                "x": 0,
                "y": 39
              },
              "hiddenSeries": false,
              "id": 16,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "ocp_team_ram_byte_request_average",
                  "interval": "",
                  "legendFormat": "{{team}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant Requested Memory",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "bytes"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 8,
                "x": 8,
                "y": 39
              },
              "hiddenSeries": false,
              "id": 19,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null as zero",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "request_average",
                  "dashLength": 1,
                  "dashes": true,
                  "fill": 0,
                  "hideTooltip": true,
                  "legend": false,
                  "linewidth": 0,
                  "stack": false
                }
              ],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "ocp_team_ram_byte_usage_average",
                  "interval": "",
                  "legendFormat": "{{team}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant Used Memory",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {
                "zenith": "dark-purple"
              },
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 8,
                "x": 16,
                "y": 39
              },
              "hiddenSeries": false,
              "id": 14,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "ocp_team_ram_efficiency",
                  "format": "time_series",
                  "interval": "",
                  "legendFormat": "{{team}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant Memory Efficiency",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "short"
                },
                "overrides": []
              },
              "fill": 5,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 47
              },
              "hiddenSeries": false,
              "id": 17,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "ocp_team_cpu_core_request_average",
                  "interval": "",
                  "legendFormat": "{{team}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant Requested CPU",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "vCPU",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "short"
                },
                "overrides": []
              },
              "fill": 7,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 47
              },
              "hiddenSeries": false,
              "id": 20,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "request_average",
                  "dashLength": 1,
                  "dashes": true,
                  "fill": 0,
                  "hideTooltip": true,
                  "legend": false,
                  "linewidth": 0,
                  "stack": false
                }
              ],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "ocp_team_cpu_core_usage_average",
                  "interval": "",
                  "legendFormat": "{{team}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant Used CPU",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "vCPU",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 47
              },
              "hiddenSeries": false,
              "id": 13,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "ocp_team_cpu_efficiency",
                  "interval": "",
                  "legendFormat": "{{team}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant CPU Efficiency",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "schemaVersion": 26,
          "style": "dark",
          "tags": [
            "tenant-insights"
          ],
          "templating": {
            "list": []
          },
          "time": {
            "from": "now-24h",
            "to": "now"
          },
          "timepicker": {},
          "timezone": "",
          "title": "Capacity Planning",
          "uid": "przcYRF7k",
          "version": 34
        }
---
# Source: tenant-insights/templates/grafana-dashboards.yaml
apiVersion: integreatly.org/v1alpha1
kind: GrafanaDashboard
metadata:
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
    grafanaDashboard: grafana-operator
  name: tenant-insights-cluster-resources.json
  namespace: default
spec:
  json: |-  
    {
          "annotations": {
            "list": [
              {
                "builtIn": 1,
                "datasource": "-- Grafana --",
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
              }
            ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "id": 31,
          "iteration": 1650640298234,
          "links": [],
          "panels": [
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "id": 5,
              "panels": [],
              "repeat": "zone",
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "hh1",
                  "value": "hh1"
                }
              },
              "title": "Zone: ${zone}",
              "type": "row"
            },
            {
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "super-light-yellow",
                        "value": null
                      }
                    ]
                  }
                },
                "overrides": []
              },
              "gridPos": {
                "h": 4,
                "w": 4,
                "x": 0,
                "y": 1
              },
              "id": 17,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "auto",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "7.5.5",
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "hh1",
                  "value": "hh1"
                }
              },
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_node_status_${basedOn}{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Cores",
                  "refId": "A"
                },
                {
                  "exemplar": true,
                  "expr": "round(sum(kube_node_status_${basedOn}{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})/1000000000)",
                  "hide": false,
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Memory (Gi)",
                  "refId": "B"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Resources based on ${basedOn}",
              "type": "stat"
            },
            {
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "#EAB839",
                        "value": 0.5
                      },
                      {
                        "color": "red",
                        "value": 0.8
                      }
                    ]
                  },
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 6,
                "w": 10,
                "x": 4,
                "y": 1
              },
              "id": 15,
              "options": {
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "showThresholdLabels": false,
                "showThresholdMarkers": true,
                "text": {}
              },
              "pluginVersion": "7.5.5",
              "repeat": null,
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "hh1",
                  "value": "hh1"
                }
              },
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"} * on(namespace,pod) group_left kube_pod_status_ready{condition=\"true\"}) / sum(kube_node_status_${basedOn}{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}) ",
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Requests",
                  "refId": "Requests"
                },
                {
                  "exemplar": true,
                  "expr": "avg(label_replace(instance:node_cpu_utilisation:rate1m, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "hide": false,
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Used",
                  "refId": "Used"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "CPU",
              "type": "gauge"
            },
            {
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 0.5
                      }
                    ]
                  },
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 6,
                "w": 10,
                "x": 14,
                "y": 1
              },
              "id": 18,
              "options": {
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "showThresholdLabels": false,
                "showThresholdMarkers": true,
                "text": {}
              },
              "pluginVersion": "7.5.5",
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "hh1",
                  "value": "hh1"
                }
              },
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"} * on(namespace,pod) group_left kube_pod_status_ready{condition=\"true\"}) / sum(kube_node_status_${basedOn}{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}) ",
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Requests",
                  "refId": "Requests"
                },
                {
                  "exemplar": true,
                  "expr": "avg(label_replace(instance:node_memory_utilisation:ratio, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "hide": false,
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Used",
                  "refId": "Used"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Memory",
              "type": "gauge"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 7
              },
              "hiddenSeries": false,
              "id": 30,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.5.5",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "hh1",
                  "value": "hh1"
                }
              },
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"} * on(namespace,pod) group_left kube_pod_status_ready{condition=\"true\"}) / sum(kube_node_status_${basedOn}{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}) ",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "Requests CPU",
                  "refId": "Requests CPU"
                },
                {
                  "exemplar": true,
                  "expr": "avg(label_replace(instance:node_cpu_utilisation:rate1m, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "Used CPU (avg)",
                  "refId": "Used CPU"
                },
                {
                  "exemplar": true,
                  "expr": "label_replace(instance:node_cpu_utilisation:rate1m, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "{{instance}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "CPU usage in zone: ${zone} and nodetype: ${nodetype}",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:226",
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "$$hashKey": "object:227",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 7
              },
              "hiddenSeries": false,
              "id": 31,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.5.5",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "hh1",
                  "value": "hh1"
                }
              },
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"} * on(namespace,pod) group_left kube_pod_status_ready{condition=\"true\"}) / sum(kube_node_status_${basedOn}{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}) ",
                  "interval": "",
                  "legendFormat": "Requested Memory",
                  "refId": "Requested Memory"
                },
                {
                  "exemplar": true,
                  "expr": "avg(label_replace(instance:node_memory_utilisation:ratio, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "Used Memory (avg)",
                  "refId": "Used Memory"
                },
                {
                  "exemplar": true,
                  "expr": "label_replace(instance:node_memory_utilisation:ratio, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Memory usage in zone: ${zone} and nodetype: ${nodetype}",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:278",
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "$$hashKey": "object:279",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 15
              },
              "id": 32,
              "panels": [],
              "repeatIteration": 1650640298234,
              "repeatPanelId": 5,
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "sto5",
                  "value": "sto5"
                }
              },
              "title": "Zone: ${zone}",
              "type": "row"
            },
            {
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "super-light-yellow",
                        "value": null
                      }
                    ]
                  }
                },
                "overrides": []
              },
              "gridPos": {
                "h": 4,
                "w": 4,
                "x": 0,
                "y": 16
              },
              "id": 33,
              "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "auto",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "text": {},
                "textMode": "auto"
              },
              "pluginVersion": "7.5.5",
              "repeatIteration": 1650640298234,
              "repeatPanelId": 17,
              "repeatedByRow": true,
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "sto5",
                  "value": "sto5"
                }
              },
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_node_status_${basedOn}{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Cores",
                  "refId": "A"
                },
                {
                  "exemplar": true,
                  "expr": "round(sum(kube_node_status_${basedOn}{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})/1000000000)",
                  "hide": false,
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Memory (Gi)",
                  "refId": "B"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Resources based on ${basedOn}",
              "type": "stat"
            },
            {
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "#EAB839",
                        "value": 0.5
                      },
                      {
                        "color": "red",
                        "value": 0.8
                      }
                    ]
                  },
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 6,
                "w": 10,
                "x": 4,
                "y": 16
              },
              "id": 34,
              "options": {
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "showThresholdLabels": false,
                "showThresholdMarkers": true,
                "text": {}
              },
              "pluginVersion": "7.5.5",
              "repeat": null,
              "repeatIteration": 1650640298234,
              "repeatPanelId": 15,
              "repeatedByRow": true,
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "sto5",
                  "value": "sto5"
                }
              },
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"} * on(namespace,pod) group_left kube_pod_status_ready{condition=\"true\"}) / sum(kube_node_status_${basedOn}{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}) ",
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Requests",
                  "refId": "Requests"
                },
                {
                  "exemplar": true,
                  "expr": "avg(label_replace(instance:node_cpu_utilisation:rate1m, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "hide": false,
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Used",
                  "refId": "Used"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "CPU",
              "type": "gauge"
            },
            {
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 0.5
                      }
                    ]
                  },
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 6,
                "w": 10,
                "x": 14,
                "y": 16
              },
              "id": 35,
              "options": {
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "showThresholdLabels": false,
                "showThresholdMarkers": true,
                "text": {}
              },
              "pluginVersion": "7.5.5",
              "repeatIteration": 1650640298234,
              "repeatPanelId": 18,
              "repeatedByRow": true,
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "sto5",
                  "value": "sto5"
                }
              },
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"} * on(namespace,pod) group_left kube_pod_status_ready{condition=\"true\"}) / sum(kube_node_status_${basedOn}{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}) ",
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Requests",
                  "refId": "Requests"
                },
                {
                  "exemplar": true,
                  "expr": "avg(label_replace(instance:node_memory_utilisation:ratio, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "hide": false,
                  "instant": true,
                  "interval": "",
                  "legendFormat": "Used",
                  "refId": "Used"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Memory",
              "type": "gauge"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 22
              },
              "hiddenSeries": false,
              "id": 36,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.5.5",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "repeatIteration": 1650640298234,
              "repeatPanelId": 30,
              "repeatedByRow": true,
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "sto5",
                  "value": "sto5"
                }
              },
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"} * on(namespace,pod) group_left kube_pod_status_ready{condition=\"true\"}) / sum(kube_node_status_${basedOn}{resource=\"cpu\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}) ",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "Requests CPU",
                  "refId": "Requests CPU"
                },
                {
                  "exemplar": true,
                  "expr": "avg(label_replace(instance:node_cpu_utilisation:rate1m, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "Used CPU (avg)",
                  "refId": "Used CPU"
                },
                {
                  "exemplar": true,
                  "expr": "label_replace(instance:node_cpu_utilisation:rate1m, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "CPU usage in zone: ${zone} and nodetype: ${nodetype}",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:226",
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "$$hashKey": "object:227",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "${datasource}",
              "fieldConfig": {
                "defaults": {
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 22
              },
              "hiddenSeries": false,
              "id": 37,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.5.5",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "repeatIteration": 1650640298234,
              "repeatPanelId": 31,
              "repeatedByRow": true,
              "scopedVars": {
                "zone": {
                  "selected": true,
                  "text": "sto5",
                  "value": "sto5"
                }
              },
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"} * on(namespace,pod) group_left kube_pod_status_ready{condition=\"true\"}) / sum(kube_node_status_${basedOn}{resource=\"memory\"} * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}) ",
                  "interval": "",
                  "legendFormat": "Requested Memory",
                  "refId": "Requested Memory"
                },
                {
                  "exemplar": true,
                  "expr": "avg(label_replace(instance:node_memory_utilisation:ratio, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"})",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "Used Memory (avg)",
                  "refId": "Used Memory"
                },
                {
                  "exemplar": true,
                  "expr": "label_replace(instance:node_memory_utilisation:ratio, \"node\", \"$1\", \"instance\", \"(.*)\") * on(node) group_left kube_node_role{role=\"${role}\"} * on(node) group_left kube_node_labels{label_topology_kubernetes_io_zone=\"${zone}\",label_nodetype=\"${nodetype}\"}",
                  "hide": false,
                  "interval": "",
                  "legendFormat": "{{instance}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Memory usage in zone: ${zone} and nodetype: ${nodetype}",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:278",
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "$$hashKey": "object:279",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "refresh": "5s",
          "schemaVersion": 27,
          "style": "dark",
          "tags": [
            "tenant-insights"
          ],
          "templating": {
            "list": [
              {
                "current": {
                  "selected": false,
                  "text": "prometheus-main",
                  "value": "prometheus-main"
                },
                "description": null,
                "error": null,
                "hide": 0,
                "includeAll": false,
                "label": null,
                "multi": false,
                "name": "datasource",
                "options": [],
                "query": "prometheus",
                "queryValue": "",
                "refresh": 1,
                "regex": "",
                "skipUrlSync": false,
                "type": "datasource"
              },
              {
                "allValue": null,
                "current": {
                  "selected": true,
                  "tags": [],
                  "text": [
                    "hh1",
                    "sto5"
                  ],
                  "value": [
                    "hh1",
                    "sto5"
                  ]
                },
                "datasource": "prometheus-main",
                "definition": "label_values(kube_node_labels, label_topology_kubernetes_io_zone)",
                "description": null,
                "error": null,
                "hide": 0,
                "includeAll": true,
                "label": null,
                "multi": true,
                "name": "zone",
                "options": [],
                "query": {
                  "query": "label_values(kube_node_labels, label_topology_kubernetes_io_zone)",
                  "refId": "StandardVariableQuery"
                },
                "refresh": 1,
                "regex": "",
                "skipUrlSync": false,
                "sort": 0,
                "tagValuesQuery": "",
                "tags": [],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "selected": true,
                  "text": "worker",
                  "value": "worker"
                },
                "datasource": "prometheus-main",
                "definition": "label_values(kube_node_role, role)",
                "description": null,
                "error": null,
                "hide": 0,
                "includeAll": false,
                "label": null,
                "multi": false,
                "name": "role",
                "options": [],
                "query": {
                  "query": "label_values(kube_node_role, role)",
                  "refId": "StandardVariableQuery"
                },
                "refresh": 1,
                "regex": "",
                "skipUrlSync": false,
                "sort": 0,
                "tagValuesQuery": "",
                "tags": [],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "selected": false,
                  "text": "vmware",
                  "value": "vmware"
                },
                "datasource": "prometheus-main",
                "definition": "label_values(kube_node_labels, label_nodetype)",
                "description": null,
                "error": null,
                "hide": 0,
                "includeAll": false,
                "label": null,
                "multi": false,
                "name": "nodetype",
                "options": [],
                "query": {
                  "query": "label_values(kube_node_labels, label_nodetype)",
                  "refId": "StandardVariableQuery"
                },
                "refresh": 1,
                "regex": "",
                "skipUrlSync": false,
                "sort": 0,
                "tagValuesQuery": "",
                "tags": [],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "selected": true,
                  "text": "capacity",
                  "value": "capacity"
                },
                "description": null,
                "error": null,
                "hide": 0,
                "includeAll": false,
                "label": "based on",
                "multi": false,
                "name": "basedOn",
                "options": [
                  {
                    "selected": false,
                    "text": "allocatable",
                    "value": "allocatable"
                  },
                  {
                    "selected": true,
                    "text": "capacity",
                    "value": "capacity"
                  }
                ],
                "query": "allocatable,capacity",
                "queryValue": "",
                "skipUrlSync": false,
                "type": "custom"
              }
            ]
          },
          "time": {
            "from": "now-15m",
            "to": "now"
          },
          "timepicker": {},
          "timezone": "",
          "title": "Cluster Resources",
          "uid": "7R2KOFwnz",
          "version": 17
        }
---
# Source: tenant-insights/templates/grafana-dashboards.yaml
apiVersion: integreatly.org/v1alpha1
kind: GrafanaDashboard
metadata:
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
    grafanaDashboard: grafana-operator
  name: tenant-insights-cluster-usage.json
  namespace: default
spec:
  json: |-  
    {
          "annotations": {
            "list": [
              {
                "builtIn": 1,
                "datasource": "-- Grafana --",
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
              }
            ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "id": 17,
          "iteration": 1635258514491,
          "links": [],
          "panels": [
            {
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "id": 13,
              "options": {
                "content": "#### Openshift4 cluster usage\n\nMore information about resources, cost and efficiency can be found in kubecost. ",
                "mode": "markdown"
              },
              "pluginVersion": "7.3.6",
              "timeFrom": null,
              "timeShift": null,
              "title": "",
              "type": "text"
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 2
              },
              "id": 2,
              "panels": [],
              "title": "Cluster Efficiency from kubecost",
              "type": "row"
            },
            {
              "datasource": null,
              "description": "Cluster total compute efficiency (cpu and memory)",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "custom": {},
                  "decimals": 0,
                  "mappings": [],
                  "min": 0,
                  "noValue": "0",
                  "thresholds": {
                    "mode": "percentage",
                    "steps": [
                      {
                        "color": "red",
                        "value": null
                      },
                      {
                        "color": "#EAB839",
                        "value": 30
                      },
                      {
                        "color": "green",
                        "value": 70
                      },
                      {
                        "color": "dark-red",
                        "value": 101
                      }
                    ]
                  },
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 5,
                "w": 4,
                "x": 3,
                "y": 3
              },
              "id": 5,
              "options": {
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "showThresholdLabels": false,
                "showThresholdMarkers": true
              },
              "pluginVersion": "7.3.6",
              "targets": [
                {
                  "expr": "sum(ocp_cluster_cpu_efficiency{instance=\"kubecost\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "CPU Efficiency",
              "type": "gauge"
            },
            {
              "datasource": null,
              "description": "Cluster total compute efficiency (cpu and memory)",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "custom": {},
                  "decimals": 0,
                  "mappings": [],
                  "min": 0,
                  "noValue": "0",
                  "thresholds": {
                    "mode": "percentage",
                    "steps": [
                      {
                        "color": "red",
                        "value": null
                      },
                      {
                        "color": "#EAB839",
                        "value": 30
                      },
                      {
                        "color": "green",
                        "value": 70
                      },
                      {
                        "color": "dark-red",
                        "value": 101
                      }
                    ]
                  },
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 5,
                "w": 4,
                "x": 9,
                "y": 3
              },
              "id": 6,
              "options": {
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "showThresholdLabels": false,
                "showThresholdMarkers": true
              },
              "pluginVersion": "7.3.6",
              "targets": [
                {
                  "expr": "sum(ocp_cluster_ram_efficiency{instance=\"kubecost\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Memory Efficiency",
              "type": "gauge"
            },
            {
              "datasource": null,
              "description": "Cluster total compute efficiency (cpu and memory)",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "custom": {},
                  "decimals": 0,
                  "mappings": [],
                  "min": 0,
                  "noValue": "0",
                  "thresholds": {
                    "mode": "percentage",
                    "steps": [
                      {
                        "color": "red",
                        "value": null
                      },
                      {
                        "color": "#EAB839",
                        "value": 30
                      },
                      {
                        "color": "green",
                        "value": 70
                      },
                      {
                        "color": "dark-red",
                        "value": 101
                      }
                    ]
                  },
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 5,
                "w": 4,
                "x": 15,
                "y": 3
              },
              "id": 4,
              "options": {
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "showThresholdLabels": false,
                "showThresholdMarkers": true
              },
              "pluginVersion": "7.3.6",
              "targets": [
                {
                  "expr": "sum(ocp_cluster_total_efficiency{instance=\"kubecost\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Total efficiency",
              "type": "gauge"
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 8
              },
              "id": 19,
              "panels": [],
              "title": "Nodes",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 80
                      }
                    ]
                  },
                  "unit": "short"
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 9
              },
              "hiddenSeries": false,
              "id": 17,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sort(sum(kube_node_role{} * on(node) group_left(cloud_provider) label_replace(label_replace(kube_node_info, \"cloud_provider\", \"vmware\", \"job\", \".*\"), \"cloud_provider\", \"$1\", \"provider_id\", \"(.*):/.*\")) by (cloud_provider))",
                  "interval": "",
                  "legendFormat": "{{cloud_provider}}",
                  "refId": "A"
                },
                {
                  "expr": "sort(sum(kube_node_role) by (role)) ",
                  "interval": "",
                  "legendFormat": "{{role}}",
                  "refId": "B"
                },
                {
                  "expr": "sum(kube_node_role)",
                  "interval": "",
                  "legendFormat": "number of nodes",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Nodes",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "short",
                  "label": "Count",
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "collapsed": true,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 17
              },
              "id": 21,
              "panels": [
                {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": null,
                  "fieldConfig": {
                    "defaults": {
                      "custom": {},
                      "unit": "short"
                    },
                    "overrides": []
                  },
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                    "h": 7,
                    "w": 24,
                    "x": 0,
                    "y": 18
                  },
                  "hiddenSeries": false,
                  "id": 10,
                  "legend": {
                    "avg": false,
                    "current": false,
                    "max": false,
                    "min": false,
                    "show": true,
                    "total": false,
                    "values": false
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                    "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "7.3.6",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                    {
                      "expr": "ocp_cluster_cpu_core_request_average",
                      "interval": "",
                      "legendFormat": "CPU requested",
                      "refId": "A"
                    },
                    {
                      "expr": "ocp_cluster_cpu_core_usage_average",
                      "interval": "",
                      "legendFormat": "CPU usage",
                      "refId": "B"
                    }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "CPU usage",
                  "tooltip": {
                    "shared": true,
                    "sort": 0,
                    "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                    "buckets": null,
                    "mode": "time",
                    "name": null,
                    "show": true,
                    "values": []
                  },
                  "yaxes": [
                    {
                      "format": "short",
                      "label": "vCPU",
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                    },
                    {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                    }
                  ],
                  "yaxis": {
                    "align": false,
                    "alignLevel": null
                  }
                },
                {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": null,
                  "fieldConfig": {
                    "defaults": {
                      "custom": {},
                      "unit": "bytes"
                    },
                    "overrides": []
                  },
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                    "h": 7,
                    "w": 24,
                    "x": 0,
                    "y": 25
                  },
                  "hiddenSeries": false,
                  "id": 11,
                  "legend": {
                    "avg": false,
                    "current": false,
                    "max": false,
                    "min": false,
                    "show": true,
                    "total": false,
                    "values": false
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                    "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "7.3.6",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                    {
                      "expr": "ocp_cluster_ram_byte_request_average",
                      "interval": "",
                      "legendFormat": "Memory requested",
                      "refId": "A"
                    },
                    {
                      "expr": "ocp_cluster_ram_byte_usage_average",
                      "interval": "",
                      "legendFormat": "Memory usage",
                      "refId": "B"
                    }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Memory usage",
                  "tooltip": {
                    "shared": true,
                    "sort": 0,
                    "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                    "buckets": null,
                    "mode": "time",
                    "name": null,
                    "show": true,
                    "values": []
                  },
                  "yaxes": [
                    {
                      "format": "bytes",
                      "label": "Bytes",
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                    },
                    {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                    }
                  ],
                  "yaxis": {
                    "align": false,
                    "alignLevel": null
                  }
                }
              ],
              "title": "Cluster Resource usage from kubecost",
              "type": "row"
            }
          ],
          "schemaVersion": 26,
          "style": "dark",
          "tags": [
            "tenant-insights"
          ],
          "templating": {
            "list": []
          },
          "time": {
            "from": "now-24h",
            "to": "now"
          },
          "timepicker": {},
          "timezone": "",
          "title": "Cluster Usage and Efficiency",
          "uid": "SUFwGPdnk",
          "version": 30
        }
---
# Source: tenant-insights/templates/grafana-dashboards.yaml
apiVersion: integreatly.org/v1alpha1
kind: GrafanaDashboard
metadata:
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
    grafanaDashboard: grafana-operator
  name: tenant-insights-logging.json
  namespace: default
spec:
  json: |-  
    {
          "annotations": {
            "list": [
              {
                "builtIn": 1,
                "datasource": "-- Grafana --",
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
              }
            ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "id": 33,
          "links": [],
          "panels": [
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "id": 8,
              "panels": [],
              "title": "Logging Overview",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {},
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 1
              },
              "hiddenSeries": false,
              "id": 12,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.5.5",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(rate(cluster_logging_collector_input_record_total[10m] ))",
                  "interval": "",
                  "legendFormat": "Logging Collector",
                  "refId": "A"
                },
                {
                  "exemplar": true,
                  "expr": "sum(rate(apps_fluentd_input_record_total[10m] ))",
                  "interval": "",
                  "legendFormat": "Apps fluentd incoming",
                  "refId": "B"
                },
                {
                  "exemplar": true,
                  "expr": "sum(rate(apps_fluentd_parsed_record_total[10m] ))",
                  "interval": "",
                  "legendFormat": "Apps fluentd parsed",
                  "refId": "C"
                },
                {
                  "exemplar": true,
                  "expr": "sum(rate(apps_fluentd_elasticsearch_record_total[10m] ))",
                  "interval": "",
                  "legendFormat": "Apps fluentd to Elasticsearch",
                  "refId": "D"
                },
                {
                  "exemplar": true,
                  "expr": "sum(rate(apps_fluentd_slack_record_total[10m] ))",
                  "interval": "",
                  "legendFormat": "Apps fluentd to Slack",
                  "refId": "E"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Incoming and outgoing events ratio",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:118",
                  "format": "short",
                  "label": "events / second",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "$$hashKey": "object:119",
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "description": "",
              "fieldConfig": {
                "defaults": {},
                "overrides": []
              },
              "fill": 7,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 9
              },
              "hiddenSeries": false,
              "id": 5,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.5.5",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "exemplar": true,
                  "expr": "sum(fluentd_output_status_buffer_queue_length{type=\"forward\", service=\"collector\", namespace=\"openshift-logging\"}) by (namespace,pod)  * on(namespace, pod) group_left(node) node_namespace_pod:kube_pod_info:{pod=~\"collector-.*\"}",
                  "interval": "",
                  "legendFormat": "{{node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "OpenShift Logging Collector output queue",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "events / second",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 17
              },
              "id": 10,
              "panels": [],
              "title": "Logging entries rate",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {},
                "overrides": []
              },
              "fill": 7,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 24,
                "x": 0,
                "y": 18
              },
              "hiddenSeries": false,
              "id": 2,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.5.5",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "repeat": null,
              "repeatDirection": "v",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(ocp:tenant_logging_collector_input_record:rate) by (tenant)",
                  "interval": "",
                  "legendFormat": "{{tenant}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Workload input entries rate",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "events / second",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {},
                "overrides": []
              },
              "fill": 7,
              "fillGradient": 0,
              "gridPos": {
                "h": 9,
                "w": 24,
                "x": 0,
                "y": 27
              },
              "hiddenSeries": false,
              "id": 3,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.5.5",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "repeatDirection": "v",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(cluster_logging_collector_input_record_total{tag!~\"kubernetes.*\"}[1m])) by (tag)",
                  "interval": "",
                  "legendFormat": "{{tag}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Non Workload input entries rate",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "events / second",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "refresh": "10s",
          "schemaVersion": 27,
          "style": "dark",
          "tags": [ "tenant-insights"],
          "templating": {
            "list": []
          },
          "time": {
            "from": "now-1h",
            "to": "now"
          },
          "timepicker": {},
          "timezone": "",
          "title": "Logging",
          "uid": "GACL5WQnz",
          "version": 8
        }
---
# Source: tenant-insights/templates/grafana-dashboards.yaml
apiVersion: integreatly.org/v1alpha1
kind: GrafanaDashboard
metadata:
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
    grafanaDashboard: grafana-operator
  name: tenant-insights-pod-restarts.json
  namespace: default
spec:
  json: |-  
    {
          "annotations": {
            "list": [
              {
                "builtIn": 1,
                "datasource": "-- Grafana --",
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
              }
            ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "id": 22,
          "links": [],
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "hiddenSeries": false,
              "id": 12,
              "interval": "1h",
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "connected",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(\n  increase(kube_pod_container_status_restarts_total[10m]) *\n  on(namespace, pod) group_left (ocp_app)\n  group by(namespace, pod, ocp_app) (\n  label_replace(\n    label_replace(\n      label_replace(\n        label_replace(\n          kube_pod_labels,\n          \"ocp_app\",\n          \"$1\",\n          \"label_app_kubernetes_io_instance\",\n          \"(.*)\"\n        ),\n        \"ocp_app\",\n        \"$1\",\n        \"label_app_kubernetes_io_name\",\n        \"(.+)\"\n      ),\n      \"ocp_app\",\n      \"$1\",\n      \"label_k8s_app\",\n      \"(.+)\"\n    ),\n    \"ocp_app\",\n    \"$1\",\n    \"label_app\",\n    \"(.+)\"\n  )\n )\n) by (namespace,ocp_app) != 0",
                  "interval": "",
                  "legendFormat": "{{ocp_app}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Application Restarts",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "restarts/10m",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "custom": {
                    "align": null,
                    "displayMode": "auto",
                    "filterable": true
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 80
                      }
                    ]
                  }
                },
                "overrides": [
                  {
                    "matcher": {
                      "id": "byName",
                      "options": "Latest Reason"
                    },
                    "properties": [
                      {
                        "id": "custom.width",
                        "value": 160
                      }
                    ]
                  },
                  {
                    "matcher": {
                      "id": "byName",
                      "options": "Restarts"
                    },
                    "properties": [
                      {
                        "id": "custom.width",
                        "value": 160
                      }
                    ]
                  }
                ]
              },
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 8
              },
              "id": 10,
              "options": {
                "showHeader": true,
                "sortBy": [
                  {
                    "desc": true,
                    "displayName": "Restarts"
                  }
                ]
              },
              "pluginVersion": "7.3.6",
              "targets": [
                {
                  "expr": "sum(\n  kube_pod_container_status_last_terminated_reason *\n  on(namespace,pod,container) group_left sum (kube_pod_container_status_restarts_total) by (namespace,pod,container) *\n  on(namespace, pod) group_left (ocp_app)\n  group by(namespace, pod, ocp_app) (\n  label_replace(\n    label_replace(\n      label_replace(\n        label_replace(\n          kube_pod_labels,\n          \"ocp_app\",\n          \"$1\",\n          \"label_app_kubernetes_io_instance\",\n          \"(.*)\"\n        ),\n        \"ocp_app\",\n        \"$1\",\n        \"label_app_kubernetes_io_name\",\n        \"(.+)\"\n      ),\n      \"ocp_app\",\n      \"$1\",\n      \"label_k8s_app\",\n      \"(.+)\"\n    ),\n    \"ocp_app\",\n    \"$1\",\n    \"label_app\",\n    \"(.+)\"\n  )\n )\n) by (namespace,ocp_app,reason) != 0",
                  "format": "table",
                  "instant": true,
                  "interval": "",
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Latest Status of Application Restarts",
              "transformations": [
                {
                  "id": "organize",
                  "options": {
                    "excludeByName": {
                      "Time": true
                    },
                    "indexByName": {},
                    "renameByName": {
                      "Value": "Restarts",
                      "namespace": "Namespace",
                      "ocp_app": "App",
                      "reason": "Latest Reason"
                    }
                  }
                }
              ],
              "type": "table"
            },
            {
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "continuous-GrYlRd"
                  },
                  "custom": {
                    "align": null,
                    "filterable": true
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 80
                      }
                    ]
                  },
                  "unit": "short"
                },
                "overrides": [
                  {
                    "matcher": {
                      "id": "byName",
                      "options": "Restarts"
                    },
                    "properties": [
                      {
                        "id": "custom.width",
                        "value": 160
                      }
                    ]
                  },
                  {
                    "matcher": {
                      "id": "byName",
                      "options": "Latest Reason"
                    },
                    "properties": [
                      {
                        "id": "custom.width",
                        "value": 160
                      }
                    ]
                  }
                ]
              },
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 16
              },
              "id": 8,
              "options": {
                "showHeader": true,
                "sortBy": [
                  {
                    "desc": true,
                    "displayName": "Restarts"
                  }
                ]
              },
              "pluginVersion": "7.3.6",
              "targets": [
                {
                  "expr": "kube_pod_container_status_restarts_total * on (namespace,pod,container) group_left (reason) (kube_pod_container_status_last_terminated_reason != 0)",
                  "format": "table",
                  "instant": true,
                  "interval": "",
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "timeFrom": null,
              "timeShift": null,
              "title": "Latest Status of Container Restarts",
              "transformations": [
                {
                  "id": "organize",
                  "options": {
                    "excludeByName": {
                      "Time": true,
                      "endpoint": true,
                      "job": true,
                      "service": true
                    },
                    "indexByName": {
                      "Time": 3,
                      "Value": 8,
                      "container": 2,
                      "endpoint": 4,
                      "job": 5,
                      "namespace": 0,
                      "pod": 1,
                      "reason": 6,
                      "service": 7
                    },
                    "renameByName": {
                      "Value": "Restarts",
                      "container": "Container",
                      "namespace": "Namespace",
                      "pod": "Pod",
                      "reason": "Latest Reason"
                    }
                  }
                }
              ],
              "type": "table"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 24
              },
              "hiddenSeries": false,
              "id": 6,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "connected",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "kube_pod_container_status_restarts_total * on (namespace,pod,container) group_left (reason) (kube_pod_container_status_last_terminated_reason{reason=\"OOMKilled\"} != 0)",
                  "interval": "",
                  "legendFormat": "{{namespace}}/{{pod}}/{{container}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Container Restarts reason OOMKilled",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {
                  "custom": {
                    "align": null,
                    "filterable": false
                  },
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 2
                      }
                    ]
                  },
                  "unit": "short"
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 32
              },
              "hiddenSeries": false,
              "id": 2,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "label_join(\n  max(kube_pod_container_status_restarts_total * on (pod,namespace) group_left (label_app) group by (pod,namespace,label_app) (kube_pod_labels) * on (namespace) group_left (tenant) ocp:tenant_namespace:info) without(service,job,endpoint,container),\n  \"workload\",\n  \".\",\n  \"namespace\",\n  \"pod\"\n) != 0",
                  "format": "time_series",
                  "instant": false,
                  "interval": "",
                  "legendFormat": "{{workload}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant Workload container restarts",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "prometheus-main",
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "mappings": [],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 3
                      }
                    ]
                  }
                },
                "overrides": []
              },
              "fill": 0,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 40
              },
              "hiddenSeries": false,
              "id": 4,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "label_join(\n  max(kube_pod_container_status_restarts_total * on (pod,namespace) group_left (label_app) group by (pod,namespace,label_app) (kube_pod_labels) * on (namespace) group_left kube_namespace_labels{label_openshift_io_cluster_monitoring=\"true\"}) without(service,job,endpoint,container),\n  \"workload\",\n  \".\",\n  \"namespace\",\n  \"pod\"\n) != 0",
                  "format": "time_series",
                  "interval": "",
                  "legendFormat": "{{workload}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Infra Workload container restarts",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "transformations": [],
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "refresh": false,
          "schemaVersion": 26,
          "style": "dark",
          "tags": [
            "tenant-insights"
          ],
          "templating": {
            "list": []
          },
          "time": {
            "from": "now-24h",
            "to": "now"
          },
          "timepicker": {},
          "timezone": "",
          "title": "Container Restarts",
          "uid": "_jdVu8t7z",
          "version": 34
        }
---
# Source: tenant-insights/templates/grafana-dashboards.yaml
apiVersion: integreatly.org/v1alpha1
kind: GrafanaDashboard
metadata:
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
    grafanaDashboard: grafana-operator
  name: tenant-insights-tenant-usage.json
  namespace: default
spec:
  json: |-  
    {
          "annotations": {
            "list": [
              {
                "builtIn": 1,
                "datasource": "-- Grafana --",
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
              }
            ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "id": 25,
          "iteration": 1634886728264,
          "links": [],
          "panels": [
            {
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "gridPos": {
                "h": 2,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "id": 20,
              "options": {
                "content": "#### Openshift4 cluster usage from kubecost for Tenant ${team}.\n\nMore information about cost, usage and efficiency can be found in kubecost.",
                "mode": "markdown"
              },
              "pluginVersion": "7.3.6",
              "timeFrom": null,
              "timeShift": null,
              "title": "",
              "type": "text"
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 2
              },
              "id": 22,
              "panels": [],
              "title": "Tenant Resources",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 12,
                "x": 0,
                "y": 3
              },
              "hiddenSeries": false,
              "id": 6,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "ocp_team_cpu_core_request_average{team=\"$team\"}",
                  "interval": "",
                  "legendFormat": "Average request",
                  "refId": "A"
                },
                {
                  "expr": "ocp_team_cpu_core_usage_average{team=\"$team\"}",
                  "interval": "",
                  "legendFormat": "Average usage",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant CPU",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "vCPU",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 12,
                "x": 12,
                "y": 3
              },
              "hiddenSeries": false,
              "id": 8,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "ocp_team_ram_byte_request_average{team=\"$team\"}",
                  "interval": "",
                  "legendFormat": "Average request",
                  "refId": "A"
                },
                {
                  "expr": "ocp_team_ram_byte_usage_average{team=\"$team\"}",
                  "interval": "",
                  "legendFormat": "Average usage",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Tenant Memory",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": "Bytes",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 10
              },
              "id": 18,
              "panels": [],
              "title": "Tenant Resource efficiency",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 11
              },
              "hiddenSeries": false,
              "id": 3,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(ocp_namespace_cpu_efficiency{instance=\"kubecost\",team=\"$team\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "{{namespace}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Namespaces CPU Efficiency",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 11
              },
              "hiddenSeries": false,
              "id": 4,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(ocp_namespace_ram_efficiency{instance=\"kubecost\",team=\"$team\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "{{namespace}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Namespaces Memory Efficiency",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "percentunit",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {},
                  "unit": "percentunit"
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 11
              },
              "hiddenSeries": false,
              "id": 16,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(ocp_namespace_total_efficiency{instance=\"kubecost\",team=\"$team\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "{{namespace}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Namespace Total Efficiency",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "percentunit",
                  "label": "",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "collapsed": false,
              "datasource": null,
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 18
              },
              "id": 12,
              "panels": [],
              "title": "Namespace",
              "type": "row"
            },
            {
              "datasource": null,
              "description": "",
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 19
              },
              "id": 24,
              "options": {
                "content": ""
              },
              "pluginVersion": "7.3.6",
              "timeFrom": null,
              "timeShift": null,
              "title": "${namespace}",
              "type": "text"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 12,
                "x": 0,
                "y": 22
              },
              "hiddenSeries": false,
              "id": 13,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(ocp_namespace_cpu_core_request_average{team=\"$team\",namespace=\"$namespace\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "Average request",
                  "refId": "A"
                },
                {
                  "expr": "sum(ocp_namespace_cpu_core_usage_average{team=\"$team\",namespace=\"$namespace\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "Average usage",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "$namespace CPU",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "vCPU",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "fieldConfig": {
                "defaults": {
                  "custom": {}
                },
                "overrides": []
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 12,
                "x": 12,
                "y": 22
              },
              "hiddenSeries": false,
              "id": 14,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "7.3.6",
              "pointradius": 2,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(ocp_namespace_ram_byte_request_average{team=\"$team\", namespace=\"$namespace\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "Average request",
                  "refId": "A"
                },
                {
                  "expr": "sum(ocp_namespace_ram_byte_usage_average{team=\"$team\", namespace=\"$namespace\"}) without (pod)",
                  "interval": "",
                  "legendFormat": "Average usage",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "$namespace Memory",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": "Bytes",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "refresh": false,
          "schemaVersion": 26,
          "style": "dark",
          "tags": [
            "tenant-insights"
          ],
          "templating": {
            "list": [
              {
                "allValue": null,
                "current": {
                  "selected": false,
                  "text": "horse-digital-shadowfax",
                  "value": "horse-digital-shadowfax"
                },
                "datasource": "prometheus",
                "definition": "label_values(ocp_namespace_total_efficiency{instance=\"kubecost\"}, team)",
                "error": null,
                "hide": 0,
                "includeAll": false,
                "label": "Tenant",
                "multi": false,
                "name": "team",
                "options": [],
                "query": "label_values(ocp_namespace_total_efficiency{instance=\"kubecost\"}, team)",
                "refresh": 1,
                "regex": "",
                "skipUrlSync": false,
                "sort": 1,
                "tagValuesQuery": "",
                "tags": [],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
              },
              {
                "allValue": null,
                "current": {
                  "selected": false,
                  "text": "test1-horse-bet-history",
                  "value": "test1-horse-bet-history"
                },
                "datasource": "prometheus",
                "definition": "label_values(ocp_namespace_total_efficiency{instance=\"kubecost\",team=\"$team\"}, namespace)",
                "error": null,
                "hide": 0,
                "includeAll": false,
                "label": "Namespace",
                "multi": false,
                "name": "namespace",
                "options": [],
                "query": "label_values(ocp_namespace_total_efficiency{instance=\"kubecost\",team=\"$team\"}, namespace)",
                "refresh": 1,
                "regex": "",
                "skipUrlSync": false,
                "sort": 0,
                "tagValuesQuery": "",
                "tags": [],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
              }
            ]
          },
          "time": {
            "from": "now-24h",
            "to": "now"
          },
          "timepicker": {},
          "timezone": "",
          "title": "Tenant Usage and Efficiency",
          "uid": "wj0lGEOnz",
          "version": 30
        }
---
# Source: tenant-insights/templates/prometheusrule.yaml
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: tenant-insights
  namespace: openshift-monitoring
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
  - name: ocp
    rules:
    - record: ocp:tenant:info
      expr: |-
        avg(
          (kube_namespace_status_phase{phase="Active"} > 0) * on(namespace) group_left (tenant)
            label_replace(group(kube_namespace_labels{label_stakater_com_tenant!=""}) by (namespace, label_stakater_com_tenant), "tenant", "$1","label_stakater_com_tenant", "(.*)")
        ) by (tenant)
    - record: ocp:tenant_namespace:info
      expr: |-
        avg(
          (kube_namespace_status_phase{phase="Active"} > 0) * on(namespace) group_left (tenant)
            label_replace(group(kube_namespace_labels{label_stakater_com_tenant!=""}) by (namespace, label_stakater_com_tenant), "tenant", "$1","label_stakater_com_tenant", "(.*)")
        ) by (tenant, namespace)
    - record: ocp:tenant_pod_container:info
      expr: avg(ocp:tenant_namespace:info * on (namespace) group_right (tenant) kube_pod_container_info) by (tenant,namespace,pod,container,container_id,image,image_id)
  - name: ocp.logging_collector
    rules:
    - record: ocp:tenant_logging_collector:info
      expr: |-
        group(
          ocp:tenant_pod_container:info * on (namespace,pod,container) group_right(tenant)
            label_replace(
              label_replace(
                label_replace(
                  cluster_logging_collector_input_record_total{service="collector", tag=~"kubernetes.var.log.*"},
                  "namespace",
                  "$2",
                  "tag",
                  "kubernetes.var.log.containers.(.*)_(.*)_(.*)"),
                "pod",
                "$1",
                "tag",
                "kubernetes.var.log.containers.(.*)_(.*)_(.*)"),
              "container",
              "$3",
              "tag",
              "kubernetes.var.log.containers.(.*)_(.*)_(.*)-([[:alnum:]]*.log)")
        ) by (tenant,namespace,pod,container,image,image_id,tag)
    - record: ocp:tenant_logging_collector_input_record:rate
      expr: |-
        ocp:tenant_logging_collector:info * on(tag) group_left
          sum(rate(cluster_logging_collector_input_record_total{service="collector", tag=~"kubernetes.var.log.containers.*"}[1m])) by (tag)
---
# Source: tenant-insights/templates/servicemonitor.yaml
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: tenant-insights
  labels:
    stakater.com/tenant: white-oak
    helm.sh/chart: tenant-insights-0.0.41
    app.kubernetes.io/name: tenant-insights
    app.kubernetes.io/instance: my-tenant-insights
    app.kubernetes.io/version: "0.0.41"
    app.kubernetes.io/managed-by: Helm
spec:
  endpoints:
  - interval: 2m
    honorLabels: true
    path: /metrics
    port: metrics
    scheme: http
    tlsConfig:
      insecureSkipVerify: true
    relabelings:
    - regex: 'pod'
      action: labeldrop
  jobLabel: tenant-insights
  namespaceSelector:
    matchNames:
    - default
  selector:
    matchLabels:
      app.kubernetes.io/name: tenant-insights
      app.kubernetes.io/instance: my-tenant-insights
