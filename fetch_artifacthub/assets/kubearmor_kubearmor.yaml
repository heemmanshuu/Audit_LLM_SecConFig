---
# Source: kubearmor/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: kubearmor
  namespace: default
---
# Source: kubearmor/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: kubearmor-controller
  namespace: default
---
# Source: kubearmor/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: kubearmor-relay
  namespace: default
---
# Source: kubearmor/templates/secrets.yaml
apiVersion: v1
kind: Secret
type: kubernetes.io/tls
metadata:
  name: kubearmor-controller-webhook-server-cert
  labels:
    kubearmor-app: kubearmor-controller
  namespace: default
data:
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBNGxwaDZrZmR5YmtJZ29TUWNuRFJjeXVTU2hpalQ4RG5XVFlvRXg1UlFXazdHNkw1CjhNRHVQL0N2UlhNWnRqdHk1S3RDcjY5ZW5jR2toRm91ckRmL29wWEZpL1VDOFlwNW0zMVIxSFBUeWdWWGx6RXUKZ1FDd1B3bm5MbVhNR0QrQnNBekxwOHVLYTZQWTdYNTVVSzlNYkwwQTUvemVodThDeEhYaVdqOXc2SFIzcithQgpZSXhaVzFpVWU4OFF0NVJBQzE3dWREbDRwRHhROGM3QXgwU2wrYWxMdlR3czdwQzZuaDRUcEtndTJhRmExR1g5ClYySklNOCtnVFRoeUs1TVN4NkNmbDNpQkVNSjdhK0JvM1JKUm40clNYL1N5SkxmaUlGZXV1NzdzaFd3R1phR0EKd3dDaW9VODRBbzRvcU5qNHVkNHo4M0VaN2k4QWtGTE9vRFlpMlFJREFRQUJBb0lCQVFDbld0b0FSUWhuYUNZeAprZC9XclRFKzdOMHBhWlA5bUl1MGV3VWdOWTh3UktTT0oyNlNvYUxGcGFlQk9ydXM3OEZmN252TXQyWEdUL0RhClptOFJxQW1hNVE5OURqY1I3U2RDWG1MTktLSlRRS1hsUkZpMHlwU0UxMGFWR0hEUkVNdExKZnJCWWcxQ3pvN0oKOFhPeXd4bEhZR3EyRzFGUUJKRlFQalNRTTAzQW4wK2RBaHA3K2RodUJtbUpBQkpNelNLM0dGN2xPeXQwRWl2SQp0Y3dGcDhySlBGczhlYmN6WHg5YXd3RTVjelk4My8xYXVHa0NTS1FIWWVlc0JBSEMrK3paOHlGczFjSWUrcWRmCjlUSHJxalorTTRyWG9keHIvaFNaNHBBdnhzVy9uSDM1Rk1DbVpWTHpxL2pIRWE2bCtiR1ZrM1FGZEViQWhXb3QKUWFocVN6eXhBb0dCQU9TdjdlNFI1Mjg2NEIva2FiM3Z2eDhEbEduczhvNFp1dC9uU21MYzNLQk4xdEZRTTRpbwpTTmVLcTRUSElDYUpBRHZoWFdvMVdqRmQzUjJrUDdudnNQc1RyY3NlWWcvYUVOdW1ZVWZmRGVLdEZKYjh4MGQ5ClE2bEpDOGxablc4OWZvZ1ZsdlRYL29XTkJqNmZpa3ZmTEJxZUZqUzIyVi9SczlPdHRjcTcwOWpkQW9HQkFQMWoKRmhoN1Vxc0RoNXJYQjRTRE5NRFBoTW9VU3I0djFpQ3BqT3FrckhXRjFGMzhyNGFIaEVhcWQ2VmFrQUd0d1kyMgoybXZ5Mi9wSThBbWNUeTVuaTY0NmppdmxLVEZYSzlMby9lUCtHSXBsanF3TlJmWmF5cFdQOEtOVjZTN1lBWXBPCjBuekZKMlZLYnZyQlFyYXBEZjN4cUZ6dmg1TXpmOWpxT050bXl0UXRBb0dCQU1wSVhCdkR0b1dLL0lqNVVCZDAKSkFoWThFU3FGUHRoQXczZTFzdVFOWStPaXIvblEwNVVIT3FiZkpBY1d2SDdLVHZPWXdUNVlHaGVjS0l4a1RUMQpNZ1ZGS091TVdvMVBCSzVtQTVMQldOVHk2RTJPRnUvRGU4QVlIdGJoOEFKZjBMYXE4alp0Z0hPOWhKS01LSlpvCk4ranJnUlRyMEdlVFpJK1BEa2pmejhuNUFvR0FNcmptRUdxSFp1SmkvOVR4bFU0cWZqcE1TNk42UHM0V29CMHcKcnp2ZHBmenZRUTAzR2NnQTY2QnVLUFNUQlRNQ0h0c3VxQk5LZzdTY0VHQnczVW92Qk9hRjFUV2ZaRmdkMXE5NwpPMnQvQUIxS1RSaXZHNXliRnd0a1VWMytPcmxVdlpuL3VxaEF0WjhMempobm9XYi8vUWlsK2t5Y3FCUFVFTmo2CkhybFordFVDZ1lCOW9zQmkwSzBuNlIwODJ6aWxyWW9LeGFTemt4d3BBMit5QUpiN3Fyb08zZGp3L2NPVUdvbUwKUDdPVU9UMUdpamFVVGk2enNKU3pOTmx5YlhBTWw2dHhsZW9ZalJEdEFaeFVOcjVYK2QwbGpXQjMrQWsrTld6NwpMdys1MlUyVWYxUUZpNExrcmloUVpjWkl5R0N6Q1FiZStLcUlrSk9Yc01adkJ1YWh4c1doVnc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURkRENDQWx5Z0F3SUJBZ0lRY1FDV21MdExrK0hFVXZwYndOS0orekFOQmdrcWhraUc5dzBCQVFzRkFEQWYKTVIwd0d3WURWUVFERXhScmRXSmxZWEp0YjNJdFkyOXVkSEp2Ykd4bGNqQWVGdzB5TkRBNU1UWXdPVE15TXpsYQpGdzB5TnpBNU1UWXdPVE15TXpsYU1COHhIVEFiQmdOVkJBTVRGR3QxWW1WaGNtMXZjaTFqYjI1MGNtOXNiR1Z5Ck1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBNGxwaDZrZmR5YmtJZ29TUWNuRFIKY3l1U1NoaWpUOERuV1RZb0V4NVJRV2s3RzZMNThNRHVQL0N2UlhNWnRqdHk1S3RDcjY5ZW5jR2toRm91ckRmLwpvcFhGaS9VQzhZcDVtMzFSMUhQVHlnVlhsekV1Z1FDd1B3bm5MbVhNR0QrQnNBekxwOHVLYTZQWTdYNTVVSzlNCmJMMEE1L3plaHU4Q3hIWGlXajl3NkhSM3IrYUJZSXhaVzFpVWU4OFF0NVJBQzE3dWREbDRwRHhROGM3QXgwU2wKK2FsTHZUd3M3cEM2bmg0VHBLZ3UyYUZhMUdYOVYySklNOCtnVFRoeUs1TVN4NkNmbDNpQkVNSjdhK0JvM1JKUgpuNHJTWC9TeUpMZmlJRmV1dTc3c2hXd0daYUdBd3dDaW9VODRBbzRvcU5qNHVkNHo4M0VaN2k4QWtGTE9vRFlpCjJRSURBUUFCbzRHck1JR29NQTRHQTFVZER3RUIvd1FFQXdJRm9EQWRCZ05WSFNVRUZqQVVCZ2dyQmdFRkJRY0QKQVFZSUt3WUJCUVVIQXdJd0RBWURWUjBUQVFIL0JBSXdBREJwQmdOVkhSRUVZakJnZ2l4cmRXSmxZWEp0YjNJdApZMjl1ZEhKdmJHeGxjaTEzWldKb2IyOXJMWE5sY25acFkyVXVaR1ZtWVhWc2RJSXdhM1ZpWldGeWJXOXlMV052CmJuUnliMnhzWlhJdGQyVmlhRzl2YXkxelpYSjJhV05sTG1SbFptRjFiSFF1YzNaak1BMEdDU3FHU0liM0RRRUIKQ3dVQUE0SUJBUUJIK0Y3ZXIwSnJJNnJWMFE1VVRMNW9qVVUydlNmME9VNUs0RmorK01SUGNpK01aNm9jN1BFcgp0ZHVmYmRWM1VUS3BDMzVmWkZtMEl5SkxxdUp3azdNcHpmbnVmZW0xMzA2cGxlYWt1dlczVXZlZ1VrSEFMNVNBCkoxUGhJLzd2TEVrVGFvaVZUOEpVOUpaYnRxTEhJOGVvb1N5ZVFKN3BTTGNPZkJ5NDE3alpCSjJxbmdpQlM0Vy8KR2N6R2pjREVJSTVOZFZ2T0haNnBBL0NaWGs1SU9aOUxqWVg5YllhNWRDa0xCRXdiQzRXZi96TGdVR09sSXpkdwpkZUZyVG5BQmNIbjZ3REJrUlJDY1ZYd2hXdUZXV3pxc3ZXQy9udFJLTGVOSTI0VmxFeEpaeHlValFyUVpIUStiCmh0ZXNYUmhGTWR1VzZ2L3laMlkvaDV6OEVieFF3OVhkCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLakNDQWhLZ0F3SUJBZ0lSQU5nbnZsYVRSMVV1NjNxWGllcWdCZFF3RFFZSktvWklodmNOQVFFTEJRQXcKSHpFZE1Cc0dBMVVFQXhNVWEzVmlaV0Z5Ylc5eUxXTnZiblJ5YjJ4c1pYSXdIaGNOTWpRd09URTJNRGt6TWpNNQpXaGNOTWpjd09URTJNRGt6TWpNNVdqQWZNUjB3R3dZRFZRUURFeFJyZFdKbFlYSnRiM0l0WTI5dWRISnZiR3hsCmNqQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUtoNHUyQ3FtUVdobE9lb2hVd1gKaUNCK0lSZ2s4ZGFrY1k0bmRYNTU5ZTc1bnFBTFR3aG4za1YzWkl5MENuRVBKdGdTNzVaSFdMZ2ZXQm12UDhLMgorZGRDb0k2cW9HRzBGWDVIM1pKdGs4TkxCM0k2UjNmQU1FSU9pWVNZNUFJV0VJbTJXVGl6T3U1YUtTVER3Vy9jCnI2SFpJS0xxMmtvdnBzell3Nmh5MVdsQ280RHhtUUxXTm1DRzNYY25IU2hCZWdXK1F0NFNERllmNWMyL2dqR0sKRHllT0xGWnBuNnRTUElXR1FrOXk2a29LMy9OdVJKYmNFYWhqNm5LQUlmdHZRK1FaT2V6MXQ2eS9NMWVWYmVOcwplZUJwTjFkMGpQMFNJMUJmK0dQU3E3ZG1JMjNZL3A2UnlGK2JlaUVta3hkTFBWdUpXUjVuSGFoT1B4QkFwTThUCktIMENBd0VBQWFOaE1GOHdEZ1lEVlIwUEFRSC9CQVFEQWdLa01CMEdBMVVkSlFRV01CUUdDQ3NHQVFVRkJ3TUIKQmdnckJnRUZCUWNEQWpBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUIwR0ExVWREZ1FXQkJTb0Vhc0o0Y0JwMDZsbwpVRDZuanhOT3pjdFp0ekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBS29oUDFmNUxsVDhteHZ6Z1Nxa2NzUG0wCnR3V2RFMVlWd0tSU3RlUW4rSHpESDMyRzc3Sko3MlJHMDZLWUdiaW05NHFDeXNwcmN2Y045bTgzVENIZjl3NnIKUVkwemF0cnVxc2czNGh1cTZBNTBvWlZUS1REK0lub2U4VS9LQkFNZ2M2cFBtZEtYM1EwTUNsSEU5WHVjajdTTApteXpqb0ZqSDRqYXhuS05iMUZhNmlFYkhGZThtRU96QU1yRzh2T2dKTUtsVkxMREQrUURMT1RnV3NrbjZTQlBZCm9lUlgxVlM1WG5kU0ZRSWhtTGF6TVcrU1FKU1hIaWRtOGl1bnlpK2dDaVZZbU9oMkdvamgvLzNsbE1SS3ZwbC8KaDhueFZmK25VSG42Z1pueE96VmlHa3BPbnNSRnloK0dYb1g2bjBQcjMwREJrTDBHdVBCeDJVVzlUdXlHNEE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
---
# Source: kubearmor/templates/configmap.yaml
apiVersion: v1
data:
  defaultFilePosture: "audit"
  defaultCapabilitiesPosture: "audit"
  defaultNetworkPosture: "audit"
  visibility: "process,network"
  alertThrottling: "false"
  maxAlertPerSec: "10"
  throttleSec: "30"
kind: ConfigMap
metadata:
  labels:
    kubearmor-app: kubearmor-configmap
  name: kubearmor-config
  namespace: default
---
# Source: kubearmor/templates/crds/csp.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.4.1
  creationTimestamp: null
  name: kubearmorclusterpolicies.security.kubearmor.com
spec:
  group: security.kubearmor.com
  names:
    kind: KubeArmorClusterPolicy
    listKind: KubeArmorClusterPolicyList
    plural: kubearmorclusterpolicies
    shortNames:
    - csp
    singular: kubearmorclusterpolicy
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .spec.action
      name: Action
      priority: 10
      type: string
    - jsonPath: .spec.selector.matchExpressions
      name: Selector
      priority: 10
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: KubeArmorClusterPolicy is the Schema for the kubearmorclusterpolicies
          API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: KubeArmorClusterPolicySpec defines the desired state of KubeArmorClusterPolicy
            properties:
              action:
                enum:
                - Allow
                - Audit
                - Block
                type: string
              apparmor:
                type: string
              capabilities:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchCapabilities:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        capability:
                          pattern: (chown|dac_override|dac_read_search|fowner|fsetid|kill|setgid|setuid|setpcap|linux_immutable|net_bind_service|net_broadcast|net_admin|net_raw|ipc_lock|ipc_owner|sys_module|sys_rawio|sys_chroot|sys_ptrace|sys_pacct|sys_admin|sys_boot|sys_nice|sys_resource|sys_time|sys_tty_config|mknod|lease|audit_write|audit_control|setfcap|mac_override|mac_admin)$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - capability
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              file:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchDirectories:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        dir:
                          pattern: ^\/$|^\/.*\/$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        readOnly:
                          type: boolean
                        recursive:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - dir
                      type: object
                    type: array
                  matchPaths:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        path:
                          pattern: ^\/+.*[^\/]$
                          type: string
                        readOnly:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - path
                      type: object
                    type: array
                  matchPatterns:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        pattern:
                          type: string
                        readOnly:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - pattern
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              message:
                type: string
              network:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchProtocols:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        protocol:
                          pattern: (icmp|ICMP|tcp|TCP|udp|UDP|raw|RAW)$
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - protocol
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              process:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchDirectories:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        dir:
                          pattern: ^\/$|^\/.*\/$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        recursive:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - dir
                      type: object
                    type: array
                  matchPaths:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        execname:
                          pattern: ^[^\/]+$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        path:
                          pattern: ^\/+.*[^\/]$
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      type: object
                    type: array
                  matchPatterns:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        pattern:
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - pattern
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              selector:
                properties:
                  matchExpressions:
                    items:
                      properties:
                        key:
                          enum:
                          - namespace
                          type: string
                        operator:
                          enum:
                          - In
                          - NotIn
                          type: string
                        values:
                          items:
                            type: string
                          type: array
                      type: object
                    type: array
                type: object
              severity:
                maximum: 10
                minimum: 1
                type: integer
              syscalls:
                properties:
                  matchPaths:
                    items:
                      properties:
                        fromSource:
                          items:
                            properties:
                              dir:
                                type: string
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                              recursive:
                                type: boolean
                            type: object
                          type: array
                        path:
                          pattern: (^\/+.*[^\/]$)|(^\/$|^\/.*\/$)
                          type: string
                        recursive:
                          type: boolean
                        syscall:
                          items:
                            enum:
                            - read
                            - write
                            - open
                            - close
                            - stat
                            - fstat
                            - lstat
                            - poll
                            - lseek
                            - mmap
                            - mprotect
                            - munmap
                            - brk
                            - rt_sigaction
                            - rt_sigprocmask
                            - rt_sigreturn
                            - ioctl
                            - pread64
                            - pwrite64
                            - readv
                            - writev
                            - access
                            - pipe
                            - select
                            - sched_yield
                            - mremap
                            - msync
                            - mincore
                            - madvise
                            - shmget
                            - shmat
                            - shmctl
                            - dup
                            - dup2
                            - pause
                            - nanosleep
                            - getitimer
                            - alarm
                            - setitimer
                            - getpid
                            - sendfile
                            - socket
                            - connect
                            - accept
                            - sendto
                            - recvfrom
                            - sendmsg
                            - recvmsg
                            - shutdown
                            - bind
                            - listen
                            - getsockname
                            - getpeername
                            - socketpair
                            - setsockopt
                            - getsockopt
                            - clone
                            - fork
                            - vfork
                            - execve
                            - exit
                            - wait4
                            - kill
                            - uname
                            - semget
                            - semop
                            - semctl
                            - shmdt
                            - msgget
                            - msgsnd
                            - msgrcv
                            - msgctl
                            - fcntl
                            - flock
                            - fsync
                            - fdatasync
                            - truncate
                            - ftruncate
                            - getdents
                            - getcwd
                            - chdir
                            - fchdir
                            - rename
                            - mkdir
                            - rmdir
                            - creat
                            - link
                            - unlink
                            - symlink
                            - readlink
                            - chmod
                            - fchmod
                            - chown
                            - fchown
                            - lchown
                            - umask
                            - gettimeofday
                            - getrlimit
                            - getrusage
                            - sysinfo
                            - times
                            - ptrace
                            - getuid
                            - syslog
                            - getgid
                            - setuid
                            - setgid
                            - geteuid
                            - getegid
                            - setpgid
                            - getppid
                            - getpgrp
                            - setsid
                            - setreuid
                            - setregid
                            - getgroups
                            - setgroups
                            - setresuid
                            - getresuid
                            - setresgid
                            - getresgid
                            - getpgid
                            - setfsuid
                            - setfsgid
                            - getsid
                            - capget
                            - capset
                            - rt_sigpending
                            - rt_sigtimedwait
                            - rt_sigqueueinfo
                            - rt_sigsuspend
                            - sigaltstack
                            - utime
                            - mknod
                            - uselib
                            - personality
                            - ustat
                            - statfs
                            - fstatfs
                            - sysfs
                            - getpriority
                            - setpriority
                            - sched_setparam
                            - sched_getparam
                            - sched_setscheduler
                            - sched_getscheduler
                            - sched_get_priority_max
                            - sched_get_priority_min
                            - sched_rr_get_interval
                            - mlock
                            - munlock
                            - mlockall
                            - munlockall
                            - vhangup
                            - modify_ldt
                            - pivot_root
                            - _sysctl
                            - prctl
                            - arch_prctl
                            - adjtimex
                            - setrlimit
                            - chroot
                            - sync
                            - acct
                            - settimeofday
                            - mount
                            - umount2
                            - swapon
                            - swapoff
                            - reboot
                            - sethostname
                            - setdomainname
                            - iopl
                            - ioperm
                            - create_module
                            - init_module
                            - delete_module
                            - get_kernel_syms
                            - query_module
                            - quotactl
                            - nfsservctl
                            - getpmsg
                            - putpmsg
                            - afs_syscall
                            - tuxcall
                            - security
                            - gettid
                            - readahead
                            - setxattr
                            - lsetxattr
                            - fsetxattr
                            - getxattr
                            - lgetxattr
                            - fgetxattr
                            - listxattr
                            - llistxattr
                            - flistxattr
                            - removexattr
                            - lremovexattr
                            - fremovexattr
                            - tkill
                            - time
                            - futex
                            - sched_setaffinity
                            - sched_getaffinity
                            - set_thread_area
                            - io_setup
                            - io_destroy
                            - io_getevents
                            - io_submit
                            - io_cancel
                            - get_thread_area
                            - lookup_dcookie
                            - epoll_create
                            - epoll_ctl_old
                            - epoll_wait_old
                            - remap_file_pages
                            - getdents64
                            - set_tid_address
                            - restart_syscall
                            - semtimedop
                            - fadvise64
                            - timer_create
                            - timer_settime
                            - timer_gettime
                            - timer_getoverrun
                            - timer_delete
                            - clock_settime
                            - clock_gettime
                            - clock_getres
                            - clock_nanosleep
                            - exit_group
                            - epoll_wait
                            - epoll_ctl
                            - tgkill
                            - utimes
                            - vserver
                            - mbind
                            - set_mempolicy
                            - get_mempolicy
                            - mq_open
                            - mq_unlink
                            - mq_timedsend
                            - mq_timedreceive
                            - mq_notify
                            - mq_getsetattr
                            - kexec_load
                            - waitid
                            - add_key
                            - request_key
                            - keyctl
                            - ioprio_set
                            - ioprio_get
                            - inotify_init
                            - inotify_add_watch
                            - inotify_rm_watch
                            - migrate_pages
                            - openat
                            - mkdirat
                            - mknodat
                            - fchownat
                            - futimesat
                            - newfstatat
                            - unlinkat
                            - renameat
                            - linkat
                            - symlinkat
                            - readlinkat
                            - fchmodat
                            - faccessat
                            - pselect6
                            - ppoll
                            - unshare
                            - set_robust_list
                            - get_robust_list
                            - splice
                            - tee
                            - sync_file_range
                            - vmsplice
                            - move_pages
                            - utimensat
                            - epoll_pwait
                            - signalfd
                            - timerfd_create
                            - eventfd
                            - fallocate
                            - timerfd_settime
                            - timerfd_gettime
                            - accept4
                            - signalfd4
                            - eventfd2
                            - epoll_create1
                            - dup3
                            - pipe2
                            - inotify_init1
                            - preadv
                            - pwritev
                            - rt_tgsigqueueinfo
                            - perf_event_open
                            - recvmmsg
                            - fanotify_init
                            - fanotify_mark
                            - prlimit64
                            - name_to_handle_at
                            - open_by_handle_at
                            - clock_adjtime
                            - syncfs
                            - sendmmsg
                            - setns
                            - getcpu
                            - process_vm_readv
                            - process_vm_writev
                            - kcmp
                            - finit_module
                            - sched_setattr
                            - sched_getattr
                            - renameat2
                            - seccomp
                            - getrandom
                            - memfd_create
                            - kexec_file_load
                            - bpf
                            - execveat
                            - userfaultfd
                            - membarrier
                            - mlock2
                            - copy_file_range
                            - preadv2
                            - pwritev2
                            - pkey_mprotect
                            - pkey_alloc
                            - pkey_free
                            - statx
                            - io_pgetevents
                            - rseq
                            type: string
                          type: array
                      type: object
                    type: array
                  matchSyscalls:
                    items:
                      properties:
                        fromSource:
                          items:
                            properties:
                              dir:
                                type: string
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                              recursive:
                                type: boolean
                            type: object
                          type: array
                        syscall:
                          items:
                            enum:
                            - read
                            - write
                            - open
                            - close
                            - stat
                            - fstat
                            - lstat
                            - poll
                            - lseek
                            - mmap
                            - mprotect
                            - munmap
                            - brk
                            - rt_sigaction
                            - rt_sigprocmask
                            - rt_sigreturn
                            - ioctl
                            - pread64
                            - pwrite64
                            - readv
                            - writev
                            - access
                            - pipe
                            - select
                            - sched_yield
                            - mremap
                            - msync
                            - mincore
                            - madvise
                            - shmget
                            - shmat
                            - shmctl
                            - dup
                            - dup2
                            - pause
                            - nanosleep
                            - getitimer
                            - alarm
                            - setitimer
                            - getpid
                            - sendfile
                            - socket
                            - connect
                            - accept
                            - sendto
                            - recvfrom
                            - sendmsg
                            - recvmsg
                            - shutdown
                            - bind
                            - listen
                            - getsockname
                            - getpeername
                            - socketpair
                            - setsockopt
                            - getsockopt
                            - clone
                            - fork
                            - vfork
                            - execve
                            - exit
                            - wait4
                            - kill
                            - uname
                            - semget
                            - semop
                            - semctl
                            - shmdt
                            - msgget
                            - msgsnd
                            - msgrcv
                            - msgctl
                            - fcntl
                            - flock
                            - fsync
                            - fdatasync
                            - truncate
                            - ftruncate
                            - getdents
                            - getcwd
                            - chdir
                            - fchdir
                            - rename
                            - mkdir
                            - rmdir
                            - creat
                            - link
                            - unlink
                            - symlink
                            - readlink
                            - chmod
                            - fchmod
                            - chown
                            - fchown
                            - lchown
                            - umask
                            - gettimeofday
                            - getrlimit
                            - getrusage
                            - sysinfo
                            - times
                            - ptrace
                            - getuid
                            - syslog
                            - getgid
                            - setuid
                            - setgid
                            - geteuid
                            - getegid
                            - setpgid
                            - getppid
                            - getpgrp
                            - setsid
                            - setreuid
                            - setregid
                            - getgroups
                            - setgroups
                            - setresuid
                            - getresuid
                            - setresgid
                            - getresgid
                            - getpgid
                            - setfsuid
                            - setfsgid
                            - getsid
                            - capget
                            - capset
                            - rt_sigpending
                            - rt_sigtimedwait
                            - rt_sigqueueinfo
                            - rt_sigsuspend
                            - sigaltstack
                            - utime
                            - mknod
                            - uselib
                            - personality
                            - ustat
                            - statfs
                            - fstatfs
                            - sysfs
                            - getpriority
                            - setpriority
                            - sched_setparam
                            - sched_getparam
                            - sched_setscheduler
                            - sched_getscheduler
                            - sched_get_priority_max
                            - sched_get_priority_min
                            - sched_rr_get_interval
                            - mlock
                            - munlock
                            - mlockall
                            - munlockall
                            - vhangup
                            - modify_ldt
                            - pivot_root
                            - _sysctl
                            - prctl
                            - arch_prctl
                            - adjtimex
                            - setrlimit
                            - chroot
                            - sync
                            - acct
                            - settimeofday
                            - mount
                            - umount2
                            - swapon
                            - swapoff
                            - reboot
                            - sethostname
                            - setdomainname
                            - iopl
                            - ioperm
                            - create_module
                            - init_module
                            - delete_module
                            - get_kernel_syms
                            - query_module
                            - quotactl
                            - nfsservctl
                            - getpmsg
                            - putpmsg
                            - afs_syscall
                            - tuxcall
                            - security
                            - gettid
                            - readahead
                            - setxattr
                            - lsetxattr
                            - fsetxattr
                            - getxattr
                            - lgetxattr
                            - fgetxattr
                            - listxattr
                            - llistxattr
                            - flistxattr
                            - removexattr
                            - lremovexattr
                            - fremovexattr
                            - tkill
                            - time
                            - futex
                            - sched_setaffinity
                            - sched_getaffinity
                            - set_thread_area
                            - io_setup
                            - io_destroy
                            - io_getevents
                            - io_submit
                            - io_cancel
                            - get_thread_area
                            - lookup_dcookie
                            - epoll_create
                            - epoll_ctl_old
                            - epoll_wait_old
                            - remap_file_pages
                            - getdents64
                            - set_tid_address
                            - restart_syscall
                            - semtimedop
                            - fadvise64
                            - timer_create
                            - timer_settime
                            - timer_gettime
                            - timer_getoverrun
                            - timer_delete
                            - clock_settime
                            - clock_gettime
                            - clock_getres
                            - clock_nanosleep
                            - exit_group
                            - epoll_wait
                            - epoll_ctl
                            - tgkill
                            - utimes
                            - vserver
                            - mbind
                            - set_mempolicy
                            - get_mempolicy
                            - mq_open
                            - mq_unlink
                            - mq_timedsend
                            - mq_timedreceive
                            - mq_notify
                            - mq_getsetattr
                            - kexec_load
                            - waitid
                            - add_key
                            - request_key
                            - keyctl
                            - ioprio_set
                            - ioprio_get
                            - inotify_init
                            - inotify_add_watch
                            - inotify_rm_watch
                            - migrate_pages
                            - openat
                            - mkdirat
                            - mknodat
                            - fchownat
                            - futimesat
                            - newfstatat
                            - unlinkat
                            - renameat
                            - linkat
                            - symlinkat
                            - readlinkat
                            - fchmodat
                            - faccessat
                            - pselect6
                            - ppoll
                            - unshare
                            - set_robust_list
                            - get_robust_list
                            - splice
                            - tee
                            - sync_file_range
                            - vmsplice
                            - move_pages
                            - utimensat
                            - epoll_pwait
                            - signalfd
                            - timerfd_create
                            - eventfd
                            - fallocate
                            - timerfd_settime
                            - timerfd_gettime
                            - accept4
                            - signalfd4
                            - eventfd2
                            - epoll_create1
                            - dup3
                            - pipe2
                            - inotify_init1
                            - preadv
                            - pwritev
                            - rt_tgsigqueueinfo
                            - perf_event_open
                            - recvmmsg
                            - fanotify_init
                            - fanotify_mark
                            - prlimit64
                            - name_to_handle_at
                            - open_by_handle_at
                            - clock_adjtime
                            - syncfs
                            - sendmmsg
                            - setns
                            - getcpu
                            - process_vm_readv
                            - process_vm_writev
                            - kcmp
                            - finit_module
                            - sched_setattr
                            - sched_getattr
                            - renameat2
                            - seccomp
                            - getrandom
                            - memfd_create
                            - kexec_file_load
                            - bpf
                            - execveat
                            - userfaultfd
                            - membarrier
                            - mlock2
                            - copy_file_range
                            - preadv2
                            - pwritev2
                            - pkey_mprotect
                            - pkey_alloc
                            - pkey_free
                            - statx
                            - io_pgetevents
                            - rseq
                            type: string
                          type: array
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              tags:
                items:
                  type: string
                type: array
            type: object
          status:
            description: KubeArmorClusterPolicyStatus defines the observed state of
              KubeArmorCLusterPolicy
            properties:
              status:
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
# Source: kubearmor/templates/crds/hsp.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.4.1
  creationTimestamp: null
  name: kubearmorhostpolicies.security.kubearmor.com
spec:
  group: security.kubearmor.com
  names:
    kind: KubeArmorHostPolicy
    listKind: KubeArmorHostPolicyList
    plural: kubearmorhostpolicies
    shortNames:
    - hsp
    singular: kubearmorhostpolicy
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .spec.action
      name: Action
      priority: 10
      type: string
    - jsonPath: .spec.nodeSelector.matchLabels
      name: Selector
      priority: 10
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: KubeArmorHostPolicy is the Schema for the kubearmorhostpolicies
          API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: KubeArmorHostPolicySpec defines the desired state of KubeArmorHostPolicy
            properties:
              action:
                enum:
                - Allow
                - Audit
                - Block
                type: string
              apparmor:
                type: string
              capabilities:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchCapabilities:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        capability:
                          pattern: (chown|dac_override|dac_read_search|fowner|fsetid|kill|setgid|setuid|setpcap|linux_immutable|net_bind_service|net_broadcast|net_admin|net_raw|ipc_lock|ipc_owner|sys_module|sys_rawio|sys_chroot|sys_ptrace|sys_pacct|sys_admin|sys_boot|sys_nice|sys_resource|sys_time|sys_tty_config|mknod|lease|audit_write|audit_control|setfcap|mac_override|mac_admin)$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - capability
                      - fromSource
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              file:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchDirectories:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        dir:
                          pattern: ^\/$|^\/.*\/$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        readOnly:
                          type: boolean
                        recursive:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - dir
                      type: object
                    type: array
                  matchPaths:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        path:
                          pattern: ^\/+.*[^\/]$
                          type: string
                        readOnly:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - path
                      type: object
                    type: array
                  matchPatterns:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        pattern:
                          type: string
                        readOnly:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - pattern
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              message:
                type: string
              network:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchProtocols:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        protocol:
                          pattern: (icmp|ICMP|tcp|TCP|udp|UDP|raw|RAW)$
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - fromSource
                      - protocol
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              nodeSelector:
                properties:
                  matchLabels:
                    additionalProperties:
                      type: string
                    type: object
                type: object
              process:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchDirectories:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        dir:
                          pattern: ^\/$|^\/.*\/$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        recursive:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - dir
                      type: object
                    type: array
                  matchPaths:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        execname:
                          pattern: ^[^\/]+$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        path:
                          pattern: ^\/+.*[^\/]$
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      type: object
                    type: array
                  matchPatterns:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        pattern:
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - pattern
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              severity:
                maximum: 10
                minimum: 1
                type: integer
              syscalls:
                properties:
                  matchPaths:
                    items:
                      properties:
                        fromSource:
                          items:
                            properties:
                              dir:
                                type: string
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                              recursive:
                                type: boolean
                            type: object
                          type: array
                        path:
                          pattern: (^\/+.*[^\/]$)|(^\/$|^\/.*\/$)
                          type: string
                        recursive:
                          type: boolean
                        syscall:
                          items:
                            enum:
                            - read
                            - write
                            - open
                            - close
                            - stat
                            - fstat
                            - lstat
                            - poll
                            - lseek
                            - mmap
                            - mprotect
                            - munmap
                            - brk
                            - rt_sigaction
                            - rt_sigprocmask
                            - rt_sigreturn
                            - ioctl
                            - pread64
                            - pwrite64
                            - readv
                            - writev
                            - access
                            - pipe
                            - select
                            - sched_yield
                            - mremap
                            - msync
                            - mincore
                            - madvise
                            - shmget
                            - shmat
                            - shmctl
                            - dup
                            - dup2
                            - pause
                            - nanosleep
                            - getitimer
                            - alarm
                            - setitimer
                            - getpid
                            - sendfile
                            - socket
                            - connect
                            - accept
                            - sendto
                            - recvfrom
                            - sendmsg
                            - recvmsg
                            - shutdown
                            - bind
                            - listen
                            - getsockname
                            - getpeername
                            - socketpair
                            - setsockopt
                            - getsockopt
                            - clone
                            - fork
                            - vfork
                            - execve
                            - exit
                            - wait4
                            - kill
                            - uname
                            - semget
                            - semop
                            - semctl
                            - shmdt
                            - msgget
                            - msgsnd
                            - msgrcv
                            - msgctl
                            - fcntl
                            - flock
                            - fsync
                            - fdatasync
                            - truncate
                            - ftruncate
                            - getdents
                            - getcwd
                            - chdir
                            - fchdir
                            - rename
                            - mkdir
                            - rmdir
                            - creat
                            - link
                            - unlink
                            - symlink
                            - readlink
                            - chmod
                            - fchmod
                            - chown
                            - fchown
                            - lchown
                            - umask
                            - gettimeofday
                            - getrlimit
                            - getrusage
                            - sysinfo
                            - times
                            - ptrace
                            - getuid
                            - syslog
                            - getgid
                            - setuid
                            - setgid
                            - geteuid
                            - getegid
                            - setpgid
                            - getppid
                            - getpgrp
                            - setsid
                            - setreuid
                            - setregid
                            - getgroups
                            - setgroups
                            - setresuid
                            - getresuid
                            - setresgid
                            - getresgid
                            - getpgid
                            - setfsuid
                            - setfsgid
                            - getsid
                            - capget
                            - capset
                            - rt_sigpending
                            - rt_sigtimedwait
                            - rt_sigqueueinfo
                            - rt_sigsuspend
                            - sigaltstack
                            - utime
                            - mknod
                            - uselib
                            - personality
                            - ustat
                            - statfs
                            - fstatfs
                            - sysfs
                            - getpriority
                            - setpriority
                            - sched_setparam
                            - sched_getparam
                            - sched_setscheduler
                            - sched_getscheduler
                            - sched_get_priority_max
                            - sched_get_priority_min
                            - sched_rr_get_interval
                            - mlock
                            - munlock
                            - mlockall
                            - munlockall
                            - vhangup
                            - modify_ldt
                            - pivot_root
                            - _sysctl
                            - prctl
                            - arch_prctl
                            - adjtimex
                            - setrlimit
                            - chroot
                            - sync
                            - acct
                            - settimeofday
                            - mount
                            - umount2
                            - swapon
                            - swapoff
                            - reboot
                            - sethostname
                            - setdomainname
                            - iopl
                            - ioperm
                            - create_module
                            - init_module
                            - delete_module
                            - get_kernel_syms
                            - query_module
                            - quotactl
                            - nfsservctl
                            - getpmsg
                            - putpmsg
                            - afs_syscall
                            - tuxcall
                            - security
                            - gettid
                            - readahead
                            - setxattr
                            - lsetxattr
                            - fsetxattr
                            - getxattr
                            - lgetxattr
                            - fgetxattr
                            - listxattr
                            - llistxattr
                            - flistxattr
                            - removexattr
                            - lremovexattr
                            - fremovexattr
                            - tkill
                            - time
                            - futex
                            - sched_setaffinity
                            - sched_getaffinity
                            - set_thread_area
                            - io_setup
                            - io_destroy
                            - io_getevents
                            - io_submit
                            - io_cancel
                            - get_thread_area
                            - lookup_dcookie
                            - epoll_create
                            - epoll_ctl_old
                            - epoll_wait_old
                            - remap_file_pages
                            - getdents64
                            - set_tid_address
                            - restart_syscall
                            - semtimedop
                            - fadvise64
                            - timer_create
                            - timer_settime
                            - timer_gettime
                            - timer_getoverrun
                            - timer_delete
                            - clock_settime
                            - clock_gettime
                            - clock_getres
                            - clock_nanosleep
                            - exit_group
                            - epoll_wait
                            - epoll_ctl
                            - tgkill
                            - utimes
                            - vserver
                            - mbind
                            - set_mempolicy
                            - get_mempolicy
                            - mq_open
                            - mq_unlink
                            - mq_timedsend
                            - mq_timedreceive
                            - mq_notify
                            - mq_getsetattr
                            - kexec_load
                            - waitid
                            - add_key
                            - request_key
                            - keyctl
                            - ioprio_set
                            - ioprio_get
                            - inotify_init
                            - inotify_add_watch
                            - inotify_rm_watch
                            - migrate_pages
                            - openat
                            - mkdirat
                            - mknodat
                            - fchownat
                            - futimesat
                            - newfstatat
                            - unlinkat
                            - renameat
                            - linkat
                            - symlinkat
                            - readlinkat
                            - fchmodat
                            - faccessat
                            - pselect6
                            - ppoll
                            - unshare
                            - set_robust_list
                            - get_robust_list
                            - splice
                            - tee
                            - sync_file_range
                            - vmsplice
                            - move_pages
                            - utimensat
                            - epoll_pwait
                            - signalfd
                            - timerfd_create
                            - eventfd
                            - fallocate
                            - timerfd_settime
                            - timerfd_gettime
                            - accept4
                            - signalfd4
                            - eventfd2
                            - epoll_create1
                            - dup3
                            - pipe2
                            - inotify_init1
                            - preadv
                            - pwritev
                            - rt_tgsigqueueinfo
                            - perf_event_open
                            - recvmmsg
                            - fanotify_init
                            - fanotify_mark
                            - prlimit64
                            - name_to_handle_at
                            - open_by_handle_at
                            - clock_adjtime
                            - syncfs
                            - sendmmsg
                            - setns
                            - getcpu
                            - process_vm_readv
                            - process_vm_writev
                            - kcmp
                            - finit_module
                            - sched_setattr
                            - sched_getattr
                            - renameat2
                            - seccomp
                            - getrandom
                            - memfd_create
                            - kexec_file_load
                            - bpf
                            - execveat
                            - userfaultfd
                            - membarrier
                            - mlock2
                            - copy_file_range
                            - preadv2
                            - pwritev2
                            - pkey_mprotect
                            - pkey_alloc
                            - pkey_free
                            - statx
                            - io_pgetevents
                            - rseq
                            type: string
                          type: array
                      type: object
                    type: array
                  matchSyscalls:
                    items:
                      properties:
                        fromSource:
                          items:
                            properties:
                              dir:
                                type: string
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                              recursive:
                                type: boolean
                            type: object
                          type: array
                        syscall:
                          items:
                            enum:
                            - read
                            - write
                            - open
                            - close
                            - stat
                            - fstat
                            - lstat
                            - poll
                            - lseek
                            - mmap
                            - mprotect
                            - munmap
                            - brk
                            - rt_sigaction
                            - rt_sigprocmask
                            - rt_sigreturn
                            - ioctl
                            - pread64
                            - pwrite64
                            - readv
                            - writev
                            - access
                            - pipe
                            - select
                            - sched_yield
                            - mremap
                            - msync
                            - mincore
                            - madvise
                            - shmget
                            - shmat
                            - shmctl
                            - dup
                            - dup2
                            - pause
                            - nanosleep
                            - getitimer
                            - alarm
                            - setitimer
                            - getpid
                            - sendfile
                            - socket
                            - connect
                            - accept
                            - sendto
                            - recvfrom
                            - sendmsg
                            - recvmsg
                            - shutdown
                            - bind
                            - listen
                            - getsockname
                            - getpeername
                            - socketpair
                            - setsockopt
                            - getsockopt
                            - clone
                            - fork
                            - vfork
                            - execve
                            - exit
                            - wait4
                            - kill
                            - uname
                            - semget
                            - semop
                            - semctl
                            - shmdt
                            - msgget
                            - msgsnd
                            - msgrcv
                            - msgctl
                            - fcntl
                            - flock
                            - fsync
                            - fdatasync
                            - truncate
                            - ftruncate
                            - getdents
                            - getcwd
                            - chdir
                            - fchdir
                            - rename
                            - mkdir
                            - rmdir
                            - creat
                            - link
                            - unlink
                            - symlink
                            - readlink
                            - chmod
                            - fchmod
                            - chown
                            - fchown
                            - lchown
                            - umask
                            - gettimeofday
                            - getrlimit
                            - getrusage
                            - sysinfo
                            - times
                            - ptrace
                            - getuid
                            - syslog
                            - getgid
                            - setuid
                            - setgid
                            - geteuid
                            - getegid
                            - setpgid
                            - getppid
                            - getpgrp
                            - setsid
                            - setreuid
                            - setregid
                            - getgroups
                            - setgroups
                            - setresuid
                            - getresuid
                            - setresgid
                            - getresgid
                            - getpgid
                            - setfsuid
                            - setfsgid
                            - getsid
                            - capget
                            - capset
                            - rt_sigpending
                            - rt_sigtimedwait
                            - rt_sigqueueinfo
                            - rt_sigsuspend
                            - sigaltstack
                            - utime
                            - mknod
                            - uselib
                            - personality
                            - ustat
                            - statfs
                            - fstatfs
                            - sysfs
                            - getpriority
                            - setpriority
                            - sched_setparam
                            - sched_getparam
                            - sched_setscheduler
                            - sched_getscheduler
                            - sched_get_priority_max
                            - sched_get_priority_min
                            - sched_rr_get_interval
                            - mlock
                            - munlock
                            - mlockall
                            - munlockall
                            - vhangup
                            - modify_ldt
                            - pivot_root
                            - _sysctl
                            - prctl
                            - arch_prctl
                            - adjtimex
                            - setrlimit
                            - chroot
                            - sync
                            - acct
                            - settimeofday
                            - mount
                            - umount2
                            - swapon
                            - swapoff
                            - reboot
                            - sethostname
                            - setdomainname
                            - iopl
                            - ioperm
                            - create_module
                            - init_module
                            - delete_module
                            - get_kernel_syms
                            - query_module
                            - quotactl
                            - nfsservctl
                            - getpmsg
                            - putpmsg
                            - afs_syscall
                            - tuxcall
                            - security
                            - gettid
                            - readahead
                            - setxattr
                            - lsetxattr
                            - fsetxattr
                            - getxattr
                            - lgetxattr
                            - fgetxattr
                            - listxattr
                            - llistxattr
                            - flistxattr
                            - removexattr
                            - lremovexattr
                            - fremovexattr
                            - tkill
                            - time
                            - futex
                            - sched_setaffinity
                            - sched_getaffinity
                            - set_thread_area
                            - io_setup
                            - io_destroy
                            - io_getevents
                            - io_submit
                            - io_cancel
                            - get_thread_area
                            - lookup_dcookie
                            - epoll_create
                            - epoll_ctl_old
                            - epoll_wait_old
                            - remap_file_pages
                            - getdents64
                            - set_tid_address
                            - restart_syscall
                            - semtimedop
                            - fadvise64
                            - timer_create
                            - timer_settime
                            - timer_gettime
                            - timer_getoverrun
                            - timer_delete
                            - clock_settime
                            - clock_gettime
                            - clock_getres
                            - clock_nanosleep
                            - exit_group
                            - epoll_wait
                            - epoll_ctl
                            - tgkill
                            - utimes
                            - vserver
                            - mbind
                            - set_mempolicy
                            - get_mempolicy
                            - mq_open
                            - mq_unlink
                            - mq_timedsend
                            - mq_timedreceive
                            - mq_notify
                            - mq_getsetattr
                            - kexec_load
                            - waitid
                            - add_key
                            - request_key
                            - keyctl
                            - ioprio_set
                            - ioprio_get
                            - inotify_init
                            - inotify_add_watch
                            - inotify_rm_watch
                            - migrate_pages
                            - openat
                            - mkdirat
                            - mknodat
                            - fchownat
                            - futimesat
                            - newfstatat
                            - unlinkat
                            - renameat
                            - linkat
                            - symlinkat
                            - readlinkat
                            - fchmodat
                            - faccessat
                            - pselect6
                            - ppoll
                            - unshare
                            - set_robust_list
                            - get_robust_list
                            - splice
                            - tee
                            - sync_file_range
                            - vmsplice
                            - move_pages
                            - utimensat
                            - epoll_pwait
                            - signalfd
                            - timerfd_create
                            - eventfd
                            - fallocate
                            - timerfd_settime
                            - timerfd_gettime
                            - accept4
                            - signalfd4
                            - eventfd2
                            - epoll_create1
                            - dup3
                            - pipe2
                            - inotify_init1
                            - preadv
                            - pwritev
                            - rt_tgsigqueueinfo
                            - perf_event_open
                            - recvmmsg
                            - fanotify_init
                            - fanotify_mark
                            - prlimit64
                            - name_to_handle_at
                            - open_by_handle_at
                            - clock_adjtime
                            - syncfs
                            - sendmmsg
                            - setns
                            - getcpu
                            - process_vm_readv
                            - process_vm_writev
                            - kcmp
                            - finit_module
                            - sched_setattr
                            - sched_getattr
                            - renameat2
                            - seccomp
                            - getrandom
                            - memfd_create
                            - kexec_file_load
                            - bpf
                            - execveat
                            - userfaultfd
                            - membarrier
                            - mlock2
                            - copy_file_range
                            - preadv2
                            - pwritev2
                            - pkey_mprotect
                            - pkey_alloc
                            - pkey_free
                            - statx
                            - io_pgetevents
                            - rseq
                            type: string
                          type: array
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              tags:
                items:
                  type: string
                type: array
            required:
            - nodeSelector
            type: object
          status:
            description: KubeArmorHostPolicyStatus defines the observed state of KubeArmorHostPolicy
            properties:
              status:
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
# Source: kubearmor/templates/crds/ksp.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.4.1
  creationTimestamp: null
  name: kubearmorpolicies.security.kubearmor.com
spec:
  group: security.kubearmor.com
  names:
    kind: KubeArmorPolicy
    listKind: KubeArmorPolicyList
    plural: kubearmorpolicies
    shortNames:
    - ksp
    singular: kubearmorpolicy
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .spec.action
      name: Action
      priority: 10
      type: string
    - jsonPath: .spec.selector.matchLabels
      name: Selector
      priority: 10
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: KubeArmorPolicy is the Schema for the kubearmorpolicies API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: KubeArmorPolicySpec defines the desired state of KubeArmorPolicy
            properties:
              action:
                enum:
                - Allow
                - Audit
                - Block
                type: string
              apparmor:
                type: string
              capabilities:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchCapabilities:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        capability:
                          pattern: (chown|dac_override|dac_read_search|fowner|fsetid|kill|setgid|setuid|setpcap|linux_immutable|net_bind_service|net_broadcast|net_admin|net_raw|ipc_lock|ipc_owner|sys_module|sys_rawio|sys_chroot|sys_ptrace|sys_pacct|sys_admin|sys_boot|sys_nice|sys_resource|sys_time|sys_tty_config|mknod|lease|audit_write|audit_control|setfcap|mac_override|mac_admin)$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - capability
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              file:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchDirectories:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        dir:
                          pattern: ^\/$|^\/.*\/$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        readOnly:
                          type: boolean
                        recursive:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - dir
                      type: object
                    type: array
                  matchPaths:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        path:
                          pattern: ^\/+.*[^\/]$
                          type: string
                        readOnly:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - path
                      type: object
                    type: array
                  matchPatterns:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        pattern:
                          type: string
                        readOnly:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - pattern
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              message:
                type: string
              network:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchProtocols:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        protocol:
                          pattern: (icmp|ICMP|tcp|TCP|udp|UDP|raw|RAW)$
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - protocol
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              process:
                properties:
                  action:
                    enum:
                    - Allow
                    - Audit
                    - Block
                    type: string
                  matchDirectories:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        dir:
                          pattern: ^\/$|^\/.*\/$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        recursive:
                          type: boolean
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - dir
                      type: object
                    type: array
                  matchPaths:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        execname:
                          pattern: ^[^\/]+$
                          type: string
                        fromSource:
                          items:
                            properties:
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                            type: object
                          type: array
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        path:
                          pattern: ^\/+.*[^\/]$
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      type: object
                    type: array
                  matchPatterns:
                    items:
                      properties:
                        action:
                          enum:
                          - Allow
                          - Audit
                          - Block
                          type: string
                        message:
                          type: string
                        ownerOnly:
                          type: boolean
                        pattern:
                          type: string
                        severity:
                          maximum: 10
                          minimum: 1
                          type: integer
                        tags:
                          items:
                            type: string
                          type: array
                      required:
                      - pattern
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              selector:
                properties:
                  matchLabels:
                    additionalProperties:
                      type: string
                    type: object
                type: object
              severity:
                maximum: 10
                minimum: 1
                type: integer
              syscalls:
                properties:
                  matchPaths:
                    items:
                      properties:
                        fromSource:
                          items:
                            properties:
                              dir:
                                type: string
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                              recursive:
                                type: boolean
                            type: object
                          type: array
                        path:
                          pattern: (^\/+.*[^\/]$)|(^\/$|^\/.*\/$)
                          type: string
                        recursive:
                          type: boolean
                        syscall:
                          items:
                            enum:
                            - read
                            - write
                            - open
                            - close
                            - stat
                            - fstat
                            - lstat
                            - poll
                            - lseek
                            - mmap
                            - mprotect
                            - munmap
                            - brk
                            - rt_sigaction
                            - rt_sigprocmask
                            - rt_sigreturn
                            - ioctl
                            - pread64
                            - pwrite64
                            - readv
                            - writev
                            - access
                            - pipe
                            - select
                            - sched_yield
                            - mremap
                            - msync
                            - mincore
                            - madvise
                            - shmget
                            - shmat
                            - shmctl
                            - dup
                            - dup2
                            - pause
                            - nanosleep
                            - getitimer
                            - alarm
                            - setitimer
                            - getpid
                            - sendfile
                            - socket
                            - connect
                            - accept
                            - sendto
                            - recvfrom
                            - sendmsg
                            - recvmsg
                            - shutdown
                            - bind
                            - listen
                            - getsockname
                            - getpeername
                            - socketpair
                            - setsockopt
                            - getsockopt
                            - clone
                            - fork
                            - vfork
                            - execve
                            - exit
                            - wait4
                            - kill
                            - uname
                            - semget
                            - semop
                            - semctl
                            - shmdt
                            - msgget
                            - msgsnd
                            - msgrcv
                            - msgctl
                            - fcntl
                            - flock
                            - fsync
                            - fdatasync
                            - truncate
                            - ftruncate
                            - getdents
                            - getcwd
                            - chdir
                            - fchdir
                            - rename
                            - mkdir
                            - rmdir
                            - creat
                            - link
                            - unlink
                            - symlink
                            - readlink
                            - chmod
                            - fchmod
                            - chown
                            - fchown
                            - lchown
                            - umask
                            - gettimeofday
                            - getrlimit
                            - getrusage
                            - sysinfo
                            - times
                            - ptrace
                            - getuid
                            - syslog
                            - getgid
                            - setuid
                            - setgid
                            - geteuid
                            - getegid
                            - setpgid
                            - getppid
                            - getpgrp
                            - setsid
                            - setreuid
                            - setregid
                            - getgroups
                            - setgroups
                            - setresuid
                            - getresuid
                            - setresgid
                            - getresgid
                            - getpgid
                            - setfsuid
                            - setfsgid
                            - getsid
                            - capget
                            - capset
                            - rt_sigpending
                            - rt_sigtimedwait
                            - rt_sigqueueinfo
                            - rt_sigsuspend
                            - sigaltstack
                            - utime
                            - mknod
                            - uselib
                            - personality
                            - ustat
                            - statfs
                            - fstatfs
                            - sysfs
                            - getpriority
                            - setpriority
                            - sched_setparam
                            - sched_getparam
                            - sched_setscheduler
                            - sched_getscheduler
                            - sched_get_priority_max
                            - sched_get_priority_min
                            - sched_rr_get_interval
                            - mlock
                            - munlock
                            - mlockall
                            - munlockall
                            - vhangup
                            - modify_ldt
                            - pivot_root
                            - _sysctl
                            - prctl
                            - arch_prctl
                            - adjtimex
                            - setrlimit
                            - chroot
                            - sync
                            - acct
                            - settimeofday
                            - mount
                            - umount2
                            - swapon
                            - swapoff
                            - reboot
                            - sethostname
                            - setdomainname
                            - iopl
                            - ioperm
                            - create_module
                            - init_module
                            - delete_module
                            - get_kernel_syms
                            - query_module
                            - quotactl
                            - nfsservctl
                            - getpmsg
                            - putpmsg
                            - afs_syscall
                            - tuxcall
                            - security
                            - gettid
                            - readahead
                            - setxattr
                            - lsetxattr
                            - fsetxattr
                            - getxattr
                            - lgetxattr
                            - fgetxattr
                            - listxattr
                            - llistxattr
                            - flistxattr
                            - removexattr
                            - lremovexattr
                            - fremovexattr
                            - tkill
                            - time
                            - futex
                            - sched_setaffinity
                            - sched_getaffinity
                            - set_thread_area
                            - io_setup
                            - io_destroy
                            - io_getevents
                            - io_submit
                            - io_cancel
                            - get_thread_area
                            - lookup_dcookie
                            - epoll_create
                            - epoll_ctl_old
                            - epoll_wait_old
                            - remap_file_pages
                            - getdents64
                            - set_tid_address
                            - restart_syscall
                            - semtimedop
                            - fadvise64
                            - timer_create
                            - timer_settime
                            - timer_gettime
                            - timer_getoverrun
                            - timer_delete
                            - clock_settime
                            - clock_gettime
                            - clock_getres
                            - clock_nanosleep
                            - exit_group
                            - epoll_wait
                            - epoll_ctl
                            - tgkill
                            - utimes
                            - vserver
                            - mbind
                            - set_mempolicy
                            - get_mempolicy
                            - mq_open
                            - mq_unlink
                            - mq_timedsend
                            - mq_timedreceive
                            - mq_notify
                            - mq_getsetattr
                            - kexec_load
                            - waitid
                            - add_key
                            - request_key
                            - keyctl
                            - ioprio_set
                            - ioprio_get
                            - inotify_init
                            - inotify_add_watch
                            - inotify_rm_watch
                            - migrate_pages
                            - openat
                            - mkdirat
                            - mknodat
                            - fchownat
                            - futimesat
                            - newfstatat
                            - unlinkat
                            - renameat
                            - linkat
                            - symlinkat
                            - readlinkat
                            - fchmodat
                            - faccessat
                            - pselect6
                            - ppoll
                            - unshare
                            - set_robust_list
                            - get_robust_list
                            - splice
                            - tee
                            - sync_file_range
                            - vmsplice
                            - move_pages
                            - utimensat
                            - epoll_pwait
                            - signalfd
                            - timerfd_create
                            - eventfd
                            - fallocate
                            - timerfd_settime
                            - timerfd_gettime
                            - accept4
                            - signalfd4
                            - eventfd2
                            - epoll_create1
                            - dup3
                            - pipe2
                            - inotify_init1
                            - preadv
                            - pwritev
                            - rt_tgsigqueueinfo
                            - perf_event_open
                            - recvmmsg
                            - fanotify_init
                            - fanotify_mark
                            - prlimit64
                            - name_to_handle_at
                            - open_by_handle_at
                            - clock_adjtime
                            - syncfs
                            - sendmmsg
                            - setns
                            - getcpu
                            - process_vm_readv
                            - process_vm_writev
                            - kcmp
                            - finit_module
                            - sched_setattr
                            - sched_getattr
                            - renameat2
                            - seccomp
                            - getrandom
                            - memfd_create
                            - kexec_file_load
                            - bpf
                            - execveat
                            - userfaultfd
                            - membarrier
                            - mlock2
                            - copy_file_range
                            - preadv2
                            - pwritev2
                            - pkey_mprotect
                            - pkey_alloc
                            - pkey_free
                            - statx
                            - io_pgetevents
                            - rseq
                            type: string
                          type: array
                      type: object
                    type: array
                  matchSyscalls:
                    items:
                      properties:
                        fromSource:
                          items:
                            properties:
                              dir:
                                type: string
                              path:
                                pattern: ^\/+.*[^\/]$
                                type: string
                              recursive:
                                type: boolean
                            type: object
                          type: array
                        syscall:
                          items:
                            enum:
                            - read
                            - write
                            - open
                            - close
                            - stat
                            - fstat
                            - lstat
                            - poll
                            - lseek
                            - mmap
                            - mprotect
                            - munmap
                            - brk
                            - rt_sigaction
                            - rt_sigprocmask
                            - rt_sigreturn
                            - ioctl
                            - pread64
                            - pwrite64
                            - readv
                            - writev
                            - access
                            - pipe
                            - select
                            - sched_yield
                            - mremap
                            - msync
                            - mincore
                            - madvise
                            - shmget
                            - shmat
                            - shmctl
                            - dup
                            - dup2
                            - pause
                            - nanosleep
                            - getitimer
                            - alarm
                            - setitimer
                            - getpid
                            - sendfile
                            - socket
                            - connect
                            - accept
                            - sendto
                            - recvfrom
                            - sendmsg
                            - recvmsg
                            - shutdown
                            - bind
                            - listen
                            - getsockname
                            - getpeername
                            - socketpair
                            - setsockopt
                            - getsockopt
                            - clone
                            - fork
                            - vfork
                            - execve
                            - exit
                            - wait4
                            - kill
                            - uname
                            - semget
                            - semop
                            - semctl
                            - shmdt
                            - msgget
                            - msgsnd
                            - msgrcv
                            - msgctl
                            - fcntl
                            - flock
                            - fsync
                            - fdatasync
                            - truncate
                            - ftruncate
                            - getdents
                            - getcwd
                            - chdir
                            - fchdir
                            - rename
                            - mkdir
                            - rmdir
                            - creat
                            - link
                            - unlink
                            - symlink
                            - readlink
                            - chmod
                            - fchmod
                            - chown
                            - fchown
                            - lchown
                            - umask
                            - gettimeofday
                            - getrlimit
                            - getrusage
                            - sysinfo
                            - times
                            - ptrace
                            - getuid
                            - syslog
                            - getgid
                            - setuid
                            - setgid
                            - geteuid
                            - getegid
                            - setpgid
                            - getppid
                            - getpgrp
                            - setsid
                            - setreuid
                            - setregid
                            - getgroups
                            - setgroups
                            - setresuid
                            - getresuid
                            - setresgid
                            - getresgid
                            - getpgid
                            - setfsuid
                            - setfsgid
                            - getsid
                            - capget
                            - capset
                            - rt_sigpending
                            - rt_sigtimedwait
                            - rt_sigqueueinfo
                            - rt_sigsuspend
                            - sigaltstack
                            - utime
                            - mknod
                            - uselib
                            - personality
                            - ustat
                            - statfs
                            - fstatfs
                            - sysfs
                            - getpriority
                            - setpriority
                            - sched_setparam
                            - sched_getparam
                            - sched_setscheduler
                            - sched_getscheduler
                            - sched_get_priority_max
                            - sched_get_priority_min
                            - sched_rr_get_interval
                            - mlock
                            - munlock
                            - mlockall
                            - munlockall
                            - vhangup
                            - modify_ldt
                            - pivot_root
                            - _sysctl
                            - prctl
                            - arch_prctl
                            - adjtimex
                            - setrlimit
                            - chroot
                            - sync
                            - acct
                            - settimeofday
                            - mount
                            - umount2
                            - swapon
                            - swapoff
                            - reboot
                            - sethostname
                            - setdomainname
                            - iopl
                            - ioperm
                            - create_module
                            - init_module
                            - delete_module
                            - get_kernel_syms
                            - query_module
                            - quotactl
                            - nfsservctl
                            - getpmsg
                            - putpmsg
                            - afs_syscall
                            - tuxcall
                            - security
                            - gettid
                            - readahead
                            - setxattr
                            - lsetxattr
                            - fsetxattr
                            - getxattr
                            - lgetxattr
                            - fgetxattr
                            - listxattr
                            - llistxattr
                            - flistxattr
                            - removexattr
                            - lremovexattr
                            - fremovexattr
                            - tkill
                            - time
                            - futex
                            - sched_setaffinity
                            - sched_getaffinity
                            - set_thread_area
                            - io_setup
                            - io_destroy
                            - io_getevents
                            - io_submit
                            - io_cancel
                            - get_thread_area
                            - lookup_dcookie
                            - epoll_create
                            - epoll_ctl_old
                            - epoll_wait_old
                            - remap_file_pages
                            - getdents64
                            - set_tid_address
                            - restart_syscall
                            - semtimedop
                            - fadvise64
                            - timer_create
                            - timer_settime
                            - timer_gettime
                            - timer_getoverrun
                            - timer_delete
                            - clock_settime
                            - clock_gettime
                            - clock_getres
                            - clock_nanosleep
                            - exit_group
                            - epoll_wait
                            - epoll_ctl
                            - tgkill
                            - utimes
                            - vserver
                            - mbind
                            - set_mempolicy
                            - get_mempolicy
                            - mq_open
                            - mq_unlink
                            - mq_timedsend
                            - mq_timedreceive
                            - mq_notify
                            - mq_getsetattr
                            - kexec_load
                            - waitid
                            - add_key
                            - request_key
                            - keyctl
                            - ioprio_set
                            - ioprio_get
                            - inotify_init
                            - inotify_add_watch
                            - inotify_rm_watch
                            - migrate_pages
                            - openat
                            - mkdirat
                            - mknodat
                            - fchownat
                            - futimesat
                            - newfstatat
                            - unlinkat
                            - renameat
                            - linkat
                            - symlinkat
                            - readlinkat
                            - fchmodat
                            - faccessat
                            - pselect6
                            - ppoll
                            - unshare
                            - set_robust_list
                            - get_robust_list
                            - splice
                            - tee
                            - sync_file_range
                            - vmsplice
                            - move_pages
                            - utimensat
                            - epoll_pwait
                            - signalfd
                            - timerfd_create
                            - eventfd
                            - fallocate
                            - timerfd_settime
                            - timerfd_gettime
                            - accept4
                            - signalfd4
                            - eventfd2
                            - epoll_create1
                            - dup3
                            - pipe2
                            - inotify_init1
                            - preadv
                            - pwritev
                            - rt_tgsigqueueinfo
                            - perf_event_open
                            - recvmmsg
                            - fanotify_init
                            - fanotify_mark
                            - prlimit64
                            - name_to_handle_at
                            - open_by_handle_at
                            - clock_adjtime
                            - syncfs
                            - sendmmsg
                            - setns
                            - getcpu
                            - process_vm_readv
                            - process_vm_writev
                            - kcmp
                            - finit_module
                            - sched_setattr
                            - sched_getattr
                            - renameat2
                            - seccomp
                            - getrandom
                            - memfd_create
                            - kexec_file_load
                            - bpf
                            - execveat
                            - userfaultfd
                            - membarrier
                            - mlock2
                            - copy_file_range
                            - preadv2
                            - pwritev2
                            - pkey_mprotect
                            - pkey_alloc
                            - pkey_free
                            - statx
                            - io_pgetevents
                            - rseq
                            type: string
                          type: array
                      type: object
                    type: array
                  message:
                    type: string
                  severity:
                    maximum: 10
                    minimum: 1
                    type: integer
                  tags:
                    items:
                      type: string
                    type: array
                type: object
              tags:
                items:
                  type: string
                type: array
            type: object
          status:
            description: KubeArmorPolicyStatus defines the observed state of KubeArmorPolicy
            properties:
              status:
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
# Source: kubearmor/templates/RBAC/roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: kubearmor-clusterrole
rules:
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
  - list
  - watch
  - update
- apiGroups:
  - ""
  resources:
  - pods
  - nodes
  - configmaps
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - apps
  resources:
  - deployments
  - replicasets
  - daemonsets
  - statefulsets
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - batch
  resources:
  - jobs
  - cronjobs
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - security.kubearmor.com
  resources:
  - kubearmorpolicies
  - kubearmorclusterpolicies
  - kubearmorhostpolicies
  verbs:
  - get
  - list
  - watch
  - update
  - delete
- nonResourceURLs:
  - /apis
  - /apis/*
  verbs:
  - get
---
# Source: kubearmor/templates/RBAC/roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: kubearmor-relay-clusterrole
rules:
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - get
  - list
---
# Source: kubearmor/templates/RBAC/roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: kubearmor-controller-clusterrole
rules:
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - create
  - delete
  - get
  - patch
  - list
  - watch
  - update
- apiGroups:
  - ""
  resources:
  - nodes
  verbs:
  - get
  - list
  - watch   
- apiGroups:
  - security.kubearmor.com
  resources:
  - kubearmorpolicies
  - kubearmorclusterpolicies
  - kubearmorhostpolicies
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - security.kubearmor.com
  resources:
  - kubearmorpolicies/status
  - kubearmorclusterpolicies/status
  - kubearmorhostpolicies/status
  verbs:
  - get
  - patch
  - update
---
# Source: kubearmor/templates/RBAC/roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: kubearmor-controller-proxy-role
rules:
- apiGroups:
  - authentication.k8s.io
  resources:
  - tokenreviews
  verbs:
  - create
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
---
# Source: kubearmor/templates/RBAC/roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: kubearmor-controller-metrics-reader-role
rules:
- nonResourceURLs:
  - /metrics
  verbs:
  - get
---
# Source: kubearmor/templates/RBAC/bindings.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: kubearmor-clusterrolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: kubearmor-clusterrole
subjects:
- kind: ServiceAccount
  name: kubearmor
  namespace: default
---
# Source: kubearmor/templates/RBAC/bindings.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: kubearmor-relay-clusterrolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: kubearmor-relay-clusterrole
subjects:
- kind: ServiceAccount
  name: kubearmor-relay
  namespace: default
---
# Source: kubearmor/templates/RBAC/bindings.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: kubearmor-controller-clusterrolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: kubearmor-controller-clusterrole
subjects:
- kind: ServiceAccount
  name: kubearmor-controller
  namespace: default
---
# Source: kubearmor/templates/RBAC/bindings.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: kubearmor-controller-proxy-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: kubearmor-controller-proxy-role
subjects:
- kind: ServiceAccount
  name: kubearmor-controller
  namespace: default
---
# Source: kubearmor/templates/RBAC/bindings.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: kubearmor-controller-metrics-reader-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: kubearmor-controller-metrics-reader-role
subjects:
- kind: ServiceAccount
  name: kubearmor-controller
  namespace: default
---
# Source: kubearmor/templates/RBAC/roles.yaml
# kubearmor controller needs this for leader election in kube-system
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: kubearmor-controller-leader-election-role
  namespace: default
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - patch
---
# Source: kubearmor/templates/RBAC/bindings.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: kubearmor-controller-leader-election-rolebinding
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: kubearmor-controller-leader-election-role
subjects:
- kind: ServiceAccount
  name: kubearmor-controller
  namespace: default
---
# Source: kubearmor/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: kubearmor
  namespace: default
  labels:
    kubearmor-app: kubearmor-relay
spec:
  ports:
  - port: 32767
    protocol: TCP
    targetPort: 32767
  selector:
    kubearmor-app: kubearmor-relay
---
# Source: kubearmor/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    kubearmor-app: kubearmor-controller
  name: kubearmor-controller-metrics-service
  namespace: default
spec:
  ports:
  - name: https
    port: 8443
    protocol: TCP
    targetPort: https
  selector:
    kubearmor-app: kubearmor-controller
---
# Source: kubearmor/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: kubearmor-controller-webhook-service
  namespace: default
spec:
  ports:
  - port: 443
    protocol: TCP
    targetPort: 9443
  selector:
    kubearmor-app: kubearmor-controller
---
# Source: kubearmor/templates/daemonset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  labels:
    kubearmor-app: kubearmor
  name: kubearmor
  namespace: default
spec:
  selector:
    matchLabels:
      kubearmor-app: kubearmor
  template:
    metadata:
      annotations:
        container.apparmor.security.beta.kubernetes.io/kubearmor: unconfined
      labels:
        kubearmor-app: kubearmor
    spec:
      containers:
      - args:
        - -gRPC=32767
        - -tlsEnabled=false
        - -tlsCertPath=/var/lib/kubearmor/tls
        - -tlsCertProvider=self
        image: kubearmor/kubearmor:stable
        imagePullPolicy: Always
        env:
        - name: KUBEARMOR_NODENAME
          valueFrom:
            fieldRef:
              fieldPath: spec.nodeName
        - name: KUBEARMOR_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        livenessProbe:
          exec:
            command:
            - /bin/bash
            - -c
            - if [ -z $(pgrep kubearmor) ]; then exit 1; fi;
          initialDelaySeconds: 60
          periodSeconds: 10
        name: kubearmor
        ports:
        - containerPort: 32767
        securityContext:
          capabilities:
            add:
            - SETUID
            - SETGID
            - SETPCAP
            - SYS_ADMIN
            - SYS_PTRACE
            - MAC_ADMIN
            - SYS_RESOURCE
            - IPC_LOCK
            - CAP_DAC_OVERRIDE
            - CAP_DAC_READ_SEARCH
            drop:
            - ALL
          privileged: false
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
          - mountPath: /opt/kubearmor/BPF
            name: bpf # generic
          - mountPath: /usr/src
            name: usr-src-path
            readOnly: true
          - mountPath: /lib/modules
            name: lib-modules-path
            readOnly: true
          - mountPath: /sys/kernel/security
            name: sys-kernel-security-path
          - mountPath: /sys/kernel/debug
            name: sys-kernel-debug-path
          - mountPath: /media/root/etc/os-release
            name: os-release-path
            readOnly: true
          - mountPath: /etc/apparmor.d
            name: etc-apparmor-d-path
          - mountPath: /var/run/containerd/containerd.sock
            name: containerd-sock-path
            readOnly: true

      dnsPolicy: ClusterFirstWithHostNet
      hostNetwork: true
      hostPID: true
      initContainers:
      - image: kubearmor/kubearmor-init:stable
        imagePullPolicy: Always
        name: init
        securityContext:
          capabilities:
            add:
            - SETUID
            - SETGID
            - SETPCAP
            - SYS_ADMIN
            - SYS_PTRACE
            - MAC_ADMIN
            - SYS_RESOURCE
            - IPC_LOCK
            - CAP_DAC_OVERRIDE
            - CAP_DAC_READ_SEARCH
            drop:
            - ALL
          privileged: false
        volumeMounts:
          - mountPath: /opt/kubearmor/BPF
            name: bpf
          - mountPath: /lib/modules
            name: lib-modules-path
            readOnly: true
          - mountPath: /sys/kernel/security
            name: sys-kernel-security-path
          - mountPath: /sys/kernel/debug
            name: sys-kernel-debug-path
          - mountPath: /media/root/etc/os-release
            name: os-release-path
            readOnly: true
          - mountPath: /usr/src
            name: usr-src-path
            readOnly: true
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: Always
      serviceAccountName: kubearmor
      terminationGracePeriodSeconds: 30
      tolerations:
      - operator: Exists
      volumes:
        - emptyDir: {}
          name: bpf # generic
        - hostPath:
            path: /usr/src
            type: Directory
          name: usr-src-path
        - hostPath:
            path: /lib/modules
            type: DirectoryOrCreate
          name: lib-modules-path
        - hostPath:
            path: /sys/kernel/security
            type: Directory
          name: sys-kernel-security-path
        - hostPath:
            path: /sys/kernel/debug
            type: Directory
          name: sys-kernel-debug-path
        - hostPath:
            path: /etc/os-release
            type: File
          name: os-release-path
        - hostPath:
            path: /etc/apparmor.d
            type: DirectoryOrCreate
          name: etc-apparmor-d-path
        - hostPath:
            path: /var/run/containerd/containerd.sock
            type: Socket
          name: containerd-sock-path
---
# Source: kubearmor/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    kubearmor-app: kubearmor-relay
  name: kubearmor-relay
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      kubearmor-app: kubearmor-relay
  template:
    metadata:
      annotations:
        kubearmor-policy: audited
      labels:
        kubearmor-app: kubearmor-relay
    spec:
      containers:
      - args:
        - -tlsEnabled=false
        - -tlsCertPath=/var/lib/kubearmor/tls
        - -tlsCertProvider=external
        image: kubearmor/kubearmor-relay-server:latest
        imagePullPolicy: Always
        name: kubearmor-relay-server
        env:
        - name: ENABLE_STDOUT_LOGS
          value: "false"
        - name: ENABLE_STDOUT_ALERTS
          value: "false"
        - name: ENABLE_STDOUT_MSGS
          value: "false"
        ports:
        - containerPort: 32767
      nodeSelector:
        kubernetes.io/os: linux
      serviceAccountName: kubearmor-relay
---
# Source: kubearmor/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    kubearmor-app: kubearmor-controller
  name: kubearmor-controller
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      kubearmor-app: kubearmor-controller
  template:
    metadata:
      annotations:
        container.apparmor.security.beta.kubernetes.io/kube-rbac-proxy: unconfined
        container.apparmor.security.beta.kubernetes.io/manager: unconfined
        kubectl.kubernetes.io/default-container: manager
        kubearmor-policy: audited
      labels:
        kubearmor-app: kubearmor-controller
    spec:
      containers:
      - args:
        - --health-probe-bind-address=:8081
        - --metrics-bind-address=127.0.0.1:8080
        - --leader-elect
        command:
        - /manager
        image: kubearmor/kubearmor-controller:latest
        imagePullPolicy: Always
        livenessProbe:
          httpGet:
            path: /healthz
            port: 8081
          initialDelaySeconds: 15
          periodSeconds: 20
        name: manager
        ports:
        - containerPort: 9443
          name: webhook-server
          protocol: TCP
        readinessProbe:
          httpGet:
            path: /readyz
            port: 8081
          initialDelaySeconds: 5
          periodSeconds: 10
        resources:
          requests:
            cpu: 10m
            memory: 64Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        volumeMounts:
        - mountPath: /tmp/k8s-webhook-server/serving-certs
          name: cert
          readOnly: true
        - mountPath: /sys/kernel/security
          name: sys-path
      - args:
        - --secure-listen-address=0.0.0.0:8443
        - --upstream=http://127.0.0.1:8080/
        - --logtostderr=true
        - --v=0
        image: gcr.io/kubebuilder/kube-rbac-proxy:v0.15.0
        name: kube-rbac-proxy
        ports:
        - containerPort: 8443
          name: https
          protocol: TCP
        resources:
          limits:
            cpu: 500m
            memory: 128Mi
          requests:
            cpu: 5m
            memory: 64Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
      securityContext:
        runAsNonRoot: true
      serviceAccountName: kubearmor-controller
      terminationGracePeriodSeconds: 10
      volumes:
      - name: cert
        secret:
          defaultMode: 420
          secretName: kubearmor-controller-webhook-server-cert
      - hostPath:
          path: /sys/kernel/security
          type: Directory
        name: sys-path
---
# Source: kubearmor/templates/kubearmor-tls-secrets.yaml
# kubearmor-ca secret
---
# Source: kubearmor/templates/kubearmor-tls-secrets.yaml
---
---
# Source: kubearmor/templates/secrets.yaml
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: kubearmor-controller-mutating-webhook-configuration
  namespace: default
webhooks:
- admissionReviewVersions:
  - v1
  clientConfig:
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLakNDQWhLZ0F3SUJBZ0lSQU5nbnZsYVRSMVV1NjNxWGllcWdCZFF3RFFZSktvWklodmNOQVFFTEJRQXcKSHpFZE1Cc0dBMVVFQXhNVWEzVmlaV0Z5Ylc5eUxXTnZiblJ5YjJ4c1pYSXdIaGNOTWpRd09URTJNRGt6TWpNNQpXaGNOTWpjd09URTJNRGt6TWpNNVdqQWZNUjB3R3dZRFZRUURFeFJyZFdKbFlYSnRiM0l0WTI5dWRISnZiR3hsCmNqQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUtoNHUyQ3FtUVdobE9lb2hVd1gKaUNCK0lSZ2s4ZGFrY1k0bmRYNTU5ZTc1bnFBTFR3aG4za1YzWkl5MENuRVBKdGdTNzVaSFdMZ2ZXQm12UDhLMgorZGRDb0k2cW9HRzBGWDVIM1pKdGs4TkxCM0k2UjNmQU1FSU9pWVNZNUFJV0VJbTJXVGl6T3U1YUtTVER3Vy9jCnI2SFpJS0xxMmtvdnBzell3Nmh5MVdsQ280RHhtUUxXTm1DRzNYY25IU2hCZWdXK1F0NFNERllmNWMyL2dqR0sKRHllT0xGWnBuNnRTUElXR1FrOXk2a29LMy9OdVJKYmNFYWhqNm5LQUlmdHZRK1FaT2V6MXQ2eS9NMWVWYmVOcwplZUJwTjFkMGpQMFNJMUJmK0dQU3E3ZG1JMjNZL3A2UnlGK2JlaUVta3hkTFBWdUpXUjVuSGFoT1B4QkFwTThUCktIMENBd0VBQWFOaE1GOHdEZ1lEVlIwUEFRSC9CQVFEQWdLa01CMEdBMVVkSlFRV01CUUdDQ3NHQVFVRkJ3TUIKQmdnckJnRUZCUWNEQWpBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUIwR0ExVWREZ1FXQkJTb0Vhc0o0Y0JwMDZsbwpVRDZuanhOT3pjdFp0ekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBS29oUDFmNUxsVDhteHZ6Z1Nxa2NzUG0wCnR3V2RFMVlWd0tSU3RlUW4rSHpESDMyRzc3Sko3MlJHMDZLWUdiaW05NHFDeXNwcmN2Y045bTgzVENIZjl3NnIKUVkwemF0cnVxc2czNGh1cTZBNTBvWlZUS1REK0lub2U4VS9LQkFNZ2M2cFBtZEtYM1EwTUNsSEU5WHVjajdTTApteXpqb0ZqSDRqYXhuS05iMUZhNmlFYkhGZThtRU96QU1yRzh2T2dKTUtsVkxMREQrUURMT1RnV3NrbjZTQlBZCm9lUlgxVlM1WG5kU0ZRSWhtTGF6TVcrU1FKU1hIaWRtOGl1bnlpK2dDaVZZbU9oMkdvamgvLzNsbE1SS3ZwbC8KaDhueFZmK25VSG42Z1pueE96VmlHa3BPbnNSRnloK0dYb1g2bjBQcjMwREJrTDBHdVBCeDJVVzlUdXlHNEE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    service:
      name: kubearmor-controller-webhook-service
      namespace: default
      path: /mutate-pods
  failurePolicy: Ignore
  name: annotation.kubearmor.com
  objectSelector:
    matchExpressions:
    - key: kubearmor-app
      operator: DoesNotExist
  rules:
  - apiGroups:
    - ""
    apiVersions:
    - v1
    operations:
    - CREATE
    - UPDATE
    resources:
    - pods
    scope: '*'
  sideEffects: NoneOnDryRun
