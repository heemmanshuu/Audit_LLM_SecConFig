---
# Source: cubefs/templates/priorityclass.yaml
apiVersion: scheduling.k8s.io/v1
kind: PriorityClass
metadata:
  name: cubefs-high-priority
value: 1000000
globalDefault: false
description: "This priority class should be used for Cubefs core service pods only."
---
# Source: cubefs/templates/csi-rbac.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: cfs-csi-service-account
---
# Source: cubefs/templates/configmap-bin.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: cubefs-bin
data:
  config-master.sh: |+
    #!/bin/bash
    
    # set -ex
    # source init_dirs.sh
    echo "prepare to create configuration file"
    CBFS_HOSTNAME_INDEX=""
    CBFS_ID=""
    CBFS_HOSTNAME_INDEX=`echo $POD_NAME | awk -F '-' '{print $2}'`
    CBFS_ID=$(($CBFS_HOSTNAME_INDEX+1))
    
    jq -n \
      --arg clusterName "$CBFS_MASTER_CLUSTER" \
      --arg id $CBFS_ID \
      --arg ip "$POD_IP" \
      --arg port "$CBFS_MASTER_PORT" \
      --arg prof "$CBFS_MASTER_PROF" \
      --arg peers "$CBFS_MASTER_PEERS" \
      --arg retainLogs "$CBFS_MASTER_RETAIN_LOGS" \
      --arg exporterPort "$CBFS_MASTER_EXPORTER_PORT" \
      --arg logLevel "$CBFS_MASTER_LOG_LEVEL" \
      --arg consulAddr "$CBFS_CONSUL_ADDR" \
      --arg metaNodeReservedMem "$CBFS_METANODE_RESERVED_MEM" \
      '{
        "role": "master",
        "ip": $ip,
        "listen": $port,
        "prof": $prof,
        "id": $id,
        "peers": $peers,
        "retainLogs": $retainLogs,
        "logDir": "/cfs/logs",
        "logLevel": $logLevel,
        "walDir": "/cfs/data/master/raft",
        "storeDir": "/cfs/data/master/rocksdbstore",
        "consulAddr": $consulAddr,
        "exporterPort": $exporterPort,
        "clusterName": $clusterName,
        "metaNodeReservedMem": $metaNodeReservedMem 
    }' > /cfs/conf/master.json
    
    cat /cfs/conf/master.json
    echo "configuration finished"
    
  start-master.sh: |+
    #!/bin/bash
    # set -ex
    
    mkdir -p /cfs/data/master/raft
    mkdir -p /cfs/data/master/rocksdbstore
    
    cat /cfs/conf/master.json
    echo "start master"
    exec /cfs/bin/cfs-server -f  -c /cfs/conf/master.json
  check-master-service.sh: |+
    #!/bin/bash
    
    # set -ex
    GET_CLUSTER_URL="http://$CBFS_MASTER_SERVICE_PORT/admin/getCluster"
    code=1
    while ((code!=0))
    do
      clusterInfo=`curl -s "$GET_CLUSTER_URL" || echo ""`
      if [ "X"$clusterInfo == "X" ]; then
        code=1
        echo "waiting master service"
        sleep 2s
      else
        echo $clusterInfo | jq "."
        code=$( echo "$clusterInfo" | jq ".code" )
      fi
    done
    echo "master service is ok"
    
  config-datanode.sh: |+
    #!/bin/bash
    
    # set -ex
    # source init_dirs.sh
    echo "prepare to create configuration file"
    jq -n \
      --arg port "$CBFS_DATANODE_PORT" \
      --arg prof "$CBFS_DATANODE_PROF" \
      --arg localIP "$CBFS_DATANODE_LOCALIP" \
      --arg logLevel "$CBFS_DATANODE_LOG_LEVEL" \
      --arg raftHeartbeat "$CBFS_DATANODE_RAFT_HEARTBEAT_PORT" \
      --arg raftReplica "$CBFS_DATANODE_RAFT_REPLICA_PORT" \
      --arg masterAddr "$CBFS_MASTER_ADDRS" \
      --arg exporterPort "$CBFS_DATANODE_EXPORTER_PORT" \
      --arg consulAddr "$CBFS_CONSUL_ADDR" \
      --arg disks "$CBFS_DATANODE_DISKS" \
      '{
        "role": "datanode",
        "listen": $port,
        "localIP": $localIP,
        "prof": $prof,
        "logDir": "/cfs/logs",
        "logLevel": $logLevel,
        "raftHeartbeat": $raftHeartbeat,
        "raftReplica": $raftReplica,
        "raftDir": "/cfs/data/datanode/raft",
        "consulAddr": $consulAddr,
        "exporterPort": $exporterPort,
        "masterAddr": $masterAddr,
        "disks": $disks
    }' | jq '.masterAddr |= split(",")' | jq '.disks |= split(",")' > /cfs/conf/datanode.json
    
    # merge the override config
    jq -s ".[0] + .[1].\"$CBFS_DATANODE_LOCALIP\"" /cfs/conf/datanode.json /cfs/conf-override/datanode.json > tmp.json
    mv tmp.json /cfs/conf/datanode.json
    
    cat /cfs/conf/datanode.json
    echo "configuration finished"
    
    
    
  start-datanode.sh: |+
    #!/bin/bash
    # set -ex
    
    mkdir -p /cfs/data/datanode/raft
    cat /cfs/conf/datanode.json
    echo "start master"
    exec /cfs/bin/cfs-server -f  -c /cfs/conf/datanode.json
    
  config-metanode.sh: |+
    #!/bin/bash
    
    # set -ex
    # source init_dirs.sh
    echo "prepare to create configuration file"
    
    jq -n \
      --arg port "$CBFS_METANODE_PORT" \
      --arg prof "$CBFS_METANODE_PROF" \
      --arg localIP "$CBFS_METANODE_LOCALIP" \
      --arg logLevel "$CBFS_METANODE_LOG_LEVEL" \
      --arg raftHeartbeatPort "$CBFS_METANODE_RAFT_HEARTBEAT_PORT" \
      --arg raftReplicaPort "$CBFS_METANODE_RAFT_REPLICA_PORT" \
      --arg exporterPort "$CBFS_METANODE_EXPORTER_PORT" \
      --arg masterAddrs "$CBFS_MASTER_ADDRS" \
      --arg totalMem "$CBFS_MASTER_TOTAL_MEM" \
      --arg consulAddr "$CBFS_CONSUL_ADDR" \
        '{
         "role": "metanode",
         "listen": $port,
         "prof": $prof,
         "localIP": $localIP,
         "logLevel": $logLevel,
         "metadataDir": "/cfs/data/metanode/meta",
         "logDir": "/cfs/logs",
         "raftDir": "/cfs/data/metanode/raft",
         "raftHeartbeatPort": $raftHeartbeatPort,
         "raftReplicaPort": $raftReplicaPort,
         "consulAddr": $consulAddr,
         "exporterPort": $exporterPort,
         "totalMem": $totalMem,
         "masterAddr": $masterAddrs
     }' | jq '.masterAddr |= split(",")' > /cfs/conf/metanode.json
    
    # merge the override config
    jq -s ".[0] + .[1].\"$CBFS_METANODE_LOCALIP\"" /cfs/conf/metanode.json /cfs/conf-override/metanode.json > tmp.json
    mv tmp.json /cfs/conf/metanode.json
    
    cat /cfs/conf/metanode.json
    echo "configuration finished"
    
    
    
    
  start-metanode.sh: |+
    #!/bin/bash
    # set -ex
    
    mkdir -p /cfs/data/metanode/raft
    
    cat /cfs/conf/metanode.json
    echo "start master"
    exec /cfs/bin/cfs-server -f  -c /cfs/conf/metanode.json
  config-client.sh: |+
    #!/bin/bash
    
    # set -ex
    export LC_ALL=C
    
    echo "before prepare config..."
    
    jq -n \
      --arg volName "$CBFS_CLIENT_VOL_NAME" \
      --arg owner "$CBFS_CLIENT_OWNER" \
      --arg logLevel "$CBFS_CLIENT_LOG_LEVEL" \
      --arg masterAddr "$CBFS_MASTER_ADDRS" \
      --arg exporterPort "$CBFS_CLIENT_EXPORTER_PORT" \
      --arg prof "$CBFS_CLIENT_PROF" \
      --arg consulAddr "$CBFS_CONSUL_ADDR" \
      '{
      "mountPoint": "/cfs/mnt",
      "volName": $volName,
      "owner": $owner,
      "masterAddr": $masterAddr,
      "logDir": "/cfs/logs",
      "logLevel": $logLevel,
      "consulAddr": $consulAddr,
      "exporterPort": $exporterPort,
      "profPort": $prof
    }' > /cfs/conf/fuse.json
    
    cat /cfs/conf/fuse.json
    echo "after prepare config"
    
    
  check-volumn.sh: |+
    #!/bin/bash
    
    # set -ex
    GET_CLUSTER_URL="http://$CBFS_MASTER_SERVICE_PORT/admin/getCluster"
    CREATE_VOL_URL="http://$CBFS_MASTER_SERVICE_PORT/admin/createVol?name=$CBFS_CLIENT_VOL_NAME&capacity=20&owner=$CBFS_CLIENT_OWNER&mpCount=3"
    SERVICE_NOT_UNAVAILABLE=99999
    
    function err_exit {
      echo "unknown exception"
      exit 1
    }
    
    function check_status() {
        node="$1"
        up=0
        echo -n "check $node "
        for i in $(seq 1 200) ; do
            clusterInfo=$(curl -s "$GET_CLUSTER_URL")
            NodeTotoalGB=$( echo "$clusterInfo" | jq ".data.${node}StatInfo.TotalGB" )
            if [[ $NodeTotoalGB -gt 0 ]]  ; then
                up=1
                break
            fi
            echo -n "."
            sleep 2
        done
        if [ $up -eq 0 ] ; then
            echo -n "timeout, exit"
            curl "$GET_CLUSTER_URL" | jq
            exit 2
        fi
        echo "ok"
    }
    
    function create_vol {
    #  curl -v "http://10.196.30.231:8080/admin/createVol?name=test&capacity=10&owner=cfs&mpCount=3"
    # {"code":1,"msg":"action[createVol], clusterID[test] name:test, err:action[doCreateVol], clusterID[test] name:test, err:duplicate vol  ","data":null}
    # {"code":0,"msg":"success","data":"create vol[test] successfully, has allocate [10] data partitions"}
      create_result=$(curl $CREATE_VOL_URL)
      test -z $create_result && echo SERVICE_NOT_UNAVAILABLE || echo $create_result | jq .code
    }
    
    function start_check {
      check_status "MetaNode"
      check_status "DataNode"
    
      create_status=$(create_vol)
      if [[ "X"$create_status == "X"0 || "X"$create_status == "X"1 ]];then
        echo "Success"
      else
        err_exit
      fi
    }
    
    start_check
    
    
    
    
    
    
    
    
    
  start-client.sh: |+
    #!/bin/bash
    
    # set -ex
    
    mkdir -p /cfs/mnt
    
    cat /cfs/conf/fuse.json
    echo "start client"
    /cfs/bin/cfs-client -f -c /cfs/conf/fuse.json
  config-objectnode.sh: |+
    #!/bin/bash
    
    # set -ex
    # source init_dirs.sh
    echo "prepare to create configuration file"
    
    jq -n \
      --arg port "$CBFS_OBJECTNODE_PORT" \
      --arg prof "$CBFS_OBJECTNODE_PROF" \
      --arg logLevel "$CBFS_OBJECTNODE_LOG_LEVEL" \
      --arg exporterPort "$CBFS_OBJECTNODE_EXPORTER_PORT" \
      --arg masterAddrs "$CBFS_MASTER_ADDRS" \
      --arg domains "$CBFS_OBJECTNODE_DOMAINS" \
      --arg region "$CBFS_OBJECTNODE_REGION" \
        '{
         "role": "objectnode",
         "listen": $port,
         "prof": $prof,
         "logLevel": $logLevel,
         "logDir": "/cfs/logs",
         "exporterPort": $exporterPort,
         "domains": $domains,
         "region": $region,
         "masterAddr": $masterAddrs
     }' | jq '.masterAddr |= split(",")' | jq '.domains |= split(",")' > /cfs/conf/objectnode.json
    
    cat /cfs/conf/objectnode.json
    echo "configuration finished"
    
    
    
    
  start-objectnode.sh: |+
    #!/bin/bash
    # set -ex
    
    cat /cfs/conf/objectnode.json
    echo "start objectnode"
    exec /cfs/bin/cfs-server -f  -c /cfs/conf/objectnode.json
---
# Source: cubefs/templates/configmap-csi.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: csi-kube-config
data:
  config: |+
---
# Source: cubefs/templates/configmap-monitor.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: monitor-config
data:
  grafana.ini: |+
    ##################### Grafana Configuration Defaults #####################
    #
    # Do not modify this file in grafana installs
    #
    
    # possible values : production, development
    app_mode = production
    
    # instance name, defaults to HOSTNAME environment variable value or hostname if HOSTNAME var is empty
    instance_name = ${HOSTNAME}
    
    #################################### Paths ###############################
    [paths]
    # Path to where grafana can store temp files, sessions, and the sqlite3 db (if that is used)
    data = data
    
    # Temporary files in `data` directory older than given duration will be removed
    temp_data_lifetime = 24h
    
    # Directory where grafana can store logs
    logs = data/log
    
    # Directory where grafana will automatically scan and look for plugins
    plugins = data/plugins
    
    # folder that contains provisioning config files that grafana will apply on startup and while running.
    provisioning = conf/provisioning
    
    #################################### Server ##############################
    [server]
    # Protocol (http, https, socket)
    protocol = http
    
    # The ip address to bind to, empty will bind to all interfaces
    http_addr =
    
    # The http port  to use
    http_port = 3000
    
    # The public facing domain name used to access grafana from a browser
    domain = localhost
    
    # Redirect to correct domain if host header does not match domain
    # Prevents DNS rebinding attacks
    enforce_domain = false
    
    # The full public facing url
    root_url = %(protocol)s://%(domain)s:%(http_port)s/
    
    # Log web requests
    router_logging = false
    
    # the path relative working path
    static_root_path = public
    
    # enable gzip
    enable_gzip = false
    
    # https certs & key file
    cert_file =
    cert_key =
    
    # Unix socket path
    socket = /tmp/grafana.sock
    
    #################################### Database ############################
    [database]
    # You can configure the database connection by specifying type, host, name, user and password
    # as separate properties or as on string using the url property.
    
    # Either "mysql", "postgres" or "sqlite3", it's your choice
    type = sqlite3
    host = 127.0.0.1:3306
    name = grafana
    user = root
    # If the password contains # or ; you have to wrap it with triple quotes. Ex """#password;"""
    password =
    # Use either URL or the previous fields to configure the database
    # Example: mysql://user:secret@host:port/database
    url =
    
    # Max idle conn setting default is 2
    max_idle_conn = 2
    
    # Max conn setting default is 0 (mean not set)
    max_open_conn =
    
    # Connection Max Lifetime default is 14400 (means 14400 seconds or 4 hours)
    conn_max_lifetime = 14400
    
    # Set to true to log the sql calls and execution times.
    log_queries =
    
    # For "postgres", use either "disable", "require" or "verify-full"
    # For "mysql", use either "true", "false", or "skip-verify".
    ssl_mode = disable
    
    ca_cert_path =
    client_key_path =
    client_cert_path =
    server_cert_name =
    
    # For "sqlite3" only, path relative to data_path setting
    path = grafana.db
    
    #################################### Session #############################
    [session]
    # Either "memory", "file", "redis", "mysql", "postgres", "memcache", default is "file"
    provider = file
    
    # Provider config options
    # memory: not have any config yet
    # file: session dir path, is relative to grafana data_path
    # redis: config like redis server e.g. `addr=127.0.0.1:6379,pool_size=100,db=grafana`
    # postgres: user=a password=b host=localhost port=5432 dbname=c sslmode=disable
    # mysql: go-sql-driver/mysql dsn config string, examples:
    #         `user:password@tcp(127.0.0.1:3306)/database_name`
    #         `user:password@unix(/var/run/mysqld/mysqld.sock)/database_name`
    # memcache: 127.0.0.1:11211
    
    
    provider_config = sessions
    
    # Session cookie name
    cookie_name = grafana_sess
    
    # If you use session in https only, default is false
    cookie_secure = false
    
    # Session life time, default is 86400
    session_life_time = 86400
    gc_interval_time = 86400
    
    # Connection Max Lifetime default is 14400 (means 14400 seconds or 4 hours)
    conn_max_lifetime = 14400
    
    #################################### Data proxy ###########################
    [dataproxy]
    
    # This enables data proxy logging, default is false
    logging = false
    
    #################################### Analytics ###########################
    [analytics]
    # Server reporting, sends usage counters to stats.grafana.org every 24 hours.
    # No ip addresses are being tracked, only simple counters to track
    # running instances, dashboard and error counts. It is very helpful to us.
    # Change this option to false to disable reporting.
    reporting_enabled = true
    
    # Set to false to disable all checks to https://grafana.com
    # for new versions (grafana itself and plugins), check is used
    # in some UI views to notify that grafana or plugin update exists
    # This option does not cause any auto updates, nor send any information
    # only a GET request to https://grafana.com to get latest versions
    check_for_updates = true
    
    # Google Analytics universal tracking code, only enabled if you specify an id here
    google_analytics_ua_id =
    
    # Google Tag Manager ID, only enabled if you specify an id here
    google_tag_manager_id =
    
    #################################### Security ############################
    [security]
    # default admin user, created on startup
    admin_user = admin
    
    # default admin password, can be changed before first start of grafana,  or in profile settings
    admin_password = admin
    
    # used for signing
    secret_key = SW2YcwTIb9zpOOhoPsMm
    
    # Auto-login remember days
    login_remember_days = 7
    cookie_username = grafana_user
    cookie_remember_name = grafana_remember
    
    # disable gravatar profile images
    disable_gravatar = false
    
    # data source proxy whitelist (ip_or_domain:port separated by spaces)
    data_source_proxy_whitelist =
    
    # disable protection against brute force login attempts
    disable_brute_force_login_protection = false
    
    #################################### Snapshots ###########################
    [snapshots]
    # snapshot sharing options
    external_enabled = true
    external_snapshot_url = https://snapshots-origin.raintank.io
    external_snapshot_name = Publish to snapshot.raintank.io
    
    # remove expired snapshot
    snapshot_remove_expired = true
    
    #################################### Dashboards ##################
    
    [dashboards]
    # Number dashboard versions to keep (per dashboard). Default: 20, Minimum: 1
    versions_to_keep = 20
    
    #################################### Users ###############################
    [users]
    # disable user signup / registration
    allow_sign_up = false
    
    # Allow non admin users to create organizations
    allow_org_create = false
    
    # Set to true to automatically assign new users to the default organization (id 1)
    auto_assign_org = true
    
    # Set this value to automatically add new users to the provided organization (if auto_assign_org above is set to true)
    auto_assign_org_id = 1
    
    # Default role new users will be automatically assigned (if auto_assign_org above is set to true)
    auto_assign_org_role = Viewer
    
    # Require email validation before sign up completes
    verify_email_enabled = false
    
    # Background text for the user field on the login page
    login_hint = email or username
    
    # Default UI theme ("dark" or "light")
    default_theme = dark
    
    # External user management
    external_manage_link_url =
    external_manage_link_name =
    external_manage_info =
    
    # Viewers can edit/inspect dashboard settings in the browser. But not save the dashboard.
    viewers_can_edit = false
    
    [auth]
    # Set to true to disable (hide) the login form, useful if you use OAuth
    disable_login_form = false
    
    # Set to true to disable the signout link in the side menu. useful if you use auth.proxy
    disable_signout_menu = false
    
    # URL to redirect the user to after sign out
    signout_redirect_url =
    
    #################################### Anonymous Auth ######################
    [auth.anonymous]
    # enable anonymous access
    enabled = true
    
    # specify organization name that should be used for unauthenticated users
    org_name = Main Org.
    
    # specify role for unauthenticated users
    org_role = Viewer
    
    #################################### Github Auth #########################
    [auth.github]
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = user:email,read:org
    auth_url = https://github.com/login/oauth/authorize
    token_url = https://github.com/login/oauth/access_token
    api_url = https://api.github.com/user
    team_ids =
    allowed_organizations =
    
    #################################### GitLab Auth #########################
    [auth.gitlab]
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = api
    auth_url = https://gitlab.com/oauth/authorize
    token_url = https://gitlab.com/oauth/token
    api_url = https://gitlab.com/api/v4
    allowed_groups =
    
    #################################### Google Auth #########################
    [auth.google]
    enabled = false
    allow_sign_up = true
    client_id = some_client_id
    client_secret = some_client_secret
    scopes = https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email
    auth_url = https://accounts.google.com/o/oauth2/auth
    token_url = https://accounts.google.com/o/oauth2/token
    api_url = https://www.googleapis.com/oauth2/v1/userinfo
    allowed_domains =
    hosted_domain =
    
    #################################### Grafana.com Auth ####################
    # legacy key names (so they work in env variables)
    [auth.grafananet]
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = user:email
    allowed_organizations =
    
    [auth.grafana_com]
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = user:email
    allowed_organizations =
    
    #################################### Generic OAuth #######################
    [auth.generic_oauth]
    name = OAuth
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = user:email
    email_attribute_name = email:primary
    auth_url =
    token_url =
    api_url =
    team_ids =
    allowed_organizations =
    tls_skip_verify_insecure = false
    tls_client_cert =
    tls_client_key =
    tls_client_ca =
    
    #################################### Basic Auth ##########################
    [auth.basic]
    enabled = true
    
    #################################### Auth Proxy ##########################
    [auth.proxy]
    enabled = false
    header_name = X-WEBAUTH-USER
    header_property = username
    auto_sign_up = true
    ldap_sync_ttl = 60
    whitelist =
    
    #################################### Auth LDAP ###########################
    [auth.ldap]
    enabled = false
    config_file = /etc/grafana/ldap.toml
    allow_sign_up = true
    
    #################################### SMTP / Emailing #####################
    [smtp]
    enabled = false
    host = localhost:25
    user =
    # If the password contains # or ; you have to wrap it with triple quotes. Ex """#password;"""
    password =
    cert_file =
    key_file =
    skip_verify = false
    from_address = admin@grafana.localhost
    from_name = Grafana
    ehlo_identity =
    
    [emails]
    welcome_email_on_sign_up = false
    templates_pattern = emails/*.html
    
    #################################### Logging ##########################
    [log]
    # Either "console", "file", "syslog". Default is console and  file
    # Use space to separate multiple modes, e.g. "console file"
    mode = console file
    
    # Either "debug", "info", "warn", "error", "critical", default is "info"
    level = info
    
    # optional settings to set different levels for specific loggers. Ex filters = sqlstore:debug
    filters =
    
    # For "console" mode only
    [log.console]
    level =
    
    # log line format, valid options are text, console and json
    format = console
    
    # For "file" mode only
    [log.file]
    level =
    
    # log line format, valid options are text, console and json
    format = text
    
    # This enables automated log rotate(switch of following options), default is true
    log_rotate = true
    
    # Max line number of single file, default is 1000000
    max_lines = 1000000
    
    # Max size shift of single file, default is 28 means 1 << 28, 256MB
    max_size_shift = 28
    
    # Segment log daily, default is true
    daily_rotate = true
    
    # Expired days of log file(delete after max days), default is 7
    max_days = 7
    
    [log.syslog]
    level =
    
    # log line format, valid options are text, console and json
    format = text
    
    # Syslog network type and address. This can be udp, tcp, or unix. If left blank, the default unix endpoints will be used.
    network =
    address =
    
    # Syslog facility. user, daemon and local0 through local7 are valid.
    facility =
    
    # Syslog tag. By default, the process' argv[0] is used.
    tag =
    
    #################################### Usage Quotas ########################
    [quota]
    enabled = false
    
    #### set quotas to -1 to make unlimited. ####
    # limit number of users per Org.
    org_user = 10
    
    # limit number of dashboards per Org.
    org_dashboard = 100
    
    # limit number of data_sources per Org.
    org_data_source = 10
    
    # limit number of api_keys per Org.
    org_api_key = 10
    
    # limit number of orgs a user can create.
    user_org = 10
    
    # Global limit of users.
    global_user = -1
    
    # global limit of orgs.
    global_org = -1
    
    # global limit of dashboards
    global_dashboard = -1
    
    # global limit of api_keys
    global_api_key = -1
    
    # global limit on number of logged in users.
    global_session = -1
    
    #################################### Alerting ############################
    [alerting]
    # Disable alerting engine & UI features
    enabled = true
    # Makes it possible to turn off alert rule execution but alerting UI is visible
    execute_alerts = true
    
    # Default setting for new alert rules. Defaults to categorize error and timeouts as alerting. (alerting, keep_state)
    error_or_timeout = alerting
    
    # Default setting for how Grafana handles nodata or null values in alerting. (alerting, no_data, keep_state, ok)
    nodata_or_nullvalues = no_data
    
    # Alert notifications can include images, but rendering many images at the same time can overload the server
    # This limit will protect the server from render overloading and make sure notifications are sent out quickly
    concurrent_render_limit = 5
    
    #################################### Explore #############################
    [explore]
    # Enable the Explore section
    enabled = false
    
    #################################### Internal Grafana Metrics ############
    # Metrics available at HTTP API Url /metrics
    [metrics]
    enabled           = true
    interval_seconds  = 10
    
    # Send internal Grafana metrics to graphite
    [metrics.graphite]
    # Enable by setting the address setting (ex localhost:2003)
    address =
    prefix = prod.grafana.%(instance_name)s.
    
    [grafana_net]
    url = https://grafana.com
    
    [grafana_com]
    url = https://grafana.com
    
    #################################### Distributed tracing ############
    [tracing.jaeger]
    # jaeger destination (ex localhost:6831)
    address =
    # tag that will always be included in when creating new spans. ex (tag1:value1,tag2:value2)
    always_included_tag =
    # Type specifies the type of the sampler: const, probabilistic, rateLimiting, or remote
    sampler_type = const
    # jaeger samplerconfig param
    # for "const" sampler, 0 or 1 for always false/true respectively
    # for "probabilistic" sampler, a probability between 0 and 1
    # for "rateLimiting" sampler, the number of spans per second
    # for "remote" sampler, param is the same as for "probabilistic"
    # and indicates the initial sampling rate before the actual one
    # is received from the mothership
    sampler_param = 1
    
    #################################### External Image Storage ##############
    [external_image_storage]
    # You can choose between (s3, webdav, gcs, azure_blob, local)
    provider =
    
    [external_image_storage.s3]
    bucket_url =
    bucket =
    region =
    path =
    access_key =
    secret_key =
    
    [external_image_storage.webdav]
    url =
    username =
    password =
    public_url =
    
    [external_image_storage.gcs]
    key_file =
    bucket =
    path =
    
    [external_image_storage.azure_blob]
    account_name =
    account_key =
    container_name =
    
    [external_image_storage.local]
    # does not require any configuration
    
    [rendering]
    # Options to configure external image rendering server like https://github.com/grafana/grafana-image-renderer
    server_url =
    callback_url =
    
  init.sh: |+
    #!/bin/sh
    
    host=127.0.0.1
    port=3000
    
    user=${GRAFANA_USERNAME:-admin}
    pass=${GRAFANA_PASSWORD:-123456}
    url="http://${user}:${pass}@${host}:${port}"
    url2="http://${host}:${port}"
    ds_url="${url2}/api/datasources"
    dashboard_url="${url2}/api/dashboard/db"
    
    org="cubefs.io"
    
    parse_json(){
        echo "$1" | sed "s/.*\"$2\":\([^,}]*\).*/\1/"
        #echo "${1//\"/}" | sed "s/.*$2:\([^,}]*\).*/\1/"
    }
    
    # add org
    req=$(curl -s -X POST -H "Content-Type: application/json" -d '{"name":"${org}"}' ${url}/api/orgs)
    echo ${req}
    
    message=$(parse_json "${req}" "message" )
    
    echo "$message"
    
    orgid=$(parse_json "${req}" "orgId")
    # set org to admin
    curl -s -X POST ${url}/api/user/using/${orgid}
    
    # get token key
    #curl -s -X POST -H "Content-Type: application/json" -d '{"name":"apikeycurl", "role": "Admin"}' ${url}/api/auth/keys
    rep=$(curl -s -X POST -H "Content-Type: application/json" -d '{"name":"apikeycurl", "role": "Admin"}' ${url}/api/auth/keys)
    echo ${req}
    key=$(parse_json "${rep}" "key")
    echo "key ${key}"
    
    echo "add ds"
    # add datasource
    curl -s -X POST -H "Content-Type: application/json" -u ${user}:${pass} ${ds_url} -d @/grafana/ds.json
    #until curl -s -XPOST -H "Content-Type: application/json" --connect-timeout 1 -u ${userName}:${password} ${ds_url} -d @/grafana/ds.json >/dev/null; do
        #sleep 1
    #done
    
    # add dashboard
    
    #echo "add dashboard"
    curl  -X POST --insecure -H "Authorization: Bearer ${key}" -H "Content-Type: application/json" -d @/grafana/dashboard.json ${url2}/api/dashboards/db
    
  config.monitor: |+
    ECURITY_ADMIN_PASSWORD=123456
    GF_USERS_ALLOW_SIGN_UP=false
    
  cubefs.json: |+
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "gnetId": null,
      "graphTooltip": 0,
      "iteration": 1613789087580,
      "links": [],
      "panels": [
        {
          "collapsed": false,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 40,
          "panels": [],
          "title": "Cluster",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": null,
          "description": "master node total count of cluster",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 0,
            "y": 1
          },
          "id": 38,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "options": {},
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(up{cluster=\"$cluster\", app=\"$app\", role=\"master\"} > 0)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "MasterCount",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": null,
          "description": "Metanode total count for current selected cluster",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 3,
            "y": 1
          },
          "id": 42,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "options": {},
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(up{cluster=\"$cluster\", app=\"$app\", role=\"metanode\"} > 0)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "MetaNodeCount",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": null,
          "description": "datanode count",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 6,
            "y": 1
          },
          "id": 41,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "options": {},
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(up{cluster=\"$cluster\", app=\"$app\", role=\"dataNode\"} > 0)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "DataNodeCount",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": null,
          "description": "objectnode count",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 9,
            "y": 1
          },
          "id": 86,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "options": {},
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(go_info{cluster=\"$cluster\", app=\"$app\", role=\"objectnode\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "ObjectNodeCount",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": null,
          "description": "Fuse Client Count",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 12,
            "y": 1
          },
          "id": 287,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "options": {},
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(up{cluster=\"$cluster\", app=\"$app\", role=\"fuseclient\"} > 0)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "ClientCount",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": null,
          "description": "Cluster volume total count",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 15,
            "y": 1
          },
          "id": 93,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "options": {},
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "avg(cfs_master_vol_count{app=\"$app\", cluster=\"$cluster\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "VolumeCount",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": null,
          "description": "Cubefs process start time of selected instance",
          "format": "dateTimeFromNow",
          "gauge": {
            "maxValue": 100,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 18,
            "y": 1
          },
          "id": 113,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "options": {},
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "process_start_time_seconds{cluster=\"$cluster\", app=\"$app\", instance=~\"$instance\"}*1000",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "ProcessStartTime",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "datasource": null,
          "gridPos": {
            "h": 6,
            "w": 6,
            "x": 0,
            "y": 5
          },
          "id": 177,
          "options": {
            "displayMode": "gradient",
            "fieldOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "defaults": {
                "mappings": [],
                "max": 300000,
                "min": 0,
                "thresholds": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "#EAB839",
                    "value": 200000
                  },
                  {
                    "color": "red",
                    "value": 300000
                  }
                ],
                "unit": "gbytes"
              },
              "override": {},
              "values": false
            },
            "orientation": "horizontal"
          },
          "pluginVersion": "6.4.4",
          "targets": [
            {
              "expr": "cfs_master_dataNodes_total_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"}",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "TotalSize",
              "refId": "B"
            },
            {
              "expr": "cfs_master_dataNodes_used_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"}",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "UsedSize",
              "refId": "A"
            },
            {
              "expr": "cfs_master_dataNodes_increased_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"}",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "IncreasedSize",
              "refId": "C"
            }
          ],
          "title": "DatanodeSize",
          "type": "bargauge"
        },
        {
          "datasource": null,
          "description": "metanode size of total, used and increased.",
          "gridPos": {
            "h": 6,
            "w": 6,
            "x": 6,
            "y": 5
          },
          "id": 92,
          "options": {
            "displayMode": "gradient",
            "fieldOptions": {
              "calcs": [
                "last"
              ],
              "defaults": {
                "mappings": [],
                "max": 5,
                "min": 0,
                "thresholds": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "#EAB839",
                    "value": 3
                  },
                  {
                    "color": "red",
                    "value": 5
                  }
                ],
                "unit": "gbytes"
              },
              "override": {},
              "values": false
            },
            "orientation": "horizontal"
          },
          "pluginVersion": "6.4.4",
          "targets": [
            {
              "expr": "sum(cfs_master_metaNodes_total_GB{cluster=~\"$cluster\", instance=\"$master_instance\"})",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "TotalSize",
              "refId": "B"
            },
            {
              "expr": "sum(cfs_master_metaNodes_used_GB{cluster=~\"$cluster\", instance=\"$master_instance\"} )",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "UsedSize",
              "refId": "A"
            },
            {
              "expr": "sum(cfs_master_metaNodes_increased_GB{cluster=~\"$cluster\", instance=\"$master_instance\"})",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "IncreasedSize",
              "refId": "C"
            }
          ],
          "title": "MetanodeSize",
          "type": "bargauge"
        },
        {
          "datasource": null,
          "description": "Top K total size of all volume",
          "gridPos": {
            "h": 6,
            "w": 9,
            "x": 12,
            "y": 5
          },
          "id": 175,
          "options": {
            "displayMode": "gradient",
            "fieldOptions": {
              "calcs": [
                "last"
              ],
              "defaults": {
                "mappings": [
                  {
                    "op": "=",
                    "text": "N/A",
                    "type": 2,
                    "value": "null"
                  }
                ],
                "max": 100,
                "min": 0,
                "nullValueMode": "connected",
                "thresholds": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "#EAB839",
                    "value": 50
                  },
                  {
                    "color": "red",
                    "value": 100
                  }
                ],
                "unit": "bytes"
              },
              "override": {},
              "values": true
            },
            "orientation": "horizontal"
          },
          "pluginVersion": "6.4.4",
          "targets": [
            {
              "expr": "topk($topk, cfs_master_vol_total_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"})",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "{{volName}}",
              "refId": "A"
            }
          ],
          "title": "VolumeTotalSize",
          "type": "bargauge"
        },
        {
          "datasource": null,
          "description": "Datanode used size ratio with total size",
          "gridPos": {
            "h": 6,
            "w": 3,
            "x": 0,
            "y": 11
          },
          "id": 281,
          "options": {
            "fieldOptions": {
              "calcs": [
                "last"
              ],
              "defaults": {
                "mappings": [],
                "max": 1,
                "min": 0,
                "thresholds": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "#EAB839",
                    "value": 0.5
                  },
                  {
                    "color": "red",
                    "value": 0.8
                  }
                ],
                "unit": "percentunit"
              },
              "override": {},
              "values": false
            },
            "orientation": "horizontal",
            "showThresholdLabels": false,
            "showThresholdMarkers": true
          },
          "pluginVersion": "6.4.4",
          "targets": [
            {
              "expr": "cfs_master_dataNodes_used_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"}/ cfs_master_dataNodes_total_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"}",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "DataNodeUsedRatio",
              "refId": "D"
            }
          ],
          "title": "DataNodeUsedRatio",
          "type": "gauge"
        },
        {
          "datasource": null,
          "description": "Metanode used size ratio with total size",
          "gridPos": {
            "h": 6,
            "w": 3,
            "x": 3,
            "y": 11
          },
          "id": 282,
          "options": {
            "fieldOptions": {
              "calcs": [
                "last"
              ],
              "defaults": {
                "mappings": [],
                "max": 1,
                "min": 0,
                "thresholds": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "#EAB839",
                    "value": 0.5
                  },
                  {
                    "color": "red",
                    "value": 0.8
                  }
                ],
                "unit": "percentunit"
              },
              "override": {},
              "values": false
            },
            "orientation": "horizontal",
            "showThresholdLabels": false,
            "showThresholdMarkers": true
          },
          "pluginVersion": "6.4.4",
          "targets": [
            {
              "expr": "cfs_master_metaNodes_used_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"} / cfs_master_metaNodes_total_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"}",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "MetaNodeUsedRatio",
              "refId": "A"
            }
          ],
          "title": "MetaNodeUsedRatio",
          "type": "gauge"
        },
        {
          "datasource": null,
          "description": "Datanode inactive count",
          "gridPos": {
            "h": 6,
            "w": 3,
            "x": 6,
            "y": 11
          },
          "id": 181,
          "options": {
            "fieldOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "defaults": {
                "mappings": [],
                "max": 100,
                "min": 0,
                "thresholds": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "override": {},
              "values": false
            },
            "orientation": "auto",
            "showThresholdLabels": false,
            "showThresholdMarkers": true
          },
          "pluginVersion": "6.4.4",
          "targets": [
            {
              "expr": "cfs_master_dataNodes_inactive{app=\"$app\", cluster=\"$cluster\", instance=\"$master_instance\"}",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "sum",
              "refId": "A"
            }
          ],
          "title": "DataNodeInactive",
          "type": "gauge"
        },
        {
          "datasource": null,
          "description": "Metanode inactive count",
          "gridPos": {
            "h": 6,
            "w": 3,
            "x": 9,
            "y": 11
          },
          "id": 180,
          "options": {
            "fieldOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "defaults": {
                "mappings": [],
                "max": 100,
                "min": 0,
                "thresholds": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "override": {},
              "values": false
            },
            "orientation": "auto",
            "showThresholdLabels": false,
            "showThresholdMarkers": true
          },
          "pluginVersion": "6.4.4",
          "targets": [
            {
              "expr": "cfs_master_metaNodes_inactive{app=\"$app\", cluster=\"$cluster\", instance=\"$master_instance\"}",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "sum",
              "refId": "A"
            }
          ],
          "title": "MetaNodesInactive",
          "type": "gauge"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": null,
          "description": "Disk Error count",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 6,
            "w": 3,
            "x": 12,
            "y": 11
          },
          "id": 179,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "options": {},
          "pluginVersion": "6.4.4",
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true,
            "ymax": null,
            "ymin": null
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "delta(cfs_master_disk_error{app=\"$app\", cluster=\"$cluster\", instance=\"$master_instance\"}[1m])",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "DiskError",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "0",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "datasource": null,
          "description": "top k volume used ratio ",
          "gridPos": {
            "h": 6,
            "w": 6,
            "x": 15,
            "y": 11
          },
          "id": 280,
          "options": {
            "displayMode": "gradient",
            "fieldOptions": {
              "calcs": [
                "last"
              ],
              "defaults": {
                "mappings": [
                  {
                    "op": "=",
                    "text": "N/A",
                    "type": 1,
                    "value": "null"
                  }
                ],
                "max": 1,
                "min": 0,
                "nullValueMode": "connected",
                "thresholds": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "#EAB839",
                    "value": 0.5
                  },
                  {
                    "color": "red",
                    "value": 0.8
                  }
                ],
                "unit": "percentunit"
              },
              "override": {},
              "values": false
            },
            "orientation": "horizontal"
          },
          "pluginVersion": "6.4.4",
          "targets": [
            {
              "expr": "topk($topk, cfs_master_vol_usage_ratio{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"})",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "legendFormat": "{{volName}}",
              "refId": "A"
            }
          ],
          "title": "VolumeUsedRatio",
          "type": "bargauge"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 17
          },
          "id": 184,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume used size",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 6,
                "x": 0,
                "y": 18
              },
              "id": 187,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pluginVersion": "6.4.4",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, cfs_master_vol_used_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{volName}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "VolumeUsedSize",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "logBase": 10,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume usage ratio",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 6,
                "x": 6,
                "y": 18
              },
              "id": 288,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pluginVersion": "6.4.4",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, cfs_master_vol_usage_ratio{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{volName}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "VolumeUsageRatio",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percentunit",
                  "logBase": 10,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": false
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume size rate",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 6,
                "x": 12,
                "y": 18
              },
              "id": 182,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, rate(cfs_master_vol_used_GB{app=\"$app\",cluster=\"$cluster\", instance=\"$master_instance\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{volName}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "VolumeSizeRate",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "Prometheus",
              "description": "Selected volume used/total size and used ratio",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 6,
                "x": 0,
                "y": 24
              },
              "id": 186,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "cfs_master_vol_used_GB{app=\"$app\",cluster=\"$cluster\", volName=\"$vol\", instance=\"$master_instance\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "UsedSize",
                  "refId": "C"
                },
                {
                  "expr": "cfs_master_vol_used_GB{app=\"$app\",cluster=\"$cluster\", volName=\"$vol\", instance=\"$master_instance\"}/cfs_master_vol_total_GB{app=\"$app\",cluster=\"$cluster\", volName=\"$vol\", instance=\"$master_instance\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "UsedRatio",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Size:[[vol]]",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume used ratio",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 6,
                "x": 6,
                "y": 24
              },
              "id": 291,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pluginVersion": "6.4.4",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_dataNode_dataPartitionIOBytes{app=\"$app\", cluster=\"$cluster\", vol=\"$vol\"}[1m]) ) by (type))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{type}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "IORate:[[vol]]",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume used ratio",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 24,
                "x": 0,
                "y": 30
              },
              "id": 295,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pluginVersion": "6.4.4",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "iotype",
              "repeatDirection": "h",
              "scopedVars": {
                "iotype": {
                  "selected": true,
                  "text": "write",
                  "value": "write"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_dataNode_dataPartitionIOBytes{app=\"$app\", cluster=\"$cluster\", vol=\"$vol\", type=\"$iotype\"}[1m]) ) by (instance, partid, type))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}:{{partid}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "VolPartitionIO:[[vol]]:[[iotype]]",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Volume",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 18
          },
          "id": 293,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume used ratio",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 24,
                "x": 0,
                "y": 19
              },
              "id": 188,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pluginVersion": "6.4.4",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "iotype",
              "repeatDirection": "h",
              "scopedVars": {
                "iotype": {
                  "selected": true,
                  "text": "write",
                  "value": "write"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_dataNode_dataPartitionIOBytes{app=\"$app\", cluster=\"$cluster\", type=\"$iotype\"}[1m]) ) by (vol, type))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}:{{type}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "VolIORate:[[iotype]]",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume used ratio",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 24,
                "x": 0,
                "y": 25
              },
              "id": 294,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pluginVersion": "6.4.4",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "iotype",
              "repeatDirection": "h",
              "scopedVars": {
                "iotype": {
                  "selected": true,
                  "text": "write",
                  "value": "write"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_dataNode_dataPartitionIOBytes{app=\"$app\", cluster=\"$cluster\", type=\"$iotype\"}[1m]) ) by (instance,type))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "InstanceIORate:[[iotype]]",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume used ratio",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 24,
                "x": 0,
                "y": 31
              },
              "id": 289,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pluginVersion": "6.4.4",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "iotype",
              "repeatDirection": "h",
              "scopedVars": {
                "iotype": {
                  "selected": true,
                  "text": "write",
                  "value": "write"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_dataNode_dataPartitionIOBytes{app=\"$app\", cluster=\"$cluster\", type=\"$iotype\"}[1m]) ) by (disk, instance))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}:{{disk}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "DiskIORate:[[iotype]]",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "top k volume used ratio",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 24,
                "x": 0,
                "y": 37
              },
              "id": 290,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pluginVersion": "6.4.4",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "iotype",
              "repeatDirection": "h",
              "scopedVars": {
                "iotype": {
                  "selected": true,
                  "text": "write",
                  "value": "write"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/.*UsedRatio.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_dataNode_dataPartitionIOBytes{app=\"$app\", cluster=\"$cluster\", type=\"$iotype\"}[1m]) ) by (instance, partid))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}:{{partid}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "PartitionIORate:[[iotype]]",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "percentunit",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "IO",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 19
          },
          "id": 34,
          "panels": [
            {
              "aliasColors": {},
              "bars": true,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "invalide master nodes",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 0,
                "y": 20
              },
              "id": 162,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "master_count",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, 1 - up{cluster=\"$cluster\", role=\"master\"} > 0 )",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "[[cluster]]_master_{{instance}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "master_nodes_invalide",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": true,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "invalide meta nodes",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 7,
                "y": 20
              },
              "id": 163,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, 1 - up{cluster=\"$cluster\", role=\"metanode\"} > 0 )",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{role}}_{{instance}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[cluster]]_metanode_inactive",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": true,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "invalide data nodes",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 0,
                "y": 27
              },
              "id": 164,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, 1 - up{cluster=\"$cluster\", role=\"dataNode\"}  > 0)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{role}}_{{instance}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "datanode_inactive",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": true,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "invalide fuse clients",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 7,
                "y": 27
              },
              "id": 165,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": true,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, 1 - up{app=\"$app\", cluster=\"$cluster\", role=\"fuseclient\"}  > 0)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{role}}_{{instance}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "fuseclient_inactive",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Master",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 20
          },
          "id": 36,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "Prometheus",
              "description": "metanode op time by instance",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 21
              },
              "id": 117,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "mnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "mnOp": {
                  "selected": true,
                  "text": "OpMetaInodeGet",
                  "value": "OpMetaInodeGet"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, histogram_quantile(0.95, sum by (instance, op, le)(rate(cfs_metanode_[[mnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m]))))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "histogram_quantile(0.95, sum by (le)(rate(cfs_metanode_[[mnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m])))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "avg",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[mnOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "metanode op count per second by instance",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 29
              },
              "id": 205,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "mnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "mnOp": {
                  "selected": true,
                  "text": "OpMetaInodeGet",
                  "value": "OpMetaInodeGet"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_metanode_[[mnOp]]_count{app=\"$app\", cluster=\"$cluster\"}[1m])) by (instance, op))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "sum(rate(cfs_metanode_[[mnOp]]_count{app=\"$app\", cluster=\"$cluster\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "sum",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[mnOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Metanode",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 21
          },
          "id": 27,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "Prometheus",
              "description": "Datanode op time",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 22
              },
              "id": 146,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "dnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "dnOp": {
                  "selected": true,
                  "text": "OpWrite",
                  "value": "OpWrite"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "sum",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, histogram_quantile(0.95, sum by (instance, op, le)(rate(cfs_dataNode_[[dnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m]))))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "P"
                },
                {
                  "expr": "histogram_quantile(0.95, sum by (le)(rate(cfs_dataNode_[[dnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m])))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "avg",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[dnOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "Datanode op count per second",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 29
              },
              "id": 200,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "dnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "dnOp": {
                  "selected": true,
                  "text": "OpWrite",
                  "value": "OpWrite"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_dataNode_[[dnOp]]_count{app=~\"$app\", cluster=\"$cluster\"}[1m])) by (instance, op))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "P"
                },
                {
                  "expr": "sum(rate(cfs_dataNode_[[dnOp]]_count{app=~\"$app\", cluster=\"$cluster\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "sum",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[dnOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Datanode",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 22
          },
          "id": 284,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "Object node op time",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 23
              },
              "id": 285,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "obOp",
              "repeatDirection": "h",
              "scopedVars": {
                "obOp": {
                  "selected": true,
                  "text": "ListObjects",
                  "value": "ListObjects"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "sum",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, cfs_objectnode_action_[[obOp]]{app=\"$app\", cluster=\"$cluster\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "P"
                },
                {
                  "expr": "sum(cfs_objectnode_action_[[obOp]]{app=\"$app\", cluster=\"$cluster\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "sum",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[obOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ns",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ns",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "Object node op count per second",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 30
              },
              "id": 286,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "obOp",
              "repeatDirection": "h",
              "scopedVars": {
                "obOp": {
                  "selected": true,
                  "text": "ListObjects",
                  "value": "ListObjects"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, rate(cfs_objectnode_action_[[obOp]]_count{app=~\"$app\", cluster=\"$cluster\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "P"
                },
                {
                  "expr": "sum(rate(cfs_objectnode_action_[[obOp]]_count{app=~\"$app\", cluster=\"$cluster\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "sum",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[obOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "ObjectNode",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 23
          },
          "id": 66,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "Prometheus",
              "description": "fuse client use meta sdk op time",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 24
              },
              "id": 64,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "mnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "mnOp": {
                  "selected": true,
                  "text": "OpMetaInodeGet",
                  "value": "OpMetaInodeGet"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, histogram_quantile(0.95, sum by (instance, op, le)(rate(cfs_fuseclient_[[mnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m]))))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "K"
                },
                {
                  "expr": "histogram_quantile(0.95, sum by (le)(rate(cfs_fuseclient_[[mnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m])))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "avg",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[mnOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "Prometheus",
              "description": "fuse client use meta sdk op count per second",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 38
              },
              "id": 212,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "mnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "mnOp": {
                  "selected": true,
                  "text": "OpMetaInodeGet",
                  "value": "OpMetaInodeGet"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, rate(cfs_fuseclient_[[mnOp]]_count{app=\"$app\", cluster=\"$cluster\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "K"
                },
                {
                  "expr": "sum(rate(cfs_fuseclient_[[mnOp]]_count{app=\"$app\", cluster=\"$cluster\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "sum",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[mnOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "fuse client op time",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 52
              },
              "id": 215,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "fuseOp",
              "repeatDirection": "h",
              "scopedVars": {
                "fuseOp": {
                  "selected": true,
                  "text": "filewrite",
                  "value": "filewrite"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, histogram_quantile(0.95, sum by (instance, op, le)(rate(cfs_fuseclient_[[fuseOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m]))))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "K"
                },
                {
                  "expr": "histogram_quantile(0.95, sum by (le)(rate(cfs_fuseclient_[[fuseOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m])))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "avg",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[fuseOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 0,
                  "format": "µs",
                  "logBase": 1,
                  "min": null,
                  "show": true
                },
                {
                  "decimals": 0,
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "fuse op count per second",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 66
              },
              "id": 216,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "fuseOp",
              "repeatDirection": "h",
              "scopedVars": {
                "fuseOp": {
                  "selected": true,
                  "text": "filewrite",
                  "value": "filewrite"
                }
              },
              "seriesOverrides": [
                {
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum by (instance)(rate(cfs_fuseclient_[[fuseOp]]_count{app=\"$app\", cluster=\"$cluster\"}[2m])))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{instance}}",
                  "refId": "K"
                },
                {
                  "expr": "sum(rate(cfs_fuseclient_[[fuseOp]]_count{app=\"$app\", cluster=\"$cluster\"}[2m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "sum",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "[[fuseOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "FuseClient",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 24
          },
          "id": 298,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "fuse client op time",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 25
              },
              "id": 305,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeatDirection": "h",
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "histogram_quantile(0.95, sum by (vol, fuseOp, le)(rate(cfs_fuseclient_[[fuseOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\",vol=\"$vol\"}[5m])))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}",
                  "refId": "K"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "fuse:[[fuseOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": 1,
                  "format": "µs",
                  "label": "",
                  "logBase": 1,
                  "min": null,
                  "show": true
                },
                {
                  "decimals": 1,
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "fuse op count per second",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 32
              },
              "id": 306,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeatDirection": "h",
              "seriesOverrides": [
                {
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum by (vol)(rate(cfs_fuseclient_[[fuseOp]]_count{app=\"$app\", cluster=\"$cluster\",vol=\"$vol\"}[2m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}",
                  "refId": "K"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "fuse:[[fuseOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "Prometheus",
              "description": "fuse client use meta sdk op time",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 39
              },
              "id": 303,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeatDirection": "h",
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "histogram_quantile(0.95, sum by (le,vol)(rate(cfs_fuseclient_[[mnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\",vol=\"$vol\"}[5m])))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "fuse:[[mnOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "Prometheus",
              "description": "fuse client use meta sdk op count per second",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 46
              },
              "id": 304,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeatDirection": "h",
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(cfs_fuseclient_[[mnOp]]_count{app=\"$app\", cluster=\"$cluster\",vol=\"$vol\"}[1m])) by(vol)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "fuse:[[mnOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "metanode op time by vol",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 53
              },
              "id": 299,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "mnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "mnOp": {
                  "selected": true,
                  "text": "OpMetaInodeGet",
                  "value": "OpMetaInodeGet"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, histogram_quantile(0.95, sum by (vol, op, le) (rate(cfs_metanode_[[mnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\",vol=\"$vol\"}[5m]))))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}:{{op}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "meta:[[mnOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "metanode op count per second by vol",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 61
              },
              "id": 300,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "mnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "mnOp": {
                  "selected": true,
                  "text": "OpMetaInodeGet",
                  "value": "OpMetaInodeGet"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_metanode_[[mnOp]]_count{app=\"$app\", cluster=\"$cluster\",vol=\"$vol\"}[1m])) by (vol, op))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}:{{op}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "meta:[[mnOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "Prometheus",
              "description": "Datanode op time by vol",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 69
              },
              "id": 301,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "dnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "dnOp": {
                  "selected": true,
                  "text": "OpWrite",
                  "value": "OpWrite"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "sum",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, histogram_quantile(0.95, sum by (vol, op, le)(rate(cfs_dataNode_[[dnOp]]_hist_bucket{app=\"$app\", cluster=\"$cluster\"}[5m]))))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}:{{op}}",
                  "refId": "P"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "data:[[dnOp]]:Time",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "µs",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": null,
              "description": "Datanode op count per second by vol",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 76
              },
              "id": 302,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "maxPerRow": 4,
              "nullPointMode": "null",
              "options": {
                "dataLinks": []
              },
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "repeat": "dnOp",
              "repeatDirection": "h",
              "scopedVars": {
                "dnOp": {
                  "selected": true,
                  "text": "OpWrite",
                  "value": "OpWrite"
                }
              },
              "seriesOverrides": [
                {
                  "alias": "/sum/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "topk($topk, sum(rate(cfs_dataNode_[[dnOp]]_count{app=~\"$app\", cluster=\"$cluster\"}[1m])) by (vol, op))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{vol}}:{{op}}",
                  "refId": "P"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "data:[[dnOp]]:Ops",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "VolOP",
          "type": "row"
        },
        {
          "collapsed": true,
          "datasource": null,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 25
          },
          "id": 60,
          "panels": [
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "y": 25
              },
              "id": 61,
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "topk($topk, rate(go_goroutines{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{role}}_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "topk($topk,go_threads{app=\"$app\", cluster=\"$cluster\", role=\"$role\"})",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "go_threads_{{instance}}",
                  "refId": "B"
                }
              ],
              "title": "go_goroutines",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 7,
                "y": 25
              },
              "id": 169,
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "topk($topk, rate(go_threads{app=\"$app\", cluster=\"$cluster\"}[1m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{role}}_{{instance}}",
                  "refId": "B"
                }
              ],
              "title": "go_threads",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 14,
                "y": 25
              },
              "id": 63,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "gc_rate",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "go_gc_duration_seconds{instance=~\"$instance\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "seconds_{{quantile}}",
                  "refId": "A"
                },
                {
                  "expr": "rate(go_gc_duration_seconds_count{instance=~\"$instance\"}[1m])",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "gc_rate",
                  "refId": "B"
                }
              ],
              "title": "gc_duration",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "s",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "y": 31
              },
              "id": 109,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "gc_rate",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "process_resident_memory_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\" }",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "resident_memory_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "process_virtual_memory_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "virtual_memory_bytes_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "process_virtual_memory_max_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "virtual_memory_max_bytes_{{instance}}",
                  "refId": "C"
                }
              ],
              "title": "process_resident_memory",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 7,
                "y": 31
              },
              "id": 166,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "gc_rate",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "process_resident_memory_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\" }",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "resident_memory_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "process_virtual_memory_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "virtual_memory_bytes_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "process_virtual_memory_max_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "virtual_memory_max_bytes_{{instance}}",
                  "refId": "C"
                }
              ],
              "title": "process_virtual_memory",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 14,
                "y": 31
              },
              "id": 167,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "gc_rate",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "process_resident_memory_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\" }",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "resident_memory_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "process_virtual_memory_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "virtual_memory_bytes_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "process_virtual_memory_max_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "virtual_memory_max_bytes_{{instance}}",
                  "refId": "C"
                }
              ],
              "title": "process_virtual_memory_max",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "y": 37
              },
              "id": 110,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "gc_rate",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "process_open_fds{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "open_fds_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "process_max_fds{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "max_fds_{{instance}}",
                  "refId": "B"
                }
              ],
              "title": "open_fds",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 7,
                "y": 37
              },
              "id": 168,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "gc_rate",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "process_open_fds{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "open_fds_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "process_max_fds{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "max_fds_{{instance}}",
                  "refId": "B"
                }
              ],
              "title": "max_fds",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 14,
                "y": 37
              },
              "id": 111,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "gc_rate",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "rate(process_cpu_seconds_total{cluster=\"$cluster\", role=\"$role\"}[1m])",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "cpu_seconds_{{instance}}",
                  "refId": "A"
                }
              ],
              "title": "process_cpu",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "s",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "locale",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "y": 43
              },
              "id": 62,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "go_memstats_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "go_memstats_alloc_bytes_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_total_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "go_memstats_heap_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_alloc_bytes_{{instance}}",
                  "refId": "C"
                },
                {
                  "expr": "go_memstats_heap_inuse_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_inuse_bytes_{{instance}}",
                  "refId": "D"
                },
                {
                  "expr": "go_memstats_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "sys_bytes_{{instance}}",
                  "refId": "E"
                },
                {
                  "expr": "go_memstats_mallocs_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mallocs_total_{{instance}}",
                  "refId": "F"
                },
                {
                  "expr": "go_memstats_frees_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "frees_total_{{instance}}",
                  "refId": "G"
                },
                {
                  "expr": "go_memstats_other_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "other_sys_bytes_{{instance}}",
                  "refId": "H"
                },
                {
                  "expr": "go_memstats_mcache_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mcache_sys_bytes_{{instance}}",
                  "refId": "I"
                }
              ],
              "title": "alloc_bytes",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 7,
                "y": 43
              },
              "id": 172,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "go_memstats_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "go_memstats_alloc_bytes_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_total_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "go_memstats_heap_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "heap_alloc_bytes_{{instance}}",
                  "refId": "C"
                },
                {
                  "expr": "go_memstats_heap_inuse_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_inuse_bytes_{{instance}}",
                  "refId": "D"
                },
                {
                  "expr": "go_memstats_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "sys_bytes_{{instance}}",
                  "refId": "E"
                },
                {
                  "expr": "go_memstats_mallocs_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mallocs_total_{{instance}}",
                  "refId": "F"
                },
                {
                  "expr": "go_memstats_frees_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "frees_total_{{instance}}",
                  "refId": "G"
                },
                {
                  "expr": "go_memstats_other_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "other_sys_bytes_{{instance}}",
                  "refId": "H"
                },
                {
                  "expr": "go_memstats_mcache_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mcache_sys_bytes_{{instance}}",
                  "refId": "I"
                }
              ],
              "title": "heap_alloc",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 14,
                "y": 43
              },
              "id": 171,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "go_memstats_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "go_memstats_alloc_bytes_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_total_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "go_memstats_heap_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_alloc_bytes_{{instance}}",
                  "refId": "C"
                },
                {
                  "expr": "go_memstats_heap_inuse_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "heap_inuse_bytes_{{instance}}",
                  "refId": "D"
                },
                {
                  "expr": "go_memstats_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "sys_bytes_{{instance}}",
                  "refId": "E"
                },
                {
                  "expr": "go_memstats_mallocs_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mallocs_total_{{instance}}",
                  "refId": "F"
                },
                {
                  "expr": "go_memstats_frees_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "frees_total_{{instance}}",
                  "refId": "G"
                },
                {
                  "expr": "go_memstats_other_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "other_sys_bytes_{{instance}}",
                  "refId": "H"
                },
                {
                  "expr": "go_memstats_mcache_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mcache_sys_bytes_{{instance}}",
                  "refId": "I"
                }
              ],
              "title": "heap_inuse",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "y": 49
              },
              "id": 170,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "go_memstats_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "go_memstats_alloc_bytes_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_total_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "go_memstats_heap_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_alloc_bytes_{{instance}}",
                  "refId": "C"
                },
                {
                  "expr": "go_memstats_heap_inuse_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_inuse_bytes_{{instance}}",
                  "refId": "D"
                },
                {
                  "expr": "go_memstats_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "sys_bytes_{{instance}}",
                  "refId": "E"
                },
                {
                  "expr": "go_memstats_mallocs_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mallocs_total_{{instance}}",
                  "refId": "F"
                },
                {
                  "expr": "go_memstats_frees_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "frees_total_{{instance}}",
                  "refId": "G"
                },
                {
                  "expr": "go_memstats_other_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "other_sys_bytes_{{instance}}",
                  "refId": "H"
                },
                {
                  "expr": "go_memstats_mcache_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mcache_sys_bytes_{{instance}}",
                  "refId": "I"
                }
              ],
              "title": "sys_bytes",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 7,
                "y": 49
              },
              "id": 173,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "go_memstats_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "go_memstats_alloc_bytes_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_total_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "go_memstats_heap_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_alloc_bytes_{{instance}}",
                  "refId": "C"
                },
                {
                  "expr": "go_memstats_heap_inuse_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_inuse_bytes_{{instance}}",
                  "refId": "D"
                },
                {
                  "expr": "go_memstats_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "sys_bytes_{{instance}}",
                  "refId": "E"
                },
                {
                  "expr": "go_memstats_mallocs_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mallocs_total_{{instance}}",
                  "refId": "F"
                },
                {
                  "expr": "go_memstats_frees_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "frees_total_{{instance}}",
                  "refId": "G"
                },
                {
                  "expr": "go_memstats_other_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "other_sys_bytes_{{instance}}",
                  "refId": "H"
                },
                {
                  "expr": "go_memstats_mcache_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mcache_sys_bytes_{{instance}}",
                  "refId": "I"
                }
              ],
              "title": "other_sys",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ]
            },
            {
              "dashLength": 10,
              "fill": 1,
              "gridPos": {
                "h": 6,
                "w": 7,
                "x": 14,
                "y": 49
              },
              "id": 174,
              "legend": {
                "show": true
              },
              "lines": true,
              "linewidth": 1,
              "nullPointMode": "null",
              "pointradius": 5,
              "renderer": "flot",
              "spaceLength": 10,
              "targets": [
                {
                  "expr": "go_memstats_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_{{instance}}",
                  "refId": "A"
                },
                {
                  "expr": "go_memstats_alloc_bytes_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "alloc_bytes_total_{{instance}}",
                  "refId": "B"
                },
                {
                  "expr": "go_memstats_heap_alloc_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_alloc_bytes_{{instance}}",
                  "refId": "C"
                },
                {
                  "expr": "go_memstats_heap_inuse_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "heap_inuse_bytes_{{instance}}",
                  "refId": "D"
                },
                {
                  "expr": "go_memstats_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "sys_bytes_{{instance}}",
                  "refId": "E"
                },
                {
                  "expr": "go_memstats_mallocs_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "mallocs_total_{{instance}}",
                  "refId": "F"
                },
                {
                  "expr": "go_memstats_frees_total{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "frees_total_{{instance}}",
                  "refId": "G"
                },
                {
                  "expr": "go_memstats_other_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "other_sys_bytes_{{instance}}",
                  "refId": "H"
                },
                {
                  "expr": "go_memstats_mcache_sys_bytes{app=\"$app\", cluster=\"$cluster\", role=\"$role\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "mcache_sys_bytes_{{instance}}",
                  "refId": "I"
                }
              ],
              "title": "mcache_sys",
              "tooltip": {
                "shared": true,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ]
            }
          ],
          "title": "GoRuntime",
          "type": "row"
        }
      ],
      "refresh": "30s",
      "schemaVersion": 20,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": {
              "selected": true,
              "text": "cfs",
              "value": "cfs"
            },
            "hide": 2,
            "includeAll": false,
            "label": "App",
            "multi": false,
            "name": "app",
            "options": [
              {
                "selected": true,
                "text": "cfs",
                "value": "cfs"
              }
            ],
            "query": "cfs",
            "skipUrlSync": false,
            "type": "custom"
          },
          {
            "allValue": null,
            "current": {
              "selected": true,
              "text": "cubefs01",
              "value": "cubefs01"
            },
            "datasource": "Prometheus",
            "definition": "label_values(up{app=\"$app\"}, cluster)",
            "hide": 0,
            "includeAll": false,
            "label": "Cluster",
            "multi": false,
            "name": "cluster",
            "options": [],
            "query": "label_values(up{app=\"$app\"}, cluster)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": true,
              "text": "metanode",
              "value": "metanode"
            },
            "datasource": "Prometheus",
            "definition": "label_values(up{app=\"$app\", cluster=\"$cluster\"}, role)",
            "hide": 0,
            "includeAll": false,
            "label": "Role",
            "multi": false,
            "name": "role",
            "options": [],
            "query": "label_values(up{app=\"$app\", cluster=\"$cluster\"}, role)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": true,
              "text": "5",
              "value": "5"
            },
            "hide": 0,
            "includeAll": false,
            "label": "topK",
            "multi": false,
            "name": "topk",
            "options": [
              {
                "selected": true,
                "text": "5",
                "value": "5"
              },
              {
                "selected": false,
                "text": "10",
                "value": "10"
              },
              {
                "selected": false,
                "text": "20",
                "value": "20"
              },
              {
                "selected": false,
                "text": "30",
                "value": "30"
              },
              {
                "selected": false,
                "text": "50",
                "value": "50"
              },
              {
                "selected": false,
                "text": "100",
                "value": "100"
              }
            ],
            "query": "5,10,20,30,50,100",
            "skipUrlSync": false,
            "type": "custom"
          },
          {
            "allValue": null,
            "current": {
              "text": "OpMetaInodeGet",
              "value": [
                "OpMetaInodeGet"
              ]
            },
            "hide": 0,
            "includeAll": true,
            "label": "MetaNodeOp",
            "multi": true,
            "name": "mnOp",
            "options": [
              {
                "selected": false,
                "text": "All",
                "value": "$__all"
              },
              {
                "selected": false,
                "text": "OpMetaCreateInode",
                "value": "OpMetaCreateInode"
              },
              {
                "selected": false,
                "text": "OpMetaLinkInode",
                "value": "OpMetaLinkInode"
              },
              {
                "selected": false,
                "text": "OpMetaFreeInodesOnRaftFollower",
                "value": "OpMetaFreeInodesOnRaftFollower"
              },
              {
                "selected": false,
                "text": "OpMetaUnlinkInode",
                "value": "OpMetaUnlinkInode"
              },
              {
                "selected": true,
                "text": "OpMetaInodeGet",
                "value": "OpMetaInodeGet"
              },
              {
                "selected": false,
                "text": "OpMetaEvictInode",
                "value": "OpMetaEvictInode"
              },
              {
                "selected": false,
                "text": "OpMetaSetattr",
                "value": "OpMetaSetattr"
              },
              {
                "selected": false,
                "text": "OpMetaCreateDentry",
                "value": "OpMetaCreateDentry"
              },
              {
                "selected": false,
                "text": "OpMetaDeleteDentry",
                "value": "OpMetaDeleteDentry"
              },
              {
                "selected": false,
                "text": "OpMetaUpdateDentry",
                "value": "OpMetaUpdateDentry"
              },
              {
                "selected": false,
                "text": "OpMetaReadDir",
                "value": "OpMetaReadDir"
              },
              {
                "selected": false,
                "text": "OpCreateMetaPartition",
                "value": "OpCreateMetaPartition"
              },
              {
                "selected": false,
                "text": "OpMetaNodeHeartbeat",
                "value": "OpMetaNodeHeartbeat"
              },
              {
                "selected": false,
                "text": "OpMetaExtentsAdd",
                "value": "OpMetaExtentsAdd"
              },
              {
                "selected": false,
                "text": "OpMetaExtentsList",
                "value": "OpMetaExtentsList"
              },
              {
                "selected": false,
                "text": "OpMetaExtentsDel",
                "value": "OpMetaExtentsDel"
              },
              {
                "selected": false,
                "text": "OpMetaTruncate",
                "value": "OpMetaTruncate"
              },
              {
                "selected": false,
                "text": "OpMetaLookup",
                "value": "OpMetaLookup"
              },
              {
                "selected": false,
                "text": "OpDeleteMetaPartition",
                "value": "OpDeleteMetaPartition"
              },
              {
                "selected": false,
                "text": "OpUpdateMetaPartition",
                "value": "OpUpdateMetaPartition"
              },
              {
                "selected": false,
                "text": "OpLoadMetaPartition",
                "value": "OpLoadMetaPartition"
              },
              {
                "selected": false,
                "text": "OpDecommissionMetaPartition",
                "value": "OpDecommissionMetaPartition"
              },
              {
                "selected": false,
                "text": "OpAddMetaPartitionRaftMember",
                "value": "OpAddMetaPartitionRaftMember"
              },
              {
                "selected": false,
                "text": "OpRemoveMetaPartitionRaftMember",
                "value": "OpRemoveMetaPartitionRaftMember"
              },
              {
                "selected": false,
                "text": "OpMetaPartitionTryToLeader",
                "value": "OpMetaPartitionTryToLeader"
              },
              {
                "selected": false,
                "text": "OpMetaBatchInodeGet",
                "value": "OpMetaBatchInodeGet"
              },
              {
                "selected": false,
                "text": "OpMetaDeleteInode",
                "value": "OpMetaDeleteInode"
              },
              {
                "selected": false,
                "text": "OpMetaBatchExtentsAdd",
                "value": "OpMetaBatchExtentsAdd"
              },
              {
                "selected": false,
                "text": "OpMetaSetXAttr",
                "value": "OpMetaSetXAttr"
              },
              {
                "selected": false,
                "text": "OpMetaGetXAttr",
                "value": "OpMetaGetXAttr"
              },
              {
                "selected": false,
                "text": "OpMetaBatchGetXAttr",
                "value": "OpMetaBatchGetXAttr"
              },
              {
                "selected": false,
                "text": "OpMetaRemoveXAttr",
                "value": "OpMetaRemoveXAttr"
              },
              {
                "selected": false,
                "text": "OpMetaListXAttr",
                "value": "OpMetaListXAttr"
              },
              {
                "selected": false,
                "text": "OpCreateMultipart",
                "value": "OpCreateMultipart"
              },
              {
                "selected": false,
                "text": "OpListMultiparts",
                "value": "OpListMultiparts"
              },
              {
                "selected": false,
                "text": "OpRemoveMultipart",
                "value": "OpRemoveMultipart"
              },
              {
                "selected": false,
                "text": "OpAddMultipartPart",
                "value": "OpAddMultipartPart"
              },
              {
                "selected": false,
                "text": "OpGetMultipart",
                "value": "OpGetMultipart"
              }
            ],
            "query": "OpMetaCreateInode, OpMetaLinkInode, OpMetaFreeInodesOnRaftFollower, OpMetaUnlinkInode, OpMetaInodeGet, OpMetaEvictInode, OpMetaSetattr, OpMetaCreateDentry, OpMetaDeleteDentry, OpMetaUpdateDentry, OpMetaReadDir, OpCreateMetaPartition, OpMetaNodeHeartbeat, OpMetaExtentsAdd, OpMetaExtentsList, OpMetaExtentsDel, OpMetaTruncate, OpMetaLookup, OpDeleteMetaPartition, OpUpdateMetaPartition, OpLoadMetaPartition, OpDecommissionMetaPartition, OpAddMetaPartitionRaftMember, OpRemoveMetaPartitionRaftMember, OpMetaPartitionTryToLeader, OpMetaBatchInodeGet, OpMetaDeleteInode, OpMetaBatchExtentsAdd, OpMetaSetXAttr, OpMetaGetXAttr, OpMetaBatchGetXAttr, OpMetaRemoveXAttr, OpMetaListXAttr, OpCreateMultipart, OpListMultiparts, OpRemoveMultipart, OpAddMultipartPart, OpGetMultipart",
            "skipUrlSync": false,
            "type": "custom"
          },
          {
            "allValue": null,
            "current": {
              "text": "OpWrite",
              "value": [
                "OpWrite"
              ]
            },
            "hide": 0,
            "includeAll": true,
            "label": "DataNodeOp",
            "multi": true,
            "name": "dnOp",
            "options": [
              {
                "selected": false,
                "text": "All",
                "value": "$__all"
              },
              {
                "selected": false,
                "text": "OpCreateExtent",
                "value": "OpCreateExtent"
              },
              {
                "selected": true,
                "text": "OpWrite",
                "value": "OpWrite"
              },
              {
                "selected": false,
                "text": "OpSyncWrite",
                "value": "OpSyncWrite"
              },
              {
                "selected": false,
                "text": "OpStreamRead",
                "value": "OpStreamRead"
              },
              {
                "selected": false,
                "text": "OpStreamFollowerRead",
                "value": "OpStreamFollowerRead"
              },
              {
                "selected": false,
                "text": "OpExtentRepairRead",
                "value": "OpExtentRepairRead"
              },
              {
                "selected": false,
                "text": "OpMarkDelete",
                "value": "OpMarkDelete"
              },
              {
                "selected": false,
                "text": "OpRandowWrite",
                "value": "OpRandowWrite"
              },
              {
                "selected": false,
                "text": "OpSyncRandomWrite",
                "value": "OpSyncRandomWrite"
              },
              {
                "selected": false,
                "text": "OpNotifyReplicasToRepair",
                "value": "OpNotifyReplicasToRepair"
              },
              {
                "selected": false,
                "text": "OpGetAllWatermarks",
                "value": "OpGetAllWatermarks"
              },
              {
                "selected": false,
                "text": "OpCreateDataPartition",
                "value": "OpCreateDataPartition"
              },
              {
                "selected": false,
                "text": "OpLoadDataPratition",
                "value": "OpLoadDataPratition"
              },
              {
                "selected": false,
                "text": "OpDeleteDataPartition",
                "value": "OpDeleteDataPartition"
              },
              {
                "selected": false,
                "text": "OpDataNodeHeartbeat",
                "value": "OpDataNodeHeartbeat"
              },
              {
                "selected": false,
                "text": "OpGetAppliedId",
                "value": "OpGetAppliedId"
              },
              {
                "selected": false,
                "text": "OpDecommissionDataPartition",
                "value": "OpDecommissionDataPartition"
              },
              {
                "selected": false,
                "text": "OpAddDataPartitionRaftMember",
                "value": "OpAddDataPartitionRaftMember"
              },
              {
                "selected": false,
                "text": "OpDataPartitionTryToLeader",
                "value": "OpDataPartitionTryToLeader"
              },
              {
                "selected": false,
                "text": "OpGetPartitionSize",
                "value": "OpGetPartitionSize"
              },
              {
                "selected": false,
                "text": "OpGetMaxExtentIDAndPartitionSize",
                "value": "OpGetMaxExtentIDAndPartitionSize"
              },
              {
                "selected": false,
                "text": "OpReadTinyDeleteRecord",
                "value": "OpReadTinyDeleteRecord"
              },
              {
                "selected": false,
                "text": "OpBroadcastMinAppliedID",
                "value": "OpBroadcastMinAppliedID"
              }
            ],
            "query": "OpCreateExtent,OpWrite,OpSyncWrite,OpStreamRead,OpStreamFollowerRead,OpExtentRepairRead,OpMarkDelete,OpRandowWrite,OpSyncRandomWrite,OpNotifyReplicasToRepair,OpGetAllWatermarks,OpCreateDataPartition,OpLoadDataPratition,OpDeleteDataPartition,OpDataNodeHeartbeat,OpGetAppliedId,OpDecommissionDataPartition,OpAddDataPartitionRaftMember,OpDataPartitionTryToLeader,OpGetPartitionSize,OpGetMaxExtentIDAndPartitionSize,OpReadTinyDeleteRecord,OpBroadcastMinAppliedID",
            "skipUrlSync": false,
            "type": "custom"
          },
          {
            "allValue": null,
            "current": {
              "tags": [],
              "text": "filewrite",
              "value": [
                "filewrite"
              ]
            },
            "hide": 0,
            "includeAll": true,
            "label": "fuseOp",
            "multi": true,
            "name": "fuseOp",
            "options": [
              {
                "selected": false,
                "text": "All",
                "value": "$__all"
              },
              {
                "selected": false,
                "text": "mkdir",
                "value": "mkdir"
              },
              {
                "selected": false,
                "text": "mknod",
                "value": "mknod"
              },
              {
                "selected": false,
                "text": "filecreate",
                "value": "filecreate"
              },
              {
                "selected": false,
                "text": "link",
                "value": "link"
              },
              {
                "selected": false,
                "text": "symlink",
                "value": "symlink"
              },
              {
                "selected": false,
                "text": "rmdir",
                "value": "rmdir"
              },
              {
                "selected": false,
                "text": "unlink",
                "value": "unlink"
              },
              {
                "selected": false,
                "text": "readdir",
                "value": "readdir"
              },
              {
                "selected": false,
                "text": "rename",
                "value": "rename"
              },
              {
                "selected": false,
                "text": "fileread",
                "value": "fileread"
              },
              {
                "selected": true,
                "text": "filewrite",
                "value": "filewrite"
              },
              {
                "selected": false,
                "text": "filesync",
                "value": "filesync"
              }
            ],
            "query": "mkdir,mknod,filecreate,link,symlink,rmdir,unlink,readdir,rename,fileread,filewrite,filesync",
            "skipUrlSync": false,
            "type": "custom"
          },
          {
            "allValue": null,
            "current": {
              "text": "ListObjects",
              "value": [
                "ListObjects"
              ]
            },
            "hide": 0,
            "includeAll": true,
            "label": "objectNodeOp",
            "multi": true,
            "name": "obOp",
            "options": [
              {
                "selected": false,
                "text": "All",
                "value": "$__all"
              },
              {
                "selected": false,
                "text": "GetObject",
                "value": "GetObject"
              },
              {
                "selected": false,
                "text": "PutObject",
                "value": "PutObject"
              },
              {
                "selected": false,
                "text": "CopyObject",
                "value": "CopyObject"
              },
              {
                "selected": true,
                "text": "ListObjects",
                "value": "ListObjects"
              },
              {
                "selected": false,
                "text": "DeleteObject",
                "value": "DeleteObject"
              },
              {
                "selected": false,
                "text": "DeleteObjects",
                "value": "DeleteObjects"
              },
              {
                "selected": false,
                "text": "HeadObject",
                "value": "HeadObject"
              },
              {
                "selected": false,
                "text": "CreateBucket",
                "value": "CreateBucket"
              },
              {
                "selected": false,
                "text": "DeleteBucket",
                "value": "DeleteBucket"
              },
              {
                "selected": false,
                "text": "HeadBucket",
                "value": "HeadBucket"
              },
              {
                "selected": false,
                "text": "ListBuckets",
                "value": "ListBuckets"
              },
              {
                "selected": false,
                "text": "GetBucketPolicy",
                "value": "GetBucketPolicy"
              },
              {
                "selected": false,
                "text": "PutBucketPolicy",
                "value": "PutBucketPolicy"
              },
              {
                "selected": false,
                "text": "DeleteBucketPolicy",
                "value": "DeleteBucketPolicy"
              },
              {
                "selected": false,
                "text": "GetBucketAcl",
                "value": "GetBucketAcl"
              },
              {
                "selected": false,
                "text": "PutBucketAcl",
                "value": "PutBucketAcl"
              },
              {
                "selected": false,
                "text": "GetObjectAcl",
                "value": "GetObjectAcl"
              },
              {
                "selected": false,
                "text": "PutObjectAcl",
                "value": "PutObjectAcl"
              },
              {
                "selected": false,
                "text": "CreateMultipartUpload",
                "value": "CreateMultipartUpload"
              },
              {
                "selected": false,
                "text": "ListMultipartUploads",
                "value": "ListMultipartUploads"
              },
              {
                "selected": false,
                "text": "UploadPart",
                "value": "UploadPart"
              },
              {
                "selected": false,
                "text": "ListParts",
                "value": "ListParts"
              },
              {
                "selected": false,
                "text": "CompleteMultipartUpload",
                "value": "CompleteMultipartUpload"
              },
              {
                "selected": false,
                "text": "AbortMultipartUpload",
                "value": "AbortMultipartUpload"
              },
              {
                "selected": false,
                "text": "GetBucketLocation",
                "value": "GetBucketLocation"
              },
              {
                "selected": false,
                "text": "GetObjectXAttr",
                "value": "GetObjectXAttr"
              },
              {
                "selected": false,
                "text": "PutObjectXAttr",
                "value": "PutObjectXAttr"
              },
              {
                "selected": false,
                "text": "ListObjectXAttrs",
                "value": "ListObjectXAttrs"
              },
              {
                "selected": false,
                "text": "DeleteObjectXAttr",
                "value": "DeleteObjectXAttr"
              },
              {
                "selected": false,
                "text": "GetObjectTagging",
                "value": "GetObjectTagging"
              },
              {
                "selected": false,
                "text": "PutObjectTagging",
                "value": "PutObjectTagging"
              },
              {
                "selected": false,
                "text": "DeleteObjectTagging",
                "value": "DeleteObjectTagging"
              },
              {
                "selected": false,
                "text": "GetBucketTagging",
                "value": "GetBucketTagging"
              },
              {
                "selected": false,
                "text": "PutBucketTagging",
                "value": "PutBucketTagging"
              },
              {
                "selected": false,
                "text": "DeleteBucketTagging",
                "value": "DeleteBucketTagging"
              },
              {
                "selected": false,
                "text": "Read",
                "value": "Read"
              },
              {
                "selected": false,
                "text": "Write",
                "value": "Write"
              }
            ],
            "query": "GetObject, PutObject, CopyObject, ListObjects, DeleteObject, DeleteObjects, HeadObject, CreateBucket, DeleteBucket, HeadBucket, ListBuckets, GetBucketPolicy, PutBucketPolicy, DeleteBucketPolicy, GetBucketAcl, PutBucketAcl, GetObjectAcl, PutObjectAcl, CreateMultipartUpload, ListMultipartUploads, UploadPart, ListParts, CompleteMultipartUpload, AbortMultipartUpload, GetBucketLocation, GetObjectXAttr, PutObjectXAttr, ListObjectXAttrs, DeleteObjectXAttr, GetObjectTagging, PutObjectTagging, DeleteObjectTagging, GetBucketTagging, PutBucketTagging, DeleteBucketTagging, Read, Write,",
            "skipUrlSync": false,
            "type": "custom"
          },
          {
            "allValue": null,
            "current": {
              "text": "ltptest",
              "value": "ltptest"
            },
            "datasource": "Prometheus",
            "definition": "label_values(cfs_master_vol_total_GB{app=\"$app\",cluster=\"$cluster\"}, volName)",
            "hide": 0,
            "includeAll": false,
            "label": "Vol",
            "multi": false,
            "name": "vol",
            "options": [],
            "query": "label_values(cfs_master_vol_total_GB{app=\"$app\",cluster=\"$cluster\"}, volName)",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": true,
              "text": "192.168.0.23:9500",
              "value": "192.168.0.23:9500"
            },
            "datasource": "Prometheus",
            "definition": "label_values(up{app=\"$app\", role=\"$role\", cluster=\"$cluster\"}, instance)",
            "hide": 0,
            "includeAll": false,
            "label": "Instance",
            "multi": false,
            "name": "instance",
            "options": [],
            "query": "label_values(up{app=\"$app\", role=\"$role\", cluster=\"$cluster\"}, instance)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": true,
              "text": "192.168.0.23",
              "value": "192.168.0.23"
            },
            "datasource": "Prometheus",
            "definition": "label_values(go_info{instance=\"$instance\", cluster=\"$cluster\"}, instance)",
            "hide": 2,
            "includeAll": false,
            "label": "Host",
            "multi": false,
            "name": "hostip",
            "options": [],
            "query": "label_values(go_info{instance=\"$instance\", cluster=\"$cluster\"}, instance)",
            "refresh": 1,
            "regex": "/([^:]+):.*/",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "selected": true,
              "text": "192.168.0.11:17010",
              "value": "192.168.0.11:17010"
            },
            "datasource": "Prometheus",
            "definition": "label_values(up{app=\"$app\", role=\"master\", cluster=\"$cluster\"}, instance)",
            "hide": 2,
            "includeAll": false,
            "label": "MasterInstance",
            "multi": false,
            "name": "master_instance",
            "options": [],
            "query": "label_values(up{app=\"$app\", role=\"master\", cluster=\"$cluster\"}, instance)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "text": "write",
              "value": [
                "write"
              ]
            },
            "datasource": "Prometheus",
            "definition": "label_values(cfs_dataNode_dataPartitionIOBytes{app=\"$app\",cluster=\"$cluster\"}, type)",
            "hide": 0,
            "includeAll": false,
            "label": "IOType",
            "multi": true,
            "name": "iotype",
            "options": [],
            "query": "label_values(cfs_dataNode_dataPartitionIOBytes{app=\"$app\",cluster=\"$cluster\"}, type)",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "",
      "title": "Cubefs",
      "uid": "J8XJyOmZk1",
      "version": 1
    }
  dashboard.yml: |+
    apiVersion: 1
    
    providers:
    - name: 'Cubefs'
      orgId: 1
      folder: ''
      type: file
      disableDeletion: false
      editable: true
      options:
          path: /etc/grafana/provisioning/dashboards
    
  datasource.yml: |+
    apiVersion: 1
    
    # list of datasources that should be deleted from the database
    deleteDatasources:
      - name: Prometheus
        orgId: 1
    
    # list of datasources to insert/update depending
    # whats available in the database
    datasources:
      # <string, required> name of the datasource. Required
    - name: Prometheus
      # <string, required> datasource type. Required
      type: prometheus
      # <string, required> access mode. direct or proxy. Required
      access: proxy
      # <int> org id. will default to orgId 1 if not specified
      orgId: 1
      # <string> url
      url: http://prometheus-service:9090
      # <string> database password, if used
      password:
      # <string> database user, if used
      user:
      # <string> database name, if used
      database:
      # <bool> enable/disable basic auth
      basicAuth: false
      # <string> basic auth username
      basicAuthUser: admin
      # <string> basic auth password
      basicAuthPassword: 123456
      # <bool> enable/disable with credentials headers
      withCredentials:
      # <bool> mark as default datasource. Max one per org
      isDefault: true
      # <map> fields that will be converted to json and stored in json_data
      jsonData:
        graphiteVersion: "1.1"
        tlsAuth: false
        tlsAuthWithCACert: false
      # <string> json object of data that will be encrypted.
      secureJsonData:
        tlsCACert: "..."
        tlsClientCert: "..."
        tlsClientKey: "..."
      version: 1
      # <bool> allow users to edit datasources from the UI.
      editable: true
    
  prometheus.yml: |+
    # my global config
    global:
      scrape_interval:     15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
      evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.
      # scrape_timeout is set to the global default (10s).
    
    
    scrape_configs:
      - job_name: 'consul'
        relabel_configs:
            - source_labels:  ["__meta_consul_service"]
              action: replace
              regex: "(.*)"
              replacement: '${1}'
              target_label: "service"
            - source_labels: ["__meta_consul_tags"]
              action: replace
              regex: ',(?:[^,]+,){0}([^=]+)=([^,]+),.*'
              replacement: '${2}'
              target_label: '${1}'
            - source_labels: ["__meta_consul_tags"]
              action: replace
              regex: ',(?:[^,]+,){1}([^=]+)=([^,]+),.*'
              replacement: '${2}'
              target_label: '${1}'
            - source_labels: ["__meta_consul_tags"]
              action: replace
              regex: ',(?:[^,]+,){2}([^=]+)=([^,]+),.*'
              replacement: '${2}'
              target_label: '${1}'
        metrics_path: /metrics
        scheme: http
        consul_sd_configs:
            - server: http://consul-service:8500
              services:
                  - cfs
---
# Source: cubefs/templates/configmap-override.yaml
# Configmap cubefs-config-override is used to specify
# config for some specific node, seems not all the nodes
# configuration will be same.
apiVersion: v1
kind: ConfigMap
metadata:
  name: cubefs-config-override
data:
  # Format: "${Node_IP}":${JSON_CONFIG}
  # There's a demo server config 1.1.1.1 left for example,
  # All the config written here will be merged to the final
  # '/cfs/conf/datanode.json' file.
  # Example:  {
  #  "1.1.1.1": {
  #   "logDir": "/data/cfs/log",
  #   "disks": [
  #    "/disk/nvme0n1:59000000000",
  #    "/disk/nvme1n1:59000000000",
  #    "/disk/nvme2n1:59000000000"
  #   ]
  #  }
  # }
  datanode.json: |+
    {
    }
    


  # Similar to datanode config.
  metanode.json: |+
    {
    }
---
# Source: cubefs/templates/storageclass.yaml
kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: cfs-sc
  annotations:
    storageclass.kubernetes.io/is-default-class: "true"
provisioner: csi.cubefs.com
allowVolumeExpansion: true
reclaimPolicy: Delete
parameters:
  # Resource manager IP address or URL
  masterAddr: "master-service:17010"
  # Consul Service IP address or URL
  consulAddr: "http://consul-service:8500"
  # Log level：debug, info, warn, error 
  logLevel: error
---
# Source: cubefs/templates/csi-rbac.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: cfs-csi-cluster-role
rules:
  - apiGroups: [ "" ]
    resources: [ "nodes","pods" ]
    verbs: [ "get", "list", "watch" ]
  - apiGroups: [ "" ]
    resources: [ "secrets" ]
    verbs: [ "get", "list" ]
  - apiGroups: [ "" ]
    resources: [ "events" ]
    verbs: [ "list", "watch", "create", "update", "patch" ]
  - apiGroups: [ "" ]
    resources: [ "persistentvolumes" ]
    verbs: [ "get", "list", "watch", "create", "update", "delete", "patch" ]
  - apiGroups: [ "" ]
    resources: [ "persistentvolumeclaims" ]
    verbs: [ "get", "list", "watch", "update", "patch" ]
  - apiGroups: [ "" ]
    resources: [ "persistentvolumeclaims/status" ]
    verbs: [ "patch" ]
  - apiGroups: [ "storage.k8s.io" ]
    resources: [ "storageclasses" ]
    verbs: [ "get", "list", "watch" ]
  - apiGroups: [ "storage.k8s.io" ]
    resources: [ "csinodes" ]
    verbs: [ "get", "list", "watch" ]
  - apiGroups: [ "storage.k8s.io" ]
    resources: [ "volumeattachments" ]
    verbs: [ "get", "list", "watch", "create", "update", "delete", "patch" ]
  - apiGroups: [ "storage.k8s.io" ]
    resources: [ "volumeattachments/status" ]
    verbs: [ "patch" ]
---
# Source: cubefs/templates/csi-rbac.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: cfs-csi-cluster-role-binding
subjects:
  - kind: ServiceAccount
    name: cfs-csi-service-account
    namespace: default
roleRef:
  kind: ClusterRole
  name: cfs-csi-cluster-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: cubefs/templates/csi-rbac.yaml
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: cfs-csi-role
rules:
  - apiGroups: [ "" ]
    resources: [ "endpoints" ]
    verbs: [ "get", "watch", "list", "delete", "update", "create" ]
  - apiGroups: [ "" ]
    resources: [ "configmaps" ]
    verbs: [ "get", "list", "create", "delete" ]
  - apiGroups: [ "coordination.k8s.io" ]
    resources: [ "leases" ]
    verbs: [ "get", "watch", "list", "delete", "update", "create" ]
---
# Source: cubefs/templates/csi-rbac.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: cfs-csi-role-binding
subjects:
  - kind: ServiceAccount
    name: cfs-csi-service-account
roleRef:
  kind: Role
  name: cfs-csi-role
  apiGroup: rbac.authorization.k8s.io
---
# Source: cubefs/templates/service-consul.yaml
apiVersion: v1
kind: Service
metadata:
  name: consul-service
  
spec:
  ports:
    - port: 8500
      protocol: TCP
      targetPort: 8500
  selector:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: consul
    app.kubernetes.io/version: 3.2.0
---
# Source: cubefs/templates/service-grafana.yaml
apiVersion: v1
kind: Service
metadata:
  name: grafana-service
  
spec:
  ports:
    - port: 3000
      protocol: TCP
      targetPort: 3000
  selector:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: grafana
    app.kubernetes.io/version: 3.2.0
---
# Source: cubefs/templates/service-master.yaml
apiVersion: v1
kind: Service
metadata:
  name: master-service
  
spec:
  ports:
    - port: 17010
      protocol: TCP
      targetPort: 17010
  selector:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: master
    app.kubernetes.io/version: 3.2.0
---
# Source: cubefs/templates/service-objectnode.yaml
apiVersion: v1
kind: Service
metadata:
  name: objectnode-service
  
spec:
  ports:
    - port: 1601
      protocol: TCP
      targetPort: 1601
  selector:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: objectnode
    app.kubernetes.io/version: 3.2.0
---
# Source: cubefs/templates/service-prometheus.yaml
apiVersion: v1
kind: Service
metadata:
  name: prometheus-service
  
spec:
  ports:
    - port: 9090
      protocol: TCP
      targetPort: 9090
  selector:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: prometheus
    app.kubernetes.io/version: 3.2.0
---
# Source: cubefs/templates/csi-node-daemonset.yaml
kind: DaemonSet
apiVersion: apps/v1
metadata:
  name: cfs-csi-node
spec:
  updateStrategy:
    type: OnDelete
  selector:
    matchLabels:
      app: cfs-csi-node
  template:
    metadata:
      labels:
        app: cfs-csi-node
    spec:
      serviceAccount: cfs-csi-service-account
      serviceAccountName: cfs-csi-service-account
      nodeSelector:
        component.cubefs.io/csi: enabled
      containers:
        - name: csi-node-driver-registrar
          image: registry.k8s.io/sig-storage/csi-node-driver-registrar:v2.5.0
          imagePullPolicy: IfNotPresent
          securityContext:
            privileged: true
          args:
            - --csi-address=$(ADDRESS)
            - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: ADDRESS
              value: /csi/csi.sock
            - name: DRIVER_REG_SOCK_PATH
              value: /var/lib/kubelet/plugins/csi.cubefs.com/csi.sock
            - name: KUBE_NODE_NAME
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: spec.nodeName
          resources:
            requests:
              cpu: 200m
              memory: 256Mi
          volumeMounts:
            - mountPath: /csi
              name: socket-dir
            - mountPath: /registration
              name: registration-dir
        - name: cfs-driver
          image: ghcr.io/cubefs/cfs-csi-driver:3.2.0.150.0
          imagePullPolicy: IfNotPresent
          securityContext:
            privileged: true
          args:
            - bash
            - "-c"
            - |-
              set -e
              su -p -s /bin/bash -c "/cfs/bin/start.sh &"
              su -p -s /bin/bash -c "sleep 9999999d"
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: LOG_LEVEL
              value: "5"
            - name: CSI_ENDPOINT
              value: unix:///csi/csi.sock
            - name: DRIVER_NAME
              value: csi.cubefs.com
            - name: KUBE_NODE_NAME
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: spec.nodeName
          lifecycle:
            preStop:
              exec:
                command: [
                  "/bin/sh", "-c",
                  "rm -rf /csi/csi.sock"
                ]
          
          volumeMounts:
            - mountPath: /csi
              name: socket-dir
            - mountPath: /var/lib/kubelet/pods
              mountPropagation: Bidirectional
              name: mountpoint-dir
      volumes:
        - hostPath:
            path: /var/lib/kubelet/plugins/csi.cubefs.com
            type: DirectoryOrCreate
          name: socket-dir
        - hostPath:
            path: /var/lib/kubelet/plugins_registry
            type: DirectoryOrCreate
          name: registration-dir
        - hostPath:
            path: /var/lib/kubelet/pods
            type: Directory
          name: mountpoint-dir
---
# Source: cubefs/templates/daemonset-datanode.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: datanode
  labels:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: datanode
    app.kubernetes.io/version: 3.2.0

spec:
  updateStrategy:
    type: OnDelete
  selector:
    matchLabels:
      app.kubernetes.io/name: default
      app.kubernetes.io/component: datanode
      app.kubernetes.io/version: 3.2.0
  template:
    metadata:
      labels:
        app.kubernetes.io/name: default
        app.kubernetes.io/component: datanode
        app.kubernetes.io/version: 3.2.0
    spec:
      terminationGracePeriodSeconds: 60
      nodeSelector:
        component.cubefs.io/datanode: enabled
      hostNetwork: true
      priorityClassName: cubefs-high-priority
      hostPID: false
      dnsPolicy: ClusterFirstWithHostNet
      initContainers:
        - name: check-master-service
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/check-master-service.sh" ]
          env:
            - name: CBFS_MASTER_SERVICE_PORT
              value: "master-service:17010"
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/check-master-service.sh
              subPath: check-master-service.sh
              readOnly: true
        - name: init-config
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/config-datanode.sh" ]
          securityContext:
            privileged: true
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: CBFS_DATANODE_PORT
              value: "17310"
            - name: CBFS_DATANODE_PROF
              value: "17320"
            - name: CBFS_DATANODE_LOCALIP
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: CBFS_DATANODE_LOG_LEVEL
              value: "error"
            - name: CBFS_MASTER_ADDRS
              value: "master-0.master-service:17010,master-1.master-service:17010,master-2.master-service:17010"
            - name: CBFS_DATANODE_RAFT_HEARTBEAT_PORT
              value: "17330"
            - name: CBFS_DATANODE_RAFT_REPLICA_PORT
              value: "17340"
            - name: CBFS_DATANODE_EXPORTER_PORT
              value: "9520"
            - name: CBFS_DATANODE_DISKS
              value: "/data0:21474836480,/data1:21474836480"
            - name: CBFS_CONSUL_ADDR
              value: "http://consul-service:8500"
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/config-datanode.sh
              subPath: config-datanode.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
            - name: cubefs-override
              mountPath: /cfs/conf-override
            - name: pod-data-path
              mountPath: /cfs/data
              readOnly: false
      containers:
        - name: datanode-pod
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: 
          command: [ "/bin/bash", "/cfs/bin/start.sh" ]
          securityContext:
            privileged: true
          env:
            - name: TZ
              value: Asia/Shanghai
          ports:
            - name: port
              containerPort: 17310
              protocol: TCP
            - name: prof
              containerPort: 17320
              protocol: TCP
            - name: raft-heartbeat
              containerPort: 17330
              protocol: TCP
            - name: raft-replica
              containerPort: 17340
              protocol: TCP
            - name: exporter-port
              containerPort: 9520
              protocol: TCP
          readinessProbe:
            tcpSocket:
              port: 17310
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/start.sh
              subPath: start-datanode.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
            - name: pod-log-path
              mountPath: /cfs/logs
              readOnly: false
            - name: pod-data-path
              mountPath: /cfs/data
              readOnly: false
            - name: data0
              mountPath: /data0
              readOnly: false
            - name: data1
              mountPath: /data1
              readOnly: false
          
      volumes:
        - name: cubefs-bin
          configMap:
            name: cubefs-bin
            defaultMode: 0555
        - name: cubefs-override
          configMap:
            name: cubefs-config-override
            defaultMode: 0555
        - name: cubefs-conf
          emptyDir: { }
        - name: pod-log-path
          hostPath:
            path: /var/log/cubefs
        - name: pod-data-path
          hostPath:
            path: /var/lib/cubefs
        - name: data0
          hostPath:
            path: /data0
        - name: data1
          hostPath:
            path: /data1
---
# Source: cubefs/templates/daemonset-metanode.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: metanode
  labels:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: metanode
    app.kubernetes.io/version: 3.2.0

spec:
  updateStrategy:
    type: OnDelete
  selector:
    matchLabels:
      app.kubernetes.io/name: default
      app.kubernetes.io/component: metanode
      app.kubernetes.io/version: 3.2.0
  template:
    metadata:
      labels:
        app.kubernetes.io/name: default
        app.kubernetes.io/component: metanode
        app.kubernetes.io/version: 3.2.0
    spec:
      terminationGracePeriodSeconds: 60
      nodeSelector:
        component.cubefs.io/metanode: enabled
      hostNetwork: true
      priorityClassName: cubefs-high-priority
      hostPID: false
      dnsPolicy: ClusterFirstWithHostNet
      initContainers:
        - name: check-master-service
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/check-master-service.sh" ]
          env:
            - name: CBFS_MASTER_SERVICE_PORT
              value: "master-service:17010"
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/check-master-service.sh
              subPath: check-master-service.sh
              readOnly: true
        - name: init-config
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/config-metanode.sh" ]
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: CBFS_METANODE_PORT
              value: "17210"
            - name: CBFS_METANODE_PROF
              value: "17220"
            - name: CBFS_METANODE_LOCALIP
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: CBFS_METANODE_LOG_LEVEL
              value: "error"
            - name: CBFS_METANODE_RAFT_HEARTBEAT_PORT
              value: "17230"
            - name: CBFS_METANODE_RAFT_REPLICA_PORT
              value: "17240"
            - name: CBFS_METANODE_EXPORTER_PORT
              value: "9510"
            - name: CBFS_MASTER_ADDRS
              value: "master-0.master-service:17010,master-1.master-service:17010,master-2.master-service:17010"
            - name: CBFS_MASTER_TOTAL_MEM
              value: "26843545600"
            - name: CBFS_CONSUL_ADDR
              value: "http://consul-service:8500"
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/config-metanode.sh
              subPath: config-metanode.sh
              readOnly: true
            - name: cubefs-override
              mountPath: /cfs/conf-override
            - name: cubefs-conf
              mountPath: /cfs/conf
      containers:
        - name: metanode-pod
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: 
          command: [ "/bin/bash", "/cfs/bin/start.sh" ]
          securityContext:
            privileged: true
          env:
            - name: TZ
              value: Asia/Shanghai
          ports:
            - name: port
              containerPort: 17210
              protocol: TCP
            - name: prof
              containerPort: 17220
              protocol: TCP
            - name: raft-heartbeat
              containerPort: 17230
              protocol: TCP
            - name: raft-replica
              containerPort: 17240
              protocol: TCP
            - name: exporter-port
              containerPort: 9510
              protocol: TCP
          readinessProbe:
            tcpSocket:
              port: 17210
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/start.sh
              subPath: start-metanode.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
            - name: pod-log-path
              mountPath: /cfs/logs
              readOnly: false
            - name: pod-data-path
              mountPath: /cfs/data
              readOnly: false
          resources:
            limits:
              cpu: "8000m"
              memory: "256Gi"
            requests:
              cpu: "2000m"
              memory: "32Gi"
      volumes:
        - name: cubefs-bin
          configMap:
            name: cubefs-bin
            defaultMode: 0555
        - name: cubefs-override
          configMap:
            name: cubefs-config-override
            defaultMode: 0555
        - name: cubefs-conf
          emptyDir: { }
        - name: pod-log-path
          hostPath:
            path: /var/log/cubefs
        - name: pod-data-path
          hostPath:
            path: /var/lib/cubefs
---
# Source: cubefs/templates/csi-controller-deployment.yaml
kind: Deployment
apiVersion: apps/v1
metadata:
  name: cfs-csi-controller
spec:
  selector:
    matchLabels:
      app: cfs-csi-controller
  replicas: 1
  template:
    metadata:
      labels:
        app: cfs-csi-controller
    spec:
      serviceAccount: cfs-csi-service-account
      serviceAccountName: cfs-csi-service-account
      priorityClassName: cubefs-high-priority
      nodeSelector:
        component.cubefs.io/csi: enabled
      containers:
        - name: csi-provisioner
          image: registry.k8s.io/sig-storage/csi-provisioner:v2.2.2
          imagePullPolicy: IfNotPresent
          securityContext:
            privileged: true
          args:
            - --csi-address=$(ADDRESS)
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: DRIVER_NAME
              value: csi.cubefs.com
            - name: ADDRESS
              value: /csi/csi-controller.sock
          resources:
            requests:
              cpu: 200m
              memory: 256Mi
          volumeMounts:
            - mountPath: /csi
              name: socket-dir
        - name: external-attacher
          image: registry.k8s.io/sig-storage/csi-attacher:v3.4.0
          imagePullPolicy: IfNotPresent
          securityContext:
            privileged: true
          args:
            - --csi-address=$(ADDRESS)
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: ADDRESS
              value: /csi/csi-controller.sock
          resources:
            requests:
              cpu: 200m
              memory: 256Mi
          volumeMounts:
            - mountPath: /csi
              name: socket-dir
        - name: csi-resizer
          image: registry.k8s.io/sig-storage/csi-resizer:v1.3.0
          imagePullPolicy: IfNotPresent
          securityContext:
            privileged: true
          args:
            - --csi-address=$(ADDRESS)
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: ADDRESS
              value: /csi/csi-controller.sock
          resources:
            requests:
              cpu: 200m
              memory: 256Mi
          volumeMounts:
            - mountPath: /csi
              name: socket-dir
        - name: cfs-driver
          image: ghcr.io/cubefs/cfs-csi-driver:3.2.0.150.0
          imagePullPolicy: IfNotPresent
          securityContext:
            privileged: true
          args:
            - bash
            - "-c"
            - |-
              set -e
              su -p -s /bin/bash -c "/cfs/bin/start.sh &"
              su -p -s /bin/bash -c "sleep 9999999d"
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: LOG_LEVEL
              value: "5"
            - name: CSI_ENDPOINT
              value: unix:///csi/csi-controller.sock
            - name: DRIVER_NAME
              value: csi.cubefs.com
            - name: KUBE_NODE_NAME
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: spec.nodeName
          lifecycle:
            preStop:
              exec:
                command: [
                  "/bin/sh", "-c",
                  "rm -rf /csi/csi-controller.sock"
                ]
          resources:
            requests:
              cpu: 200m
              memory: 256Mi
          volumeMounts:
            - mountPath: /csi
              name: socket-dir
            - mountPath: /var/lib/kubelet/pods
              mountPropagation: Bidirectional
              name: mountpoint-dir
      volumes:
        - hostPath:
            path: /var/lib/kubelet/plugins/csi.cubefs.com
            type: DirectoryOrCreate
          name: socket-dir
        - hostPath:
            path: /var/lib/kubelet/pods
            type: Directory
          name: mountpoint-dir
---
# Source: cubefs/templates/deployment-client.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: client
  labels:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: client
    app.kubernetes.io/version: 3.2.0
  
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: default
      app.kubernetes.io/component: client
      app.kubernetes.io/version: 3.2.0
  template:
    metadata:
      labels:
        app.kubernetes.io/name: default
        app.kubernetes.io/component: client
        app.kubernetes.io/version: 3.2.0
    spec:
      initContainers:
        - name: check-master-service
          image: chubaofs/cfs-client:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/check-master-service.sh" ]
          env:
            - name: CBFS_MASTER_SERVICE_PORT
              value: "master-service:17010"
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/check-master-service.sh
              subPath: check-master-service.sh
              readOnly: true
        - name: init-config
          image: chubaofs/cfs-client:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/config-client.sh" ]
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: CBFS_CLIENT_PROF
              value: "17410"
            - name: CBFS_CLIENT_LOG_LEVEL
              value: "error"
            - name: CBFS_MASTER_ADDRS
              value: "master-0.master-service:17010,master-1.master-service:17010,master-2.master-service:17010"
            - name: CBFS_CLIENT_VOL_NAME
              value: "test"
            - name: CBFS_CLIENT_OWNER
              value: "cubefs"
            - name: CBFS_CLIENT_EXPORTER_PORT
              value: "9530"
            - name: CBFS_CONSUL_ADDR
              value: "http://consul-service:8500"
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/config-client.sh
              subPath: config-client.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
        - name: init-volume
          image: chubaofs/cfs-client:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/check-volumn.sh" ]
          securityContext:
            privileged: true
          env:
            - name: CBFS_CLIENT_VOL_NAME
              value: "test"
            - name: CBFS_CLIENT_OWNER
              value: "cubefs"
            - name: CBFS_MASTER_SERVICE_PORT
              value: "master-service:17010"
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/check-volumn.sh
              subPath: check-volumn.sh
              readOnly: true
      containers:
        - name: client-pod
          image: chubaofs/cfs-client:3.2.0
          imagePullPolicy: 
          command: [ "/bin/bash", "/cfs/bin/start.sh" ]
          securityContext:
            privileged: true
          env:
            - name: TZ
              value: Asia/Shanghai
          ports:
            - name: prof
              containerPort: 17410
              protocol: TCP
            - name: exporter-port
              containerPort: 9530
              protocol: TCP
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/start.sh
              subPath: start-client.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
            - name: pod-log-path
              mountPath: /cfs/logs
              readOnly: false
            - name: pod-data-path
              mountPath: /cfs/data
              readOnly: false
          
      volumes:
        - name: cubefs-bin
          configMap:
            name: cubefs-bin
            defaultMode: 0555
        - name: cubefs-conf
          emptyDir: {}
        - name: pod-log-path
          hostPath:
            path: /var/log/cubefs
        - name: pod-data-path
          hostPath:
            path: /var/lib/cubefs
---
# Source: cubefs/templates/deployment-consul.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: consul
  labels:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: consul
    app.kubernetes.io/version: 3.2.0
  
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: default
      app.kubernetes.io/component: consul
      app.kubernetes.io/version: 3.2.0
  template:
    metadata:
      labels:
        app.kubernetes.io/name: default
        app.kubernetes.io/component: consul
        app.kubernetes.io/version: 3.2.0
    spec:
      containers:
        - name: consul-pod
          image: consul:1.6.1
          imagePullPolicy: 
          securityContext:
            privileged: true
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: CONSUL_LOCAL_CONFIG
              value: "{\"ports\": {\"http\": 8500 }}" 
          ports:
            - name: port
              containerPort: 8500
              protocol: TCP
---
# Source: cubefs/templates/deployment-grafana.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: grafana
  labels:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: grafana
    app.kubernetes.io/version: 3.2.0
  
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: default
      app.kubernetes.io/component: grafana
      app.kubernetes.io/version: 3.2.0
  template:
    metadata:
      labels:
        app.kubernetes.io/name: default
        app.kubernetes.io/component: grafana
        app.kubernetes.io/version: 3.2.0
    spec:
      containers:
        - name: grafana-pod
          image: grafana/grafana:6.4.4
          imagePullPolicy: 
          securityContext:
            privileged: true
          env:
            # The following env variables set up basic auth twith the default admin user and admin password.
            - name: GF_AUTH_BASIC_ENABLED
              value: "true"
            - name: GF_AUTH_ANONYMOUS_ENABLED
              value: "false"
            - name: GF_SECURITY_ADMIN_PASSWORD
              value: "123456"
            # - name: GF_AUTH_ANONYMOUS_ORG_ROLE
            #   value: Admin
            # does not really work, because of template variables in exported dashboards:
            # - name: GF_DASHBOARDS_JSON_ENABLED
            #   value: "true"
            # - name: GF_SECURITY_ADMIN_PASSWORD__FILE
            #   value: ""
          readinessProbe:
            httpGet:
              path: /login
              port: 3000
            # initialDelaySeconds: 30
            # timeoutSeconds: 1
          ports:
            - name: exporter-port
              containerPort: 9530
              protocol: TCP
          volumeMounts:
            - name: grafana-persistent-storage
              mountPath: /var/lib/grafana
            - name: monitor-config
              mountPath: /grafana/init.sh
              subPath: init.sh
            - name: monitor-config
              mountPath: /etc/grafana/grafana.ini
              subPath: grafana.ini
            - name: monitor-config
              mountPath: /etc/grafana/provisioning/dashboards/cubefs.json
              subPath: cubefs.json
            - name: monitor-config
              mountPath: /etc/grafana/provisioning/dashboards/dashboard.yml
              subPath: dashboard.yml
            - name: monitor-config
              mountPath: /etc/grafana/provisioning/datasources/datasource.yml
              subPath: datasource.yml
          
      volumes:
        - name: monitor-config
          configMap:
            name: monitor-config
            defaultMode: 0555
        - name: grafana-persistent-storage
          emptyDir: {}
        # - name: grafana-security-admin-password
        #   secret:
        #     secretName: monitor-secret
---
# Source: cubefs/templates/deployment-objectnode.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: objectnode
  labels:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: objectnode
    app.kubernetes.io/version: 3.2.0
spec:
  replicas: 3
  selector:
    matchLabels:
      app.kubernetes.io/name: default
      app.kubernetes.io/component: objectnode
      app.kubernetes.io/version: 3.2.0
  template:
    metadata:
      labels:
        app.kubernetes.io/name: default
        app.kubernetes.io/component: objectnode
        app.kubernetes.io/version: 3.2.0
    spec:
      terminationGracePeriodSeconds: 60
      nodeSelector:
        component.cubefs.io/objectnode: enabled
      initContainers:
        - name: check-master-service
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/check-master-service.sh" ]
          env:
            - name: CBFS_MASTER_SERVICE_PORT
              value: "master-service:17010"
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/check-master-service.sh
              subPath: check-master-service.sh
              readOnly: true
        - name: init-config
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/config-objectnode.sh" ]
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: CBFS_OBJECTNODE_PORT
              value: "1601"
            - name: CBFS_OBJECTNODE_PROF
              value: "7011"
            - name: CBFS_OBJECTNODE_LOG_LEVEL
              value: "error"
            - name: CBFS_MASTER_ADDRS
              value: "master-0.master-service:17010,master-1.master-service:17010,master-2.master-service:17010"
            - name: CBFS_OBJECTNODE_EXPORTER_PORT
              value: "9500"
            - name: CBFS_OBJECTNODE_REGION
              value: spark
            - name: CBFS_OBJECTNODE_DOMAINS
              value: objectcfs.cubefs.io,objectnode.cubefs.io
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/config-objectnode.sh
              subPath: config-objectnode.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
      containers:
        - name: objectnode-pod
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: 
          command: [ "/bin/bash", "/cfs/bin/start.sh" ]
          securityContext:
            privileged: true
          env:
            - name: TZ
              value: Asia/Shanghai
          ports:
            - name: port
              containerPort: 1601
              protocol: TCP
            - name: prof
              containerPort: 7011
              protocol: TCP
            - name: exporter-port
              containerPort: 9500
              protocol: TCP
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/start.sh
              subPath: start-objectnode.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
          
      volumes:
        - name: cubefs-bin
          configMap:
            name: cubefs-bin
            defaultMode: 0555
        - name: cubefs-conf
          emptyDir: { }
---
# Source: cubefs/templates/deployment-prometheus.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: prometheus
  labels:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: prometheus
    app.kubernetes.io/version: 3.2.0
  
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: default
      app.kubernetes.io/component: prometheus
      app.kubernetes.io/version: 3.2.0
  template:
    metadata:
      labels:
        app.kubernetes.io/name: default
        app.kubernetes.io/component: prometheus
        app.kubernetes.io/version: 3.2.0
    spec:
      containers:
        - name: prometheus-pod
          image: prom/prometheus:v2.13.1
          imagePullPolicy: 
          env:
            - name: TZ
              value: Asia/Shanghai
          ports:
            - name: port
              containerPort: 9090
              protocol: TCP
          volumeMounts:
            - name: monitor-config
              mountPath: /etc/prometheus/prometheus.yml
              subPath: prometheus.yml
            - name: prometheus-data
              mountPath: /prometheus-data
          
      volumes:
        - name: monitor-config
          configMap:
            name: monitor-config
            defaultMode: 0555
        - name: prometheus-data
          hostPath:
            path: /var/lib/cubefs_prometheus
---
# Source: cubefs/templates/statefulset-master.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: master
  labels:
    app.kubernetes.io/name: default
    app.kubernetes.io/component: master
    app.kubernetes.io/version: 3.2.0

spec:
  updateStrategy:
    type: OnDelete
  replicas: 3
  serviceName: master-service
  selector:
    matchLabels:
      app.kubernetes.io/name: default
      app.kubernetes.io/component: master
      app.kubernetes.io/version: 3.2.0
  template:
    metadata:
      labels:
        app.kubernetes.io/name: default
        app.kubernetes.io/component: master
        app.kubernetes.io/version: 3.2.0
    spec:
      terminationGracePeriodSeconds: 60
      nodeSelector:
        component.cubefs.io/master: enabled
      # Master can not deploy in a same node, port will conflict.
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                  - key: app.kubernetes.io/application
                    operator: In
                    values:
                      - default
                  - key: app.kubernetes.io/component
                    operator: In
                    values:
                      - "master"
              topologyKey: kubernetes.io/hostname
      hostNetwork: true
      priorityClassName: cubefs-high-priority
      hostPID: false
      dnsPolicy: ClusterFirstWithHostNet
      initContainers:
        - name: init-config
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/config-master.sh" ]
          env:
            - name: TZ
              value: Asia/Shanghai
            - name: CBFS_MASTER_CLUSTER
              value: my-cluster
            - name: CBFS_MASTER_PORT
              value: "17010"
            - name: CBFS_MASTER_PROF
              value: "17020"
            - name: CBFS_MASTER_PEERS
              value: "1:master-0.master-service:17010,2:master-1.master-service:17010,3:master-2.master-service:17010"
            - name: CBFS_MASTER_RETAIN_LOGS
              value: "2000"
            - name: CBFS_MASTER_LOG_LEVEL
              value: "error"
            - name: CBFS_MASTER_EXPORTER_PORT
              value: "9500"
            - name: CBFS_CONSUL_ADDR
              value: "http://consul-service:8500"
            - name: CBFS_METANODE_RESERVED_MEM
              value: "67108864"
            - name: POD_IP
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/config-master.sh
              subPath: config-master.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
      containers:
        - name: master-pod
          image: chubaofs/cfs-server:3.2.0
          imagePullPolicy: IfNotPresent
          command: [ "/bin/bash", "/cfs/bin/start.sh" ]
          securityContext:
            privileged: true
          env:
            - name: TZ
              value: Asia/Shanghai
          ports:
            - name: port
              containerPort: 17010
              protocol: TCP
            - name: prof
              containerPort: 17020
              protocol: TCP
            - name: exporter-port
              containerPort: 9500
              protocol: TCP
          volumeMounts:
            - name: cubefs-bin
              mountPath: /cfs/bin/start.sh
              subPath: start-master.sh
              readOnly: true
            - name: cubefs-conf
              mountPath: /cfs/conf
            - name: pod-log-path
              mountPath: /cfs/logs
              readOnly: false
            - name: pod-data-path
              mountPath: /cfs/data
              readOnly: false
          
      volumes:
        - name: cubefs-bin
          configMap:
            name: cubefs-bin
            defaultMode: 0555
        - name: cubefs-conf
          emptyDir: { }
        - name: pod-log-path
          hostPath:
            path: /var/log/cubefs
        - name: pod-data-path
          hostPath:
            path: /var/lib/cubefs
---
# Source: cubefs/templates/ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: cubefs-ingress
spec:
  rules:
    - host: master.cubefs.com
      http:
        paths:
          - backend:
              service:
                name: master-service
                port:
                  number: 17010
            path: /
            pathType: Prefix
    - host: monitor.cubefs.com
      http:
        paths:
          - backend:
              service:
                name: grafana-service
                port:
                  number: 3000
            path: /
            pathType: Prefix
    - host: objectnode.cubefs.com
      http:
        paths:
          - backend:
              service:
                name: objectnode-service
                port:
                  number: 1601
            path: /
            pathType: Prefix
