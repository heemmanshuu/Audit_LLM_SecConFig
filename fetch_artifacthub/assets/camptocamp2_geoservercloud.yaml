---
# Source: geoservercloud/charts/geoserver/templates/pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: my-geoservercloud-gsc-gateway
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: gateway
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: gateway
---
# Source: geoservercloud/charts/geoserver/templates/pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: my-geoservercloud-gsc-gwc
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: gwc
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: gwc
---
# Source: geoservercloud/charts/geoserver/templates/pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: my-geoservercloud-gsc-rest
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: rest
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: rest
---
# Source: geoservercloud/charts/geoserver/templates/pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: my-geoservercloud-gsc-wcs
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wcs
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: wcs
---
# Source: geoservercloud/charts/geoserver/templates/pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: my-geoservercloud-gsc-webui
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: webui
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: webui
---
# Source: geoservercloud/charts/geoserver/templates/pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: my-geoservercloud-gsc-wfs
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wfs
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: wfs
---
# Source: geoservercloud/charts/geoserver/templates/pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: my-geoservercloud-gsc-wms
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wms
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: wms
---
# Source: geoservercloud/charts/geoserver/templates/secret-docker-registry.yaml
apiVersion: v1
kind: Secret
metadata:
  name: my-geoservercloud-geoserver-dockerregistry
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: geoserver
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: dockerregistry
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: ewogICJhdXRocyI6IHsKICAgICJmaXgtZW5kLWNvbW1hIjogeyJhdXRoIjogIiJ9CiAgfQp9
---
# Source: geoservercloud/charts/geoserver/templates/cm_metadata.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-geoservercloud-geoserver-metadata
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: geoserver
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: main
data:
  CHART_NAME: geoserver
  RELEASE_NAME: my-geoservercloud
  RELEASE_NAMESPACE: default
  SERVICE_ACL_NAME: my-geoservercloud-gsc-acl
  SERVICE_ACL_CONTAINER_SPRING_IMAGE_TAG: "2.2.0"
  SERVICE_GATEWAY_NAME: my-geoservercloud-gsc-gateway
  SERVICE_GATEWAY_CONTAINER_SPRING_IMAGE_TAG: "1.8.11"
  SERVICE_GWC_NAME: my-geoservercloud-gsc-gwc
  SERVICE_GWC_CONTAINER_SPRING_IMAGE_TAG: "1.8.11"
  SERVICE_REST_NAME: my-geoservercloud-gsc-rest
  SERVICE_REST_CONTAINER_SPRING_IMAGE_TAG: "1.8.11"
  SERVICE_WCS_NAME: my-geoservercloud-gsc-wcs
  SERVICE_WCS_CONTAINER_SPRING_IMAGE_TAG: "1.8.11"
  SERVICE_WEBUI_NAME: my-geoservercloud-gsc-webui
  SERVICE_WEBUI_CONTAINER_SPRING_IMAGE_TAG: "1.8.11"
  SERVICE_WFS_NAME: my-geoservercloud-gsc-wfs
  SERVICE_WFS_CONTAINER_SPRING_IMAGE_TAG: "1.8.11"
  SERVICE_WMS_NAME: my-geoservercloud-gsc-wms
  SERVICE_WMS_CONTAINER_SPRING_IMAGE_TAG: "1.8.11"
  SERVICE_WPS_NAME: my-geoservercloud-gsc-wps
  SERVICE_WPS_CONTAINER_SPRING_IMAGE_TAG: "1.8.11"
---
# Source: geoservercloud/charts/geoserver/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-geoservercloud-gsc-gateway
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: gateway
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8080
      protocol: TCP
      targetPort: http
  selector:
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: gateway
---
# Source: geoservercloud/charts/geoserver/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-geoservercloud-gsc-gwc
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: gwc
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8080
      protocol: TCP
      targetPort: http
  selector:
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: gwc
---
# Source: geoservercloud/charts/geoserver/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-geoservercloud-gsc-rest
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: rest
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8080
      protocol: TCP
      targetPort: http
  selector:
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: rest
---
# Source: geoservercloud/charts/geoserver/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-geoservercloud-gsc-wcs
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wcs
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8080
      protocol: TCP
      targetPort: http
  selector:
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wcs
---
# Source: geoservercloud/charts/geoserver/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-geoservercloud-gsc-webui
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: webui
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8080
      protocol: TCP
      targetPort: http
  selector:
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: webui
---
# Source: geoservercloud/charts/geoserver/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-geoservercloud-gsc-wfs
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wfs
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8080
      protocol: TCP
      targetPort: http
  selector:
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wfs
---
# Source: geoservercloud/charts/geoserver/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: my-geoservercloud-gsc-wms
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wms
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8080
      protocol: TCP
      targetPort: http
  selector:
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wms
---
# Source: geoservercloud/charts/geoserver/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-geoservercloud-gsc-gateway
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: gateway
spec:
  replicas: 1
  revisionHistoryLimit: 3
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: gateway
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: gsc
        app.kubernetes.io/instance: my-geoservercloud
        app.kubernetes.io/component: gateway
    spec:
      imagePullSecrets:
        - name: my-geoservercloud-geoserver-dockerregistry
      serviceAccountName: default
      securityContext:
        {}  
      containers:
        - name: spring
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
          image: "geoservercloud/geoserver-cloud-gateway:1.8.11"
          imagePullPolicy: IfNotPresent
          env:  
            - name: "ACL_USERNAME"
              value: geoserver  
            - name: "APP_KUBERNETES_IO_COMPONENT"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/component']  
            - name: "APP_KUBERNETES_IO_INSTANCE"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/instance']  
            - name: "APP_KUBERNETES_IO_NAME"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/name']  
            - name: "GEOSERVER_BASE_PATH"
              value: /geoserver-cloud  
            - name: "GEOTOOLS_HTTPCLIENT_PROXY_ENABLED"
              value: "false"  
            - name: "GWC_ENABLED"
              value: "true"  
            - name: "JAVA_OPTS_DEFAULT"
              value: -DALLOW_ENV_PARAMETRIZATION=true -XX:MaxRAMPercentage=80 -XX:InitialRAMPercentage=80  
            - name: "SERVICE_ACL_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_ACL_NAME"  
            - name: "SERVICE_GATEWAY_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GATEWAY_NAME"  
            - name: "SERVICE_GWC_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GWC_NAME"  
            - name: "SERVICE_REST_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_REST_NAME"  
            - name: "SERVICE_WCS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WCS_NAME"  
            - name: "SERVICE_WEBUI_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WEBUI_NAME"  
            - name: "SERVICE_WFS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WFS_NAME"  
            - name: "SERVICE_WMS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WMS_NAME"  
            - name: "SERVICE_WPS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WPS_NAME"  
            - name: "SPRING_PROFILES_ACTIVE"
              value: not-set  
            - name: "ACL_URL"
              value: http://$(SERVICE_ACL_NAME):8080/acl/api  
            - name: "JAVA_OPTS"
              value: $(JAVA_OPTS_DEFAULT)  
            - name: "TARGETS_ACL"
              value: http://$(SERVICE_ACL_NAME):8080  
            - name: "TARGETS_GWC"
              value: http://$(SERVICE_GWC_NAME):8080  
            - name: "TARGETS_REST"
              value: http://$(SERVICE_REST_NAME):8080  
            - name: "TARGETS_WCS"
              value: http://$(SERVICE_WCS_NAME):8080  
            - name: "TARGETS_WEBUI"
              value: http://$(SERVICE_WEBUI_NAME):8080  
            - name: "TARGETS_WFS"
              value: http://$(SERVICE_WFS_NAME):8080  
            - name: "TARGETS_WMS"
              value: http://$(SERVICE_WMS_NAME):8080  
            - name: "TARGETS_WPS"
              value: http://$(SERVICE_WPS_NAME):8080
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 4
              memory: 4Gi
            requests:
              cpu: 0.1
              memory: 512Mi
          volumeMounts:
            - mountPath: /etc/localconfig
              name: vol-local-gscloud
            - mountPath: /tmp/
              name: tmp-empty-dir
            
          ports:
            - name: health
              containerPort: 8081
              hostIP: 127.0.0.1
            - name: http
              containerPort: 8080
              hostIP: 127.0.0.1
            
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /actuator/health/liveness
              port: health
            initialDelaySeconds: 60
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: health
            periodSeconds: 5
      
      volumes:
        - name: tmp-empty-dir
          emptyDir: {}
        - name: vol-local-gscloud
          emptyDir: {}
---
# Source: geoservercloud/charts/geoserver/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-geoservercloud-gsc-gwc
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: gwc
spec:
  replicas: 1
  revisionHistoryLimit: 3
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: gwc
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: gsc
        app.kubernetes.io/instance: my-geoservercloud
        app.kubernetes.io/component: gwc
    spec:
      imagePullSecrets:
        - name: my-geoservercloud-geoserver-dockerregistry
      serviceAccountName: default
      securityContext:
        {}  
      containers:
        - name: spring
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
          image: "geoservercloud/geoserver-cloud-gwc:1.8.11"
          imagePullPolicy: IfNotPresent
          env:  
            - name: "ACL_USERNAME"
              value: geoserver  
            - name: "APP_KUBERNETES_IO_COMPONENT"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/component']  
            - name: "APP_KUBERNETES_IO_INSTANCE"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/instance']  
            - name: "APP_KUBERNETES_IO_NAME"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/name']  
            - name: "GEOSERVER_BASE_PATH"
              value: /geoserver-cloud  
            - name: "GEOTOOLS_HTTPCLIENT_PROXY_ENABLED"
              value: "false"  
            - name: "GWC_ENABLED"
              value: "true"  
            - name: "JAVA_OPTS_DEFAULT"
              value: -DALLOW_ENV_PARAMETRIZATION=true -XX:MaxRAMPercentage=80 -XX:InitialRAMPercentage=80  
            - name: "SERVICE_ACL_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_ACL_NAME"  
            - name: "SERVICE_GATEWAY_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GATEWAY_NAME"  
            - name: "SERVICE_GWC_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GWC_NAME"  
            - name: "SERVICE_REST_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_REST_NAME"  
            - name: "SERVICE_WCS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WCS_NAME"  
            - name: "SERVICE_WEBUI_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WEBUI_NAME"  
            - name: "SERVICE_WFS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WFS_NAME"  
            - name: "SERVICE_WMS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WMS_NAME"  
            - name: "SERVICE_WPS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WPS_NAME"  
            - name: "SPRING_PROFILES_ACTIVE"
              value: not-set  
            - name: "ACL_URL"
              value: http://$(SERVICE_ACL_NAME):8080/acl/api  
            - name: "JAVA_OPTS"
              value: $(JAVA_OPTS_DEFAULT)  
            - name: "TARGETS_ACL"
              value: http://$(SERVICE_ACL_NAME):8080  
            - name: "TARGETS_GWC"
              value: http://$(SERVICE_GWC_NAME):8080  
            - name: "TARGETS_REST"
              value: http://$(SERVICE_REST_NAME):8080  
            - name: "TARGETS_WCS"
              value: http://$(SERVICE_WCS_NAME):8080  
            - name: "TARGETS_WEBUI"
              value: http://$(SERVICE_WEBUI_NAME):8080  
            - name: "TARGETS_WFS"
              value: http://$(SERVICE_WFS_NAME):8080  
            - name: "TARGETS_WMS"
              value: http://$(SERVICE_WMS_NAME):8080  
            - name: "TARGETS_WPS"
              value: http://$(SERVICE_WPS_NAME):8080
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 4
              memory: 4Gi
            requests:
              cpu: 0.1
              memory: 512Mi
          volumeMounts:
            - mountPath: /etc/localconfig
              name: vol-local-gscloud
            - mountPath: /tmp/
              name: tmp-empty-dir
            
          ports:
            - name: health
              containerPort: 8081
              hostIP: 127.0.0.1
            - name: http
              containerPort: 8080
              hostIP: 127.0.0.1
            
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /actuator/health/liveness
              port: health
            initialDelaySeconds: 60
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: health
            periodSeconds: 5
      
      volumes:
        - name: tmp-empty-dir
          emptyDir: {}
        - name: vol-local-gscloud
          emptyDir: {}
---
# Source: geoservercloud/charts/geoserver/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-geoservercloud-gsc-rest
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: rest
spec:
  replicas: 1
  revisionHistoryLimit: 3
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: rest
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: gsc
        app.kubernetes.io/instance: my-geoservercloud
        app.kubernetes.io/component: rest
    spec:
      imagePullSecrets:
        - name: my-geoservercloud-geoserver-dockerregistry
      serviceAccountName: default
      securityContext:
        {}  
      containers:
        - name: spring
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
          image: "geoservercloud/geoserver-cloud-rest:1.8.11"
          imagePullPolicy: IfNotPresent
          env:  
            - name: "ACL_USERNAME"
              value: geoserver  
            - name: "APP_KUBERNETES_IO_COMPONENT"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/component']  
            - name: "APP_KUBERNETES_IO_INSTANCE"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/instance']  
            - name: "APP_KUBERNETES_IO_NAME"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/name']  
            - name: "GEOSERVER_BASE_PATH"
              value: /geoserver-cloud  
            - name: "GEOTOOLS_HTTPCLIENT_PROXY_ENABLED"
              value: "false"  
            - name: "GWC_ENABLED"
              value: "true"  
            - name: "JAVA_OPTS_DEFAULT"
              value: -DALLOW_ENV_PARAMETRIZATION=true -XX:MaxRAMPercentage=80 -XX:InitialRAMPercentage=80  
            - name: "SERVICE_ACL_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_ACL_NAME"  
            - name: "SERVICE_GATEWAY_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GATEWAY_NAME"  
            - name: "SERVICE_GWC_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GWC_NAME"  
            - name: "SERVICE_REST_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_REST_NAME"  
            - name: "SERVICE_WCS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WCS_NAME"  
            - name: "SERVICE_WEBUI_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WEBUI_NAME"  
            - name: "SERVICE_WFS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WFS_NAME"  
            - name: "SERVICE_WMS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WMS_NAME"  
            - name: "SERVICE_WPS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WPS_NAME"  
            - name: "SPRING_PROFILES_ACTIVE"
              value: not-set  
            - name: "ACL_URL"
              value: http://$(SERVICE_ACL_NAME):8080/acl/api  
            - name: "JAVA_OPTS"
              value: $(JAVA_OPTS_DEFAULT)  
            - name: "TARGETS_ACL"
              value: http://$(SERVICE_ACL_NAME):8080  
            - name: "TARGETS_GWC"
              value: http://$(SERVICE_GWC_NAME):8080  
            - name: "TARGETS_REST"
              value: http://$(SERVICE_REST_NAME):8080  
            - name: "TARGETS_WCS"
              value: http://$(SERVICE_WCS_NAME):8080  
            - name: "TARGETS_WEBUI"
              value: http://$(SERVICE_WEBUI_NAME):8080  
            - name: "TARGETS_WFS"
              value: http://$(SERVICE_WFS_NAME):8080  
            - name: "TARGETS_WMS"
              value: http://$(SERVICE_WMS_NAME):8080  
            - name: "TARGETS_WPS"
              value: http://$(SERVICE_WPS_NAME):8080
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 4
              memory: 4Gi
            requests:
              cpu: 0.1
              memory: 512Mi
          volumeMounts:
            - mountPath: /etc/localconfig
              name: vol-local-gscloud
            - mountPath: /tmp/
              name: tmp-empty-dir
            
          ports:
            - name: health
              containerPort: 8081
              hostIP: 127.0.0.1
            - name: http
              containerPort: 8080
              hostIP: 127.0.0.1
            
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /actuator/health/liveness
              port: health
            initialDelaySeconds: 60
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: health
            periodSeconds: 5
      
      volumes:
        - name: tmp-empty-dir
          emptyDir: {}
        - name: vol-local-gscloud
          emptyDir: {}
---
# Source: geoservercloud/charts/geoserver/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-geoservercloud-gsc-wcs
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wcs
spec:
  replicas: 1
  revisionHistoryLimit: 3
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: wcs
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: gsc
        app.kubernetes.io/instance: my-geoservercloud
        app.kubernetes.io/component: wcs
    spec:
      imagePullSecrets:
        - name: my-geoservercloud-geoserver-dockerregistry
      serviceAccountName: default
      securityContext:
        {}  
      containers:
        - name: spring
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
          image: "geoservercloud/geoserver-cloud-wcs:1.8.11"
          imagePullPolicy: IfNotPresent
          env:  
            - name: "ACL_USERNAME"
              value: geoserver  
            - name: "APP_KUBERNETES_IO_COMPONENT"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/component']  
            - name: "APP_KUBERNETES_IO_INSTANCE"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/instance']  
            - name: "APP_KUBERNETES_IO_NAME"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/name']  
            - name: "GEOSERVER_BASE_PATH"
              value: /geoserver-cloud  
            - name: "GEOTOOLS_HTTPCLIENT_PROXY_ENABLED"
              value: "false"  
            - name: "GWC_ENABLED"
              value: "true"  
            - name: "JAVA_OPTS_DEFAULT"
              value: -DALLOW_ENV_PARAMETRIZATION=true -XX:MaxRAMPercentage=80 -XX:InitialRAMPercentage=80  
            - name: "SERVICE_ACL_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_ACL_NAME"  
            - name: "SERVICE_GATEWAY_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GATEWAY_NAME"  
            - name: "SERVICE_GWC_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GWC_NAME"  
            - name: "SERVICE_REST_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_REST_NAME"  
            - name: "SERVICE_WCS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WCS_NAME"  
            - name: "SERVICE_WEBUI_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WEBUI_NAME"  
            - name: "SERVICE_WFS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WFS_NAME"  
            - name: "SERVICE_WMS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WMS_NAME"  
            - name: "SERVICE_WPS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WPS_NAME"  
            - name: "SPRING_PROFILES_ACTIVE"
              value: not-set  
            - name: "ACL_URL"
              value: http://$(SERVICE_ACL_NAME):8080/acl/api  
            - name: "JAVA_OPTS"
              value: $(JAVA_OPTS_DEFAULT)  
            - name: "TARGETS_ACL"
              value: http://$(SERVICE_ACL_NAME):8080  
            - name: "TARGETS_GWC"
              value: http://$(SERVICE_GWC_NAME):8080  
            - name: "TARGETS_REST"
              value: http://$(SERVICE_REST_NAME):8080  
            - name: "TARGETS_WCS"
              value: http://$(SERVICE_WCS_NAME):8080  
            - name: "TARGETS_WEBUI"
              value: http://$(SERVICE_WEBUI_NAME):8080  
            - name: "TARGETS_WFS"
              value: http://$(SERVICE_WFS_NAME):8080  
            - name: "TARGETS_WMS"
              value: http://$(SERVICE_WMS_NAME):8080  
            - name: "TARGETS_WPS"
              value: http://$(SERVICE_WPS_NAME):8080
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 4
              memory: 4Gi
            requests:
              cpu: 0.1
              memory: 512Mi
          volumeMounts:
            - mountPath: /etc/localconfig
              name: vol-local-gscloud
            - mountPath: /tmp/
              name: tmp-empty-dir
            
          ports:
            - name: health
              containerPort: 8081
              hostIP: 127.0.0.1
            - name: http
              containerPort: 8080
              hostIP: 127.0.0.1
            
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /actuator/health/liveness
              port: health
            initialDelaySeconds: 60
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: health
            periodSeconds: 5
      
      volumes:
        - name: tmp-empty-dir
          emptyDir: {}
        - name: vol-local-gscloud
          emptyDir: {}
---
# Source: geoservercloud/charts/geoserver/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-geoservercloud-gsc-webui
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: webui
spec:
  replicas: 1
  revisionHistoryLimit: 3
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: webui
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: gsc
        app.kubernetes.io/instance: my-geoservercloud
        app.kubernetes.io/component: webui
    spec:
      imagePullSecrets:
        - name: my-geoservercloud-geoserver-dockerregistry
      serviceAccountName: default
      securityContext:
        {}  
      containers:
        - name: spring
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
          image: "geoservercloud/geoserver-cloud-webui:1.8.11"
          imagePullPolicy: IfNotPresent
          env:  
            - name: "ACL_USERNAME"
              value: geoserver  
            - name: "APP_KUBERNETES_IO_COMPONENT"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/component']  
            - name: "APP_KUBERNETES_IO_INSTANCE"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/instance']  
            - name: "APP_KUBERNETES_IO_NAME"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/name']  
            - name: "GEOSERVER_BASE_PATH"
              value: /geoserver-cloud  
            - name: "GEOTOOLS_HTTPCLIENT_PROXY_ENABLED"
              value: "false"  
            - name: "GWC_ENABLED"
              value: "true"  
            - name: "JAVA_OPTS_DEFAULT"
              value: -DALLOW_ENV_PARAMETRIZATION=true -XX:MaxRAMPercentage=80 -XX:InitialRAMPercentage=80  
            - name: "SERVICE_ACL_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_ACL_NAME"  
            - name: "SERVICE_GATEWAY_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GATEWAY_NAME"  
            - name: "SERVICE_GWC_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GWC_NAME"  
            - name: "SERVICE_REST_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_REST_NAME"  
            - name: "SERVICE_WCS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WCS_NAME"  
            - name: "SERVICE_WEBUI_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WEBUI_NAME"  
            - name: "SERVICE_WFS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WFS_NAME"  
            - name: "SERVICE_WMS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WMS_NAME"  
            - name: "SERVICE_WPS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WPS_NAME"  
            - name: "SPRING_PROFILES_ACTIVE"
              value: not-set  
            - name: "ACL_URL"
              value: http://$(SERVICE_ACL_NAME):8080/acl/api  
            - name: "JAVA_OPTS"
              value: $(JAVA_OPTS_DEFAULT)  
            - name: "TARGETS_ACL"
              value: http://$(SERVICE_ACL_NAME):8080  
            - name: "TARGETS_GWC"
              value: http://$(SERVICE_GWC_NAME):8080  
            - name: "TARGETS_REST"
              value: http://$(SERVICE_REST_NAME):8080  
            - name: "TARGETS_WCS"
              value: http://$(SERVICE_WCS_NAME):8080  
            - name: "TARGETS_WEBUI"
              value: http://$(SERVICE_WEBUI_NAME):8080  
            - name: "TARGETS_WFS"
              value: http://$(SERVICE_WFS_NAME):8080  
            - name: "TARGETS_WMS"
              value: http://$(SERVICE_WMS_NAME):8080  
            - name: "TARGETS_WPS"
              value: http://$(SERVICE_WPS_NAME):8080
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 4
              memory: 4Gi
            requests:
              cpu: 0.1
              memory: 512Mi
          volumeMounts:
            - mountPath: /etc/localconfig
              name: vol-local-gscloud
            - mountPath: /tmp/
              name: tmp-empty-dir
            
          ports:
            - name: health
              containerPort: 8081
              hostIP: 127.0.0.1
            - name: http
              containerPort: 8080
              hostIP: 127.0.0.1
            
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /actuator/health/liveness
              port: health
            initialDelaySeconds: 60
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: health
            periodSeconds: 5
      
      volumes:
        - name: tmp-empty-dir
          emptyDir: {}
        - name: vol-local-gscloud
          emptyDir: {}
---
# Source: geoservercloud/charts/geoserver/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-geoservercloud-gsc-wfs
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wfs
spec:
  replicas: 1
  revisionHistoryLimit: 3
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: wfs
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: gsc
        app.kubernetes.io/instance: my-geoservercloud
        app.kubernetes.io/component: wfs
    spec:
      imagePullSecrets:
        - name: my-geoservercloud-geoserver-dockerregistry
      serviceAccountName: default
      securityContext:
        {}  
      containers:
        - name: spring
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
          image: "geoservercloud/geoserver-cloud-wfs:1.8.11"
          imagePullPolicy: IfNotPresent
          env:  
            - name: "ACL_USERNAME"
              value: geoserver  
            - name: "APP_KUBERNETES_IO_COMPONENT"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/component']  
            - name: "APP_KUBERNETES_IO_INSTANCE"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/instance']  
            - name: "APP_KUBERNETES_IO_NAME"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/name']  
            - name: "GEOSERVER_BASE_PATH"
              value: /geoserver-cloud  
            - name: "GEOTOOLS_HTTPCLIENT_PROXY_ENABLED"
              value: "false"  
            - name: "GWC_ENABLED"
              value: "true"  
            - name: "JAVA_OPTS_DEFAULT"
              value: -DALLOW_ENV_PARAMETRIZATION=true -XX:MaxRAMPercentage=80 -XX:InitialRAMPercentage=80  
            - name: "SERVICE_ACL_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_ACL_NAME"  
            - name: "SERVICE_GATEWAY_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GATEWAY_NAME"  
            - name: "SERVICE_GWC_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GWC_NAME"  
            - name: "SERVICE_REST_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_REST_NAME"  
            - name: "SERVICE_WCS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WCS_NAME"  
            - name: "SERVICE_WEBUI_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WEBUI_NAME"  
            - name: "SERVICE_WFS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WFS_NAME"  
            - name: "SERVICE_WMS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WMS_NAME"  
            - name: "SERVICE_WPS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WPS_NAME"  
            - name: "SPRING_PROFILES_ACTIVE"
              value: not-set  
            - name: "ACL_URL"
              value: http://$(SERVICE_ACL_NAME):8080/acl/api  
            - name: "JAVA_OPTS"
              value: $(JAVA_OPTS_DEFAULT)  
            - name: "TARGETS_ACL"
              value: http://$(SERVICE_ACL_NAME):8080  
            - name: "TARGETS_GWC"
              value: http://$(SERVICE_GWC_NAME):8080  
            - name: "TARGETS_REST"
              value: http://$(SERVICE_REST_NAME):8080  
            - name: "TARGETS_WCS"
              value: http://$(SERVICE_WCS_NAME):8080  
            - name: "TARGETS_WEBUI"
              value: http://$(SERVICE_WEBUI_NAME):8080  
            - name: "TARGETS_WFS"
              value: http://$(SERVICE_WFS_NAME):8080  
            - name: "TARGETS_WMS"
              value: http://$(SERVICE_WMS_NAME):8080  
            - name: "TARGETS_WPS"
              value: http://$(SERVICE_WPS_NAME):8080
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 4
              memory: 4Gi
            requests:
              cpu: 0.1
              memory: 512Mi
          volumeMounts:
            - mountPath: /etc/localconfig
              name: vol-local-gscloud
            - mountPath: /tmp/
              name: tmp-empty-dir
            
          ports:
            - name: health
              containerPort: 8081
              hostIP: 127.0.0.1
            - name: http
              containerPort: 8080
              hostIP: 127.0.0.1
            
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /actuator/health/liveness
              port: health
            initialDelaySeconds: 60
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: health
            periodSeconds: 5
      
      volumes:
        - name: tmp-empty-dir
          emptyDir: {}
        - name: vol-local-gscloud
          emptyDir: {}
---
# Source: geoservercloud/charts/geoserver/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-geoservercloud-gsc-wms
  labels: 
    helm.sh/chart: geoserver
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: gsc
    app.kubernetes.io/instance: my-geoservercloud
    app.kubernetes.io/component: wms
spec:
  replicas: 1
  revisionHistoryLimit: 3
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: gsc
      app.kubernetes.io/instance: my-geoservercloud
      app.kubernetes.io/component: wms
  template:
    metadata:
      labels: 
        app.kubernetes.io/name: gsc
        app.kubernetes.io/instance: my-geoservercloud
        app.kubernetes.io/component: wms
    spec:
      imagePullSecrets:
        - name: my-geoservercloud-geoserver-dockerregistry
      serviceAccountName: default
      securityContext:
        {}  
      containers:
        - name: spring
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
          image: "geoservercloud/geoserver-cloud-wms:1.8.11"
          imagePullPolicy: IfNotPresent
          env:  
            - name: "ACL_USERNAME"
              value: geoserver  
            - name: "APP_KUBERNETES_IO_COMPONENT"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/component']  
            - name: "APP_KUBERNETES_IO_INSTANCE"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/instance']  
            - name: "APP_KUBERNETES_IO_NAME"
              valueFrom:
                fieldRef:
                  fieldPath: metadata.labels['app.kubernetes.io/name']  
            - name: "GEOSERVER_BASE_PATH"
              value: /geoserver-cloud  
            - name: "GEOTOOLS_HTTPCLIENT_PROXY_ENABLED"
              value: "false"  
            - name: "GWC_ENABLED"
              value: "true"  
            - name: "JAVA_OPTS_DEFAULT"
              value: -DALLOW_ENV_PARAMETRIZATION=true -XX:MaxRAMPercentage=80 -XX:InitialRAMPercentage=80  
            - name: "SERVICE_ACL_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_ACL_NAME"  
            - name: "SERVICE_GATEWAY_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GATEWAY_NAME"  
            - name: "SERVICE_GWC_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_GWC_NAME"  
            - name: "SERVICE_REST_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_REST_NAME"  
            - name: "SERVICE_WCS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WCS_NAME"  
            - name: "SERVICE_WEBUI_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WEBUI_NAME"  
            - name: "SERVICE_WFS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WFS_NAME"  
            - name: "SERVICE_WMS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WMS_NAME"  
            - name: "SERVICE_WPS_NAME"
              valueFrom:
                configMapKeyRef:
                  name: my-geoservercloud-geoserver-metadata
                  key: "SERVICE_WPS_NAME"  
            - name: "SPRING_PROFILES_ACTIVE"
              value: not-set  
            - name: "ACL_URL"
              value: http://$(SERVICE_ACL_NAME):8080/acl/api  
            - name: "JAVA_OPTS"
              value: $(JAVA_OPTS_DEFAULT)  
            - name: "TARGETS_ACL"
              value: http://$(SERVICE_ACL_NAME):8080  
            - name: "TARGETS_GWC"
              value: http://$(SERVICE_GWC_NAME):8080  
            - name: "TARGETS_REST"
              value: http://$(SERVICE_REST_NAME):8080  
            - name: "TARGETS_WCS"
              value: http://$(SERVICE_WCS_NAME):8080  
            - name: "TARGETS_WEBUI"
              value: http://$(SERVICE_WEBUI_NAME):8080  
            - name: "TARGETS_WFS"
              value: http://$(SERVICE_WFS_NAME):8080  
            - name: "TARGETS_WMS"
              value: http://$(SERVICE_WMS_NAME):8080  
            - name: "TARGETS_WPS"
              value: http://$(SERVICE_WPS_NAME):8080
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 4
              memory: 4Gi
            requests:
              cpu: 0.1
              memory: 512Mi
          volumeMounts:
            - mountPath: /etc/localconfig
              name: vol-local-gscloud
            - mountPath: /tmp/
              name: tmp-empty-dir
            
          ports:
            - name: health
              containerPort: 8081
              hostIP: 127.0.0.1
            - name: http
              containerPort: 8080
              hostIP: 127.0.0.1
            
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /actuator/health/liveness
              port: health
            initialDelaySeconds: 60
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /actuator/health/readiness
              port: health
            periodSeconds: 5
      
      volumes:
        - name: tmp-empty-dir
          emptyDir: {}
        - name: vol-local-gscloud
          emptyDir: {}
